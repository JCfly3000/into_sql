<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tony Duan">

<title>Code – SQL handbook</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./SQL-Database.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-494121dfa8658343c03537e94414993d.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-a0649ace7b9e9e15dfb5fe311d767a49.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-986303d758dc40252cacaa55bda3e039.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-e97d633d3e9de2170d947f5f0b9a7695.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./SQL-Database.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">SQL handbook</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./code.html" aria-current="page"> 
<span class="menu-text">Code</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://www.bing.com"> 
<span class="menu-text">中文</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#show-all-table" id="toc-show-all-table" class="nav-link active" data-scroll-target="#show-all-table"><span class="header-section-number">1</span> show all table</a></li>
  <li><a href="#describe-a-table" id="toc-describe-a-table" class="nav-link" data-scroll-target="#describe-a-table"><span class="header-section-number">2</span> Describe a table</a></li>
  <li><a href="#show-column-name" id="toc-show-column-name" class="nav-link" data-scroll-target="#show-column-name"><span class="header-section-number">3</span> show column name</a></li>
  <li><a href="#select" id="toc-select" class="nav-link" data-scroll-target="#select"><span class="header-section-number">4</span> select</a>
  <ul class="collapse">
  <li><a href="#select-top-6-and-rename" id="toc-select-top-6-and-rename" class="nav-link" data-scroll-target="#select-top-6-and-rename"><span class="header-section-number">4.1</span> select top 6 and rename</a></li>
  <li><a href="#select-distinct" id="toc-select-distinct" class="nav-link" data-scroll-target="#select-distinct"><span class="header-section-number">4.2</span> select distinct</a></li>
  </ul></li>
  <li><a href="#check-row-number-and-column-number" id="toc-check-row-number-and-column-number" class="nav-link" data-scroll-target="#check-row-number-and-column-number"><span class="header-section-number">5</span> check row number and column number</a></li>
  <li><a href="#create-column" id="toc-create-column" class="nav-link" data-scroll-target="#create-column"><span class="header-section-number">6</span> create column</a></li>
  <li><a href="#filter" id="toc-filter" class="nav-link" data-scroll-target="#filter"><span class="header-section-number">7</span> Filter</a></li>
  <li><a href="#order" id="toc-order" class="nav-link" data-scroll-target="#order"><span class="header-section-number">8</span> order</a></li>
  <li><a href="#group-by" id="toc-group-by" class="nav-link" data-scroll-target="#group-by"><span class="header-section-number">9</span> group by</a></li>
  <li><a href="#create-table" id="toc-create-table" class="nav-link" data-scroll-target="#create-table"><span class="header-section-number">10</span> create table</a>
  <ul class="collapse">
  <li><a href="#create-or-replace" id="toc-create-or-replace" class="nav-link" data-scroll-target="#create-or-replace"><span class="header-section-number">10.1</span> CREATE OR REPLACE</a></li>
  <li><a href="#create-table-if-not-exists" id="toc-create-table-if-not-exists" class="nav-link" data-scroll-target="#create-table-if-not-exists"><span class="header-section-number">10.2</span> CREATE TABLE IF NOT EXISTS</a></li>
  </ul></li>
  <li><a href="#unique" id="toc-unique" class="nav-link" data-scroll-target="#unique"><span class="header-section-number">11</span> unique</a>
  <ul class="collapse">
  <li><a href="#check-unique" id="toc-check-unique" class="nav-link" data-scroll-target="#check-unique"><span class="header-section-number">11.1</span> check unique</a></li>
  </ul></li>
  <li><a href="#join" id="toc-join" class="nav-link" data-scroll-target="#join"><span class="header-section-number">12</span> join</a>
  <ul class="collapse">
  <li><a href="#left-join" id="toc-left-join" class="nav-link" data-scroll-target="#left-join"><span class="header-section-number">12.1</span> left join</a></li>
  <li><a href="#inter-join" id="toc-inter-join" class="nav-link" data-scroll-target="#inter-join"><span class="header-section-number">12.2</span> inter join</a></li>
  </ul></li>
  <li><a href="#append-rows" id="toc-append-rows" class="nav-link" data-scroll-target="#append-rows"><span class="header-section-number">13</span> append rows</a>
  <ul class="collapse">
  <li><a href="#append-without-duplicate-elimination-union-all" id="toc-append-without-duplicate-elimination-union-all" class="nav-link" data-scroll-target="#append-without-duplicate-elimination-union-all"><span class="header-section-number">13.1</span> append without duplicate elimination <code>union all</code></a></li>
  <li><a href="#append-with-duplicate-elimination-union" id="toc-append-with-duplicate-elimination-union" class="nav-link" data-scroll-target="#append-with-duplicate-elimination-union"><span class="header-section-number">13.2</span> append with duplicate elimination <code>union</code></a></li>
  </ul></li>
  <li><a href="#delete-rows" id="toc-delete-rows" class="nav-link" data-scroll-target="#delete-rows"><span class="header-section-number">14</span> delete rows</a></li>
  <li><a href="#update-rows" id="toc-update-rows" class="nav-link" data-scroll-target="#update-rows"><span class="header-section-number">15</span> update rows</a></li>
  <li><a href="#drop-table" id="toc-drop-table" class="nav-link" data-scroll-target="#drop-table"><span class="header-section-number">16</span> drop table</a></li>
  <li><a href="#pivot" id="toc-pivot" class="nav-link" data-scroll-target="#pivot"><span class="header-section-number">17</span> PIVOT</a>
  <ul class="collapse">
  <li><a href="#pivot-on-one-column" id="toc-pivot-on-one-column" class="nav-link" data-scroll-target="#pivot-on-one-column"><span class="header-section-number">17.1</span> PIVOT on one column</a></li>
  <li><a href="#pivot-on-two-column" id="toc-pivot-on-two-column" class="nav-link" data-scroll-target="#pivot-on-two-column"><span class="header-section-number">17.2</span> PIVOT on two column</a></li>
  </ul></li>
  <li><a href="#unpivot" id="toc-unpivot" class="nav-link" data-scroll-target="#unpivot"><span class="header-section-number">18</span> unpivot</a></li>
  <li><a href="#explain" id="toc-explain" class="nav-link" data-scroll-target="#explain"><span class="header-section-number">19</span> EXPLAIN</a></li>
  <li><a href="#display-beautiful-table" id="toc-display-beautiful-table" class="nav-link" data-scroll-target="#display-beautiful-table"><span class="header-section-number">20</span> Display beautiful table</a></li>
  <li><a href="#reference" id="toc-reference" class="nav-link" data-scroll-target="#reference"><span class="header-section-number">21</span> reference:</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Code</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Tony Duan </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="at">RETICULATE_PYTHON =</span> <span class="st">"/Library/Frameworks/Python.framework/Versions/3.11/bin/python3.11"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">use_python</span>(<span class="st">"/Library/Frameworks/Python.framework/Versions/3.11/bin/python3.11"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Using python 3.11 for siuba pacakege</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> platform <span class="im">import</span> python_version</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(python_version())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>3.11.9</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>os.system(<span class="st">'pip show pandas'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>os.system(<span class="st">'pip show siuba'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set up duckdb database</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DBI)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSQLite)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(connections)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(duckdb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set up R data</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(mtcars) </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>mtcars<span class="ot">=</span><span class="fu">cbind</span>(<span class="at">model_name =</span> <span class="fu">rownames</span>(mtcars), mtcars) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>iris<span class="ot">=</span>iris<span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set up Python data</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>mtcars<span class="op">=</span>r.mtcars</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>iris<span class="op">=</span>r.iris</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">"my-db.duckdb"</span>)) {<span class="fu">file.remove</span>(<span class="st">"my-db.duckdb"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#con &lt;- dbConnect(duckdb(), dbdir = "my-db.duckdb", read_only = TRUE)</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(<span class="fu">duckdb</span>(), <span class="at">dbdir =</span> <span class="st">"my-db.duckdb"</span>, <span class="at">read_only =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dbWriteTable</span>(con, <span class="st">"iris_table"</span>, iris,<span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dbWriteTable</span>(con, <span class="st">"mtcars_table"</span>, mtcars,<span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li><p>There are table <code>iris_table</code> and <code>mtcars_table</code> in duckdb <code>my-db.duckdb</code></p></li>
<li><p>There are table <code>iris</code> and <code>mtcars</code> R environment</p></li>
<li><p>There are table <code>iris</code> and <code>mtcars</code> Python environment</p></li>
</ul>
<section id="show-all-table" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> show all table</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">sql</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>SHOW <span class="kw">ALL</span> <span class="kw">TABLES</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>2 records</caption>
<colgroup>
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 3%">
<col style="width: 35%">
<col style="width: 54%">
<col style="width: 2%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">database</th>
<th style="text-align: left;">schema</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">column_names</th>
<th style="text-align: left;">column_types</th>
<th style="text-align: left;">temporary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">my-db</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">iris_table</td>
<td style="text-align: left;">Sepal.Length, Sepal.Width , Petal.Length, Petal.Width , Species</td>
<td style="text-align: left;">DOUBLE , DOUBLE , DOUBLE , DOUBLE , ENUM(‘setosa’, ‘versicolor’, ‘virginica’)</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">my-db</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">mtcars_table</td>
<td style="text-align: left;">model_name, mpg , cyl , disp , hp , drat , wt , qsec , vs , am , gear , carb</td>
<td style="text-align: left;">VARCHAR, DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE</td>
<td style="text-align: left;">FALSE</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>dflist <span class="ot">&lt;-</span> <span class="fu">Filter</span>(is.data.frame, <span class="fu">as.list</span>(.GlobalEnv))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dflist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "mtcars" "iris"  </code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>alldfs <span class="op">=</span> [var <span class="cf">for</span> var <span class="kw">in</span> <span class="bu">dir</span>() <span class="cf">if</span> <span class="bu">isinstance</span>(<span class="bu">eval</span>(var), pd.core.frame.DataFrame)]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alldfs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>['iris', 'mtcars']</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="describe-a-table" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Describe a table</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">sql</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>DESCRIBE mtcars_table;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<thead>
<tr class="header">
<th style="text-align: left;">column_name</th>
<th style="text-align: left;">column_type</th>
<th style="text-align: left;">null</th>
<th style="text-align: left;">key</th>
<th style="text-align: left;">default</th>
<th style="text-align: left;">extra</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">model_name</td>
<td style="text-align: left;">VARCHAR</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">mpg</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cyl</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">disp</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hp</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">drat</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wt</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">qsec</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">vs</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">am</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">mtcars</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">12</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">model_name</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 15%">
<col style="width: 10%">
<col style="width: 15%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mpg</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">20.37</td>
<td style="text-align: right;">2.91</td>
<td style="text-align: right;">14.30</td>
<td style="text-align: right;">18.82</td>
<td style="text-align: right;">21.00</td>
<td style="text-align: right;">22.45</td>
<td style="text-align: right;">24.40</td>
<td style="text-align: left;">▂▂▅▇▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">cyl</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5.80</td>
<td style="text-align: right;">1.48</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">4.50</td>
<td style="text-align: right;">6.00</td>
<td style="text-align: right;">6.00</td>
<td style="text-align: right;">8.00</td>
<td style="text-align: left;">▅▁▇▁▃</td>
</tr>
<tr class="odd">
<td style="text-align: left;">disp</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">208.61</td>
<td style="text-align: right;">90.37</td>
<td style="text-align: right;">108.00</td>
<td style="text-align: right;">150.02</td>
<td style="text-align: right;">163.80</td>
<td style="text-align: right;">249.75</td>
<td style="text-align: right;">360.00</td>
<td style="text-align: left;">▇▇▅▁▅</td>
</tr>
<tr class="even">
<td style="text-align: left;">hp</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">122.80</td>
<td style="text-align: right;">51.45</td>
<td style="text-align: right;">62.00</td>
<td style="text-align: right;">97.50</td>
<td style="text-align: right;">110.00</td>
<td style="text-align: right;">119.75</td>
<td style="text-align: right;">245.00</td>
<td style="text-align: left;">▅▇▁▂▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">drat</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.54</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">3.16</td>
<td style="text-align: right;">3.77</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">3.92</td>
<td style="text-align: left;">▁▃▁▁▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">wt</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.13</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">2.32</td>
<td style="text-align: right;">2.94</td>
<td style="text-align: right;">3.20</td>
<td style="text-align: right;">3.44</td>
<td style="text-align: right;">3.57</td>
<td style="text-align: left;">▂▂▂▆▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">qsec</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">18.58</td>
<td style="text-align: right;">2.14</td>
<td style="text-align: right;">15.84</td>
<td style="text-align: right;">17.02</td>
<td style="text-align: right;">18.45</td>
<td style="text-align: right;">19.86</td>
<td style="text-align: right;">22.90</td>
<td style="text-align: left;">▇▃▃▂▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">vs</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▅▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">am</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">gear</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.60</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: left;">▅▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">carb</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.50</td>
<td style="text-align: right;">1.35</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.25</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: left;">▆▆▁▁▇</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>mtcars.describe(include<span class="op">=</span><span class="st">'all'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       model_name        mpg       cyl  ...         am       gear       carb
count          10  10.000000  10.00000  ...  10.000000  10.000000  10.000000
unique         10        NaN       NaN  ...        NaN        NaN        NaN
top     Mazda RX4        NaN       NaN  ...        NaN        NaN        NaN
freq            1        NaN       NaN  ...        NaN        NaN        NaN
mean          NaN  20.370000   5.80000  ...   0.300000   3.600000   2.500000
std           NaN   2.907099   1.47573  ...   0.483046   0.516398   1.354006
min           NaN  14.300000   4.00000  ...   0.000000   3.000000   1.000000
25%           NaN  18.825000   4.50000  ...   0.000000   3.000000   1.250000
50%           NaN  21.000000   6.00000  ...   0.000000   4.000000   2.000000
75%           NaN  22.450000   6.00000  ...   0.750000   4.000000   4.000000
max           NaN  24.400000   8.00000  ...   1.000000   4.000000   4.000000

[11 rows x 12 columns]</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="show-column-name" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> show column name</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">sql</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>PRAGMA table_info(mtcars_table);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<thead>
<tr class="header">
<th style="text-align: left;">cid</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">notnull</th>
<th style="text-align: left;">dflt_value</th>
<th style="text-align: left;">pk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">model_name</td>
<td style="text-align: left;">VARCHAR</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">mpg</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">cyl</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">disp</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: left;">hp</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: left;">drat</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: left;">wt</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: left;">qsec</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: left;">vs</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: left;">am</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "model_name" "mpg"        "cyl"        "disp"       "hp"        
 [6] "drat"       "wt"         "qsec"       "vs"         "am"        
[11] "gear"       "carb"      </code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(mtcars.columns.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>['model_name', 'mpg', 'cyl', 'disp', 'hp', 'drat', 'wt', 'qsec', 'vs', 'am', 'gear', 'carb']</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="select" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> select</h1>
<section id="select-top-6-and-rename" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="select-top-6-and-rename"><span class="header-section-number">4.1</span> select top 6 and rename</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">sql</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">Python siuba</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name <span class="kw">as</span> model,mpg,cyl <span class="kw">from</span> mtcars_table <span class="kw">limit</span> <span class="dv">6</span> ;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>6 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hornet Sportabout</td>
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Valiant</td>
<td style="text-align: right;">18.1</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars,<span class="dv">6</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="at">model=</span>model_name,mpg,cyl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                              model  mpg cyl
Mazda RX4                 Mazda RX4 21.0   6
Mazda RX4 Wag         Mazda RX4 Wag 21.0   6
Datsun 710               Datsun 710 22.8   4
Hornet 4 Drive       Hornet 4 Drive 21.4   6
Hornet Sportabout Hornet Sportabout 18.7   8
Valiant                     Valiant 18.1   6</code></pre>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>mtcars.rename(columns<span class="op">=</span>{<span class="st">'model_name'</span>: <span class="st">'model'</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                               model   mpg  cyl   disp  ...   vs   am  gear  carb
Mazda RX4                  Mazda RX4  21.0  6.0  160.0  ...  0.0  1.0   4.0   4.0
Mazda RX4 Wag          Mazda RX4 Wag  21.0  6.0  160.0  ...  0.0  1.0   4.0   4.0
Datsun 710                Datsun 710  22.8  4.0  108.0  ...  1.0  1.0   4.0   1.0
Hornet 4 Drive        Hornet 4 Drive  21.4  6.0  258.0  ...  1.0  0.0   3.0   1.0
Hornet Sportabout  Hornet Sportabout  18.7  8.0  360.0  ...  0.0  0.0   3.0   2.0
Valiant                      Valiant  18.1  6.0  225.0  ...  1.0  0.0   3.0   1.0
Duster 360                Duster 360  14.3  8.0  360.0  ...  0.0  0.0   3.0   4.0
Merc 240D                  Merc 240D  24.4  4.0  146.7  ...  1.0  0.0   4.0   2.0
Merc 230                    Merc 230  22.8  4.0  140.8  ...  1.0  0.0   4.0   2.0
Merc 280                    Merc 280  19.2  6.0  167.6  ...  1.0  0.0   4.0   4.0

[10 rows x 12 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> siuba <span class="im">import</span> <span class="op">*</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="op">&gt;&gt;</span> rename(model<span class="op">=</span>_.model_name) <span class="op">&gt;&gt;</span> select(_.model, _.mpg, _.cyl) <span class="op">&gt;&gt;</span> head(<span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                               model   mpg  cyl
Mazda RX4                  Mazda RX4  21.0  6.0
Mazda RX4 Wag          Mazda RX4 Wag  21.0  6.0
Datsun 710                Datsun 710  22.8  4.0
Hornet 4 Drive        Hornet 4 Drive  21.4  6.0
Hornet Sportabout  Hornet Sportabout  18.7  8.0
Valiant                      Valiant  18.1  6.0</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="select-distinct" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="select-distinct"><span class="header-section-number">4.2</span> select distinct</h2>
<p>all distinct record of mpg and cyl</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">sql</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">Python siuba</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">distinct</span> mpg,cyl <span class="kw">from</span> mtcars_table;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>8 records</caption>
<thead>
<tr class="header">
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">19.2</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">18.1</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.3</td>
<td style="text-align: right;">8</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">distinct</span>(mpg,cyl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   mpg cyl
Mazda RX4         21.0   6
Datsun 710        22.8   4
Hornet 4 Drive    21.4   6
Hornet Sportabout 18.7   8
Valiant           18.1   6
Duster 360        14.3   8
Merc 240D         24.4   4
Merc 280          19.2   6</code></pre>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>mtcars[[<span class="st">"mpg"</span>, <span class="st">"cyl"</span>]]</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.drop_duplicates())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    mpg  cyl
Mazda RX4          21.0  6.0
Datsun 710         22.8  4.0
Hornet 4 Drive     21.4  6.0
Hornet Sportabout  18.7  8.0
Valiant            18.1  6.0
Duster 360         14.3  8.0
Merc 240D          24.4  4.0
Merc 280           19.2  6.0</code></pre>
</div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="op">&gt;&gt;</span> distinct(_.mpg, _.cyl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    mpg  cyl
0  21.0  6.0
1  22.8  4.0
2  21.4  6.0
3  18.7  8.0
4  18.1  6.0
5  14.3  8.0
6  24.4  4.0
7  19.2  6.0</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="check-row-number-and-column-number" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> check row number and column number</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">sql</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*Gives number of rows*/</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">as</span> <span class="fu">row_number</span> <span class="kw">from</span> mtcars_table;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead>
<tr class="header">
<th style="text-align: right;">row_number</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*Gives number of columns*/</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">as</span> column_number <span class="kw">from</span> (DESCRIBE mtcars_table);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead>
<tr class="header">
<th style="text-align: right;">column_number</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">12</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gives number of rows</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(mtcars) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># Gives number of columns</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(mtcars) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12</code></pre>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gives number of rows</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>mtcars.shape[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>10</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gives number of columns</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>mtcars.shape[<span class="dv">1</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>12</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="create-column" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> create column</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">sql</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-4" role="tab" aria-controls="tabset-7-4" aria-selected="false">Python siuba</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span>, mpg<span class="op">+</span><span class="dv">1</span> <span class="kw">as</span> new_mpg <span class="kw">from</span> mtcars_table;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
<th style="text-align: right;">disp</th>
<th style="text-align: right;">hp</th>
<th style="text-align: right;">drat</th>
<th style="text-align: right;">wt</th>
<th style="text-align: right;">qsec</th>
<th style="text-align: right;">vs</th>
<th style="text-align: right;">am</th>
<th style="text-align: right;">gear</th>
<th style="text-align: right;">carb</th>
<th style="text-align: right;">new_mpg</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">2.620</td>
<td style="text-align: right;">16.46</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">22.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">2.875</td>
<td style="text-align: right;">17.02</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">22.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">108.0</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">3.85</td>
<td style="text-align: right;">2.320</td>
<td style="text-align: right;">18.61</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">23.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">258.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">3.215</td>
<td style="text-align: right;">19.44</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">22.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hornet Sportabout</td>
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">360.0</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">3.15</td>
<td style="text-align: right;">3.440</td>
<td style="text-align: right;">17.02</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">19.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Valiant</td>
<td style="text-align: right;">18.1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">225.0</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">3.460</td>
<td style="text-align: right;">20.22</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">19.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Duster 360</td>
<td style="text-align: right;">14.3</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">360.0</td>
<td style="text-align: right;">245</td>
<td style="text-align: right;">3.21</td>
<td style="text-align: right;">3.570</td>
<td style="text-align: right;">15.84</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">15.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Merc 240D</td>
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">146.7</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">3.69</td>
<td style="text-align: right;">3.190</td>
<td style="text-align: right;">20.00</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">25.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Merc 230</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">140.8</td>
<td style="text-align: right;">95</td>
<td style="text-align: right;">3.92</td>
<td style="text-align: right;">3.150</td>
<td style="text-align: right;">22.90</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">23.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Merc 280</td>
<td style="text-align: right;">19.2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">167.6</td>
<td style="text-align: right;">123</td>
<td style="text-align: right;">3.92</td>
<td style="text-align: right;">3.440</td>
<td style="text-align: right;">18.30</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">20.2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">new_mpg=</span>mpg<span class="sc">+</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                         model_name  mpg cyl  disp  hp drat    wt  qsec vs am
Mazda RX4                 Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0  1
Mazda RX4 Wag         Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1
Datsun 710               Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1  1
Hornet 4 Drive       Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0
Hornet Sportabout Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0
Valiant                     Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1  0
Duster 360               Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0  0
Merc 240D                 Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1  0
Merc 230                   Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1  0
Merc 280                   Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1  0
                  gear carb new_mpg
Mazda RX4            4    4    22.0
Mazda RX4 Wag        4    4    22.0
Datsun 710           4    1    23.8
Hornet 4 Drive       3    1    22.4
Hornet Sportabout    3    2    19.7
Valiant              3    1    19.1
Duster 360           3    4    15.3
Merc 240D            4    2    25.4
Merc 230             4    2    23.8
Merc 280             4    4    20.2</code></pre>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>mtcars[<span class="st">"new_mpg"</span>]<span class="op">=</span>mtcars[<span class="st">"mpg"</span>]<span class="op">+</span><span class="dv">1</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>mtcars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                          model_name   mpg  cyl  ...  gear  carb  new_mpg
Mazda RX4                  Mazda RX4  21.0  6.0  ...   4.0   4.0     22.0
Mazda RX4 Wag          Mazda RX4 Wag  21.0  6.0  ...   4.0   4.0     22.0
Datsun 710                Datsun 710  22.8  4.0  ...   4.0   1.0     23.8
Hornet 4 Drive        Hornet 4 Drive  21.4  6.0  ...   3.0   1.0     22.4
Hornet Sportabout  Hornet Sportabout  18.7  8.0  ...   3.0   2.0     19.7
Valiant                      Valiant  18.1  6.0  ...   3.0   1.0     19.1
Duster 360                Duster 360  14.3  8.0  ...   3.0   4.0     15.3
Merc 240D                  Merc 240D  24.4  4.0  ...   4.0   2.0     25.4
Merc 230                    Merc 230  22.8  4.0  ...   4.0   2.0     23.8
Merc 280                    Merc 280  19.2  6.0  ...   4.0   4.0     20.2

[10 rows x 13 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-7-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="op">&gt;&gt;</span> mutate(new_mpg<span class="op">=</span>_.mpg<span class="op">+</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                          model_name   mpg  cyl  ...  gear  carb  new_mpg
Mazda RX4                  Mazda RX4  21.0  6.0  ...   4.0   4.0     22.0
Mazda RX4 Wag          Mazda RX4 Wag  21.0  6.0  ...   4.0   4.0     22.0
Datsun 710                Datsun 710  22.8  4.0  ...   4.0   1.0     23.8
Hornet 4 Drive        Hornet 4 Drive  21.4  6.0  ...   3.0   1.0     22.4
Hornet Sportabout  Hornet Sportabout  18.7  8.0  ...   3.0   2.0     19.7
Valiant                      Valiant  18.1  6.0  ...   3.0   1.0     19.1
Duster 360                Duster 360  14.3  8.0  ...   3.0   4.0     15.3
Merc 240D                  Merc 240D  24.4  4.0  ...   4.0   2.0     25.4
Merc 230                    Merc 230  22.8  4.0  ...   4.0   2.0     23.8
Merc 280                    Merc 280  19.2  6.0  ...   4.0   4.0     20.2

[10 rows x 13 columns]</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="filter" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Filter</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">sql</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-4" role="tab" aria-controls="tabset-8-4" aria-selected="false">Python siuba</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* and */</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">from</span> mtcars_table <span class="kw">where</span> mpg<span class="op">=</span><span class="dv">21</span> <span class="kw">and</span> cyl<span class="op">=</span><span class="dv">6</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>2 records</caption>
<colgroup>
<col style="width: 21%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
<th style="text-align: right;">disp</th>
<th style="text-align: right;">hp</th>
<th style="text-align: right;">drat</th>
<th style="text-align: right;">wt</th>
<th style="text-align: right;">qsec</th>
<th style="text-align: right;">vs</th>
<th style="text-align: right;">am</th>
<th style="text-align: right;">gear</th>
<th style="text-align: right;">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">2.620</td>
<td style="text-align: right;">16.46</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">2.875</td>
<td style="text-align: right;">17.02</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* or */</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">from</span> mtcars_table <span class="kw">where</span> mpg<span class="op">=</span><span class="dv">21</span> <span class="kw">or</span> cyl<span class="op">=</span><span class="dv">6</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>5 records</caption>
<colgroup>
<col style="width: 22%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
<th style="text-align: right;">disp</th>
<th style="text-align: right;">hp</th>
<th style="text-align: right;">drat</th>
<th style="text-align: right;">wt</th>
<th style="text-align: right;">qsec</th>
<th style="text-align: right;">vs</th>
<th style="text-align: right;">am</th>
<th style="text-align: right;">gear</th>
<th style="text-align: right;">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">2.620</td>
<td style="text-align: right;">16.46</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">2.875</td>
<td style="text-align: right;">17.02</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">258.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">3.215</td>
<td style="text-align: right;">19.44</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Valiant</td>
<td style="text-align: right;">18.1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">225.0</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">3.460</td>
<td style="text-align: right;">20.22</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Merc 280</td>
<td style="text-align: right;">19.2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">167.6</td>
<td style="text-align: right;">123</td>
<td style="text-align: right;">3.92</td>
<td style="text-align: right;">3.440</td>
<td style="text-align: right;">18.30</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># and</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(mpg<span class="sc">==</span><span class="dv">21</span><span class="sc">&amp;</span>cyl<span class="sc">==</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 model_name mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         Mazda RX4  21   6  160 110  3.9 2.620 16.46  0  1    4    4
Mazda RX4 Wag Mazda RX4 Wag  21   6  160 110  3.9 2.875 17.02  0  1    4    4</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(mpg<span class="sc">==</span><span class="dv">21</span><span class="sc">|</span>cyl<span class="sc">==</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   model_name  mpg cyl  disp  hp drat    wt  qsec vs am gear
Mazda RX4           Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0  1    4
Mazda RX4 Wag   Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1    4
Hornet 4 Drive Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0    3
Valiant               Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1  0    3
Merc 280             Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1  0    4
               carb
Mazda RX4         4
Mazda RX4 Wag     4
Hornet 4 Drive    1
Valiant           1
Merc 280          4</code></pre>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># and</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>mtcars.query(<span class="st">'mpg==21 and cyl==6'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                  model_name   mpg  cyl   disp  ...   am  gear  carb  new_mpg
Mazda RX4          Mazda RX4  21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0
Mazda RX4 Wag  Mazda RX4 Wag  21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0

[2 rows x 13 columns]</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>mtcars.query(<span class="st">'mpg==21 or cyl==6'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    model_name   mpg  cyl   disp  ...   am  gear  carb  new_mpg
Mazda RX4            Mazda RX4  21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0
Mazda RX4 Wag    Mazda RX4 Wag  21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0
Hornet 4 Drive  Hornet 4 Drive  21.4  6.0  258.0  ...  0.0   3.0   1.0     22.4
Valiant                Valiant  18.1  6.0  225.0  ...  0.0   3.0   1.0     19.1
Merc 280              Merc 280  19.2  6.0  167.6  ...  0.0   4.0   4.0     20.2

[5 rows x 13 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-8-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># and</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="op">&gt;&gt;</span> <span class="bu">filter</span>(_.mpg<span class="op">==</span><span class="dv">21</span>,_.cyl<span class="op">==</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                  model_name   mpg  cyl   disp  ...   am  gear  carb  new_mpg
Mazda RX4          Mazda RX4  21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0
Mazda RX4 Wag  Mazda RX4 Wag  21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0

[2 rows x 13 columns]</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="op">&gt;&gt;</span> <span class="bu">filter</span>((_.mpg<span class="op">==</span><span class="dv">21</span>) <span class="op">|</span>(_.cyl<span class="op">==</span><span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    model_name   mpg  cyl   disp  ...   am  gear  carb  new_mpg
Mazda RX4            Mazda RX4  21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0
Mazda RX4 Wag    Mazda RX4 Wag  21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0
Hornet 4 Drive  Hornet 4 Drive  21.4  6.0  258.0  ...  0.0   3.0   1.0     22.4
Valiant                Valiant  18.1  6.0  225.0  ...  0.0   3.0   1.0     19.1
Merc 280              Merc 280  19.2  6.0  167.6  ...  0.0   4.0   4.0     20.2

[5 rows x 13 columns]</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="order" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> order</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">sql</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-4" role="tab" aria-controls="tabset-9-4" aria-selected="false">Python siuba</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name <span class="kw">as</span> model,mpg,cyl <span class="kw">from</span> mtcars_table <span class="kw">order</span> <span class="kw">by</span> mpg <span class="kw">desc</span> <span class="kw">limit</span> <span class="dv">3</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>3 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Merc 240D</td>
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Merc 230</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="at">model=</span>model_name,mpg,cyl) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(mpg)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                model  mpg cyl
Merc 240D   Merc 240D 24.4   4
Datsun 710 Datsun 710 22.8   4
Merc 230     Merc 230 22.8   4</code></pre>
</div>
</div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>mtcars[[<span class="st">"model_name"</span>,<span class="st">"mpg"</span>,<span class="st">"cyl"</span>]].sort_values(by<span class="op">=</span><span class="st">'mpg'</span>,ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            model_name   mpg  cyl
Merc 240D    Merc 240D  24.4  4.0
Datsun 710  Datsun 710  22.8  4.0
Merc 230      Merc 230  22.8  4.0</code></pre>
</div>
</div>
</div>
<div id="tabset-9-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="op">&gt;&gt;</span> select(_.model_name,_.mpg,_.cyl) <span class="op">&gt;&gt;</span> arrange(<span class="op">-</span>_.mpg) <span class="op">&gt;&gt;</span> head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            model_name   mpg  cyl
Merc 240D    Merc 240D  24.4  4.0
Datsun 710  Datsun 710  22.8  4.0
Merc 230      Merc 230  22.8  4.0</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="group-by" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> group by</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">sql</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-4" role="tab" aria-controls="tabset-10-4" aria-selected="false">Python siuba</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, <span class="fu">sum</span>(mpg) <span class="kw">as</span> total_mpg,mean(cyl) <span class="kw">as</span> cyl_mean <span class="kw">from</span> mtcars_table</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="kw">group</span> <span class="kw">by</span> <span class="dv">1</span> <span class="kw">limit</span> <span class="dv">5</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>5 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">total_mpg</th>
<th style="text-align: right;">cyl_mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Valiant</td>
<td style="text-align: right;">18.1</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Merc 240D</td>
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">group_by</span>(model_name) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="at">total_mpg=</span><span class="fu">sum</span>(mpg),<span class="at">cyl_mean=</span><span class="fu">mean</span>(cyl)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  model_name        total_mpg cyl_mean
  &lt;chr&gt;                 &lt;dbl&gt;    &lt;dbl&gt;
1 Datsun 710             22.8        4
2 Duster 360             14.3        8
3 Hornet 4 Drive         21.4        6
4 Hornet Sportabout      18.7        8
5 Mazda RX4              21          6</code></pre>
</div>
</div>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>mtcars.groupby(<span class="st">'model_name'</span>).agg({<span class="st">'mpg'</span>: <span class="st">'sum'</span>, <span class="st">'cyl'</span>: <span class="st">'mean'</span>}).head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    mpg  cyl
model_name                  
Datsun 710         22.8  4.0
Duster 360         14.3  8.0
Hornet 4 Drive     21.4  6.0
Hornet Sportabout  18.7  8.0
Mazda RX4          21.0  6.0</code></pre>
</div>
</div>
</div>
<div id="tabset-10-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="op">&gt;&gt;</span> group_by(_.model_name) <span class="op">&gt;&gt;</span> summarize(total_mpg<span class="op">=</span>_.mpg.<span class="bu">sum</span>(),cyl_mean<span class="op">=</span>_.cyl.mean()) <span class="op">&gt;&gt;</span> head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          model_name  total_mpg  cyl_mean
0         Datsun 710       22.8       4.0
1         Duster 360       14.3       8.0
2     Hornet 4 Drive       21.4       6.0
3  Hornet Sportabout       18.7       8.0
4          Mazda RX4       21.0       6.0</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="create-table" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> create table</h1>
<section id="create-or-replace" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="create-or-replace"><span class="header-section-number">10.1</span> CREATE OR REPLACE</h2>
<p>allows a new table to be created or for an existing table to be overwritten by the new table. This is shorthand for dropping the existing table and then creating the new one.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">OR</span> <span class="kw">REPLACE</span> temp <span class="kw">table</span> mtcars_table_group <span class="kw">as</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, <span class="fu">sum</span>(mpg) <span class="kw">as</span> total_mpg,mean(cyl) <span class="kw">as</span> cyl_mean <span class="kw">from</span> mtcars_table</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="kw">group</span> <span class="kw">by</span> <span class="dv">1</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="create-table-if-not-exists" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="create-table-if-not-exists"><span class="header-section-number">10.2</span> CREATE TABLE IF NOT EXISTS</h2>
<p>will only proceed with the creation of the table if it does not already exist. If the table already exists, no action will be taken and the existing table will remain in the database.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">NOT</span> <span class="kw">EXISTS</span>  new_mtcars_table_group <span class="kw">as</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, <span class="fu">sum</span>(mpg) <span class="kw">as</span> total_mpg,mean(cyl) <span class="kw">as</span> cyl_mean <span class="kw">from</span> mtcars_table</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="kw">group</span> <span class="kw">by</span> <span class="dv">1</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="unique" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> unique</h1>
<section id="check-unique" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="check-unique"><span class="header-section-number">11.1</span> check unique</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>),<span class="fu">count</span>(<span class="kw">distinct</span> model_name) <span class="kw">from</span> mtcars_table</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead>
<tr class="header">
<th style="text-align: right;">count_star()</th>
<th style="text-align: right;">count(DISTINCT model_name)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="join" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> join</h1>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="op">*</span> <span class="kw">from</span> mtcars_table_group t1 ;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<thead>
<tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">total_mpg</th>
<th style="text-align: right;">cyl_mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Valiant</td>
<td style="text-align: right;">18.1</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Merc 240D</td>
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Duster 360</td>
<td style="text-align: right;">14.3</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Merc 280</td>
<td style="text-align: right;">19.2</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hornet Sportabout</td>
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Merc 230</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="left-join" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="left-join"><span class="header-section-number">12.1</span> left join</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">sql</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-4" role="tab" aria-controls="tabset-11-4" aria-selected="false">Python siuba</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t1.model_name,t1.mpg ,t1.cyl,t2.<span class="op">*</span> <span class="kw">from</span> mtcars_table t1 </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="kw">left</span> <span class="kw">join</span> mtcars_table_group t2 <span class="kw">on</span> t1.model_name <span class="op">=</span> t2.model_name</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="kw">limit</span> <span class="dv">5</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>5 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">total_mpg</th>
<th style="text-align: right;">cyl_mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hornet Sportabout</td>
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">Hornet Sportabout</td>
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">8</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">left_join</span>(mtcars, <span class="at">by =</span> <span class="fu">join_by</span>(model_name <span class="sc">==</span> model_name)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         model_name mpg.x cyl.x disp.x hp.x drat.x  wt.x qsec.x vs.x am.x
1         Mazda RX4  21.0     6    160  110   3.90 2.620  16.46    0    1
2     Mazda RX4 Wag  21.0     6    160  110   3.90 2.875  17.02    0    1
3        Datsun 710  22.8     4    108   93   3.85 2.320  18.61    1    1
4    Hornet 4 Drive  21.4     6    258  110   3.08 3.215  19.44    1    0
5 Hornet Sportabout  18.7     8    360  175   3.15 3.440  17.02    0    0
  gear.x carb.x mpg.y cyl.y disp.y hp.y drat.y  wt.y qsec.y vs.y am.y gear.y
1      4      4  21.0     6    160  110   3.90 2.620  16.46    0    1      4
2      4      4  21.0     6    160  110   3.90 2.875  17.02    0    1      4
3      4      1  22.8     4    108   93   3.85 2.320  18.61    1    1      4
4      3      1  21.4     6    258  110   3.08 3.215  19.44    1    0      3
5      3      2  18.7     8    360  175   3.15 3.440  17.02    0    0      3
  carb.y
1      4
2      4
3      1
4      1
5      2</code></pre>
</div>
</div>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>pd.merge(mtcars, mtcars, left_on<span class="op">=</span><span class="st">'model_name'</span>, right_on<span class="op">=</span><span class="st">'model_name'</span>, how<span class="op">=</span><span class="st">'left'</span>).head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          model_name  mpg_x  cyl_x  disp_x  ...  am_y  gear_y  carb_y  new_mpg_y
0          Mazda RX4   21.0    6.0   160.0  ...   1.0     4.0     4.0       22.0
1      Mazda RX4 Wag   21.0    6.0   160.0  ...   1.0     4.0     4.0       22.0
2         Datsun 710   22.8    4.0   108.0  ...   1.0     4.0     1.0       23.8
3     Hornet 4 Drive   21.4    6.0   258.0  ...   0.0     3.0     1.0       22.4
4  Hornet Sportabout   18.7    8.0   360.0  ...   0.0     3.0     2.0       19.7

[5 rows x 25 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-11-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="op">&gt;&gt;</span> left_join(_,mtcars, on <span class="op">=</span> {<span class="st">"model_name"</span>: <span class="st">"model_name"</span>}) <span class="op">&gt;&gt;</span> head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          model_name  mpg_x  cyl_x  disp_x  ...  am_y  gear_y  carb_y  new_mpg_y
0          Mazda RX4   21.0    6.0   160.0  ...   1.0     4.0     4.0       22.0
1      Mazda RX4 Wag   21.0    6.0   160.0  ...   1.0     4.0     4.0       22.0
2         Datsun 710   22.8    4.0   108.0  ...   1.0     4.0     1.0       23.8
3     Hornet 4 Drive   21.4    6.0   258.0  ...   0.0     3.0     1.0       22.4
4  Hornet Sportabout   18.7    8.0   360.0  ...   0.0     3.0     2.0       19.7

[5 rows x 25 columns]</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="inter-join" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="inter-join"><span class="header-section-number">12.2</span> inter join</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">sql</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-4" role="tab" aria-controls="tabset-12-4" aria-selected="false">Python siuba</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t1.model_name,t1.mpg ,t1.cyl,t2.<span class="op">*</span> <span class="kw">from</span> mtcars_table t1 </span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="kw">inner</span> <span class="kw">join</span> (<span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> mtcars_table_group <span class="kw">limit</span> <span class="dv">5</span>) t2 <span class="kw">on</span> t1.model_name <span class="op">=</span> t2.model_name</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>5 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">total_mpg</th>
<th style="text-align: right;">cyl_mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Valiant</td>
<td style="text-align: right;">18.1</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Valiant</td>
<td style="text-align: right;">18.1</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Duster 360</td>
<td style="text-align: right;">14.3</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">Duster 360</td>
<td style="text-align: right;">14.3</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Merc 240D</td>
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Merc 240D</td>
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Merc 280</td>
<td style="text-align: right;">19.2</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Merc 280</td>
<td style="text-align: right;">19.2</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">inner_join</span>(mtcars, <span class="at">by =</span> <span class="fu">join_by</span>(model_name <span class="sc">==</span> model_name)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         model_name mpg.x cyl.x disp.x hp.x drat.x  wt.x qsec.x vs.x am.x
1         Mazda RX4  21.0     6    160  110   3.90 2.620  16.46    0    1
2     Mazda RX4 Wag  21.0     6    160  110   3.90 2.875  17.02    0    1
3        Datsun 710  22.8     4    108   93   3.85 2.320  18.61    1    1
4    Hornet 4 Drive  21.4     6    258  110   3.08 3.215  19.44    1    0
5 Hornet Sportabout  18.7     8    360  175   3.15 3.440  17.02    0    0
  gear.x carb.x mpg.y cyl.y disp.y hp.y drat.y  wt.y qsec.y vs.y am.y gear.y
1      4      4  21.0     6    160  110   3.90 2.620  16.46    0    1      4
2      4      4  21.0     6    160  110   3.90 2.875  17.02    0    1      4
3      4      1  22.8     4    108   93   3.85 2.320  18.61    1    1      4
4      3      1  21.4     6    258  110   3.08 3.215  19.44    1    0      3
5      3      2  18.7     8    360  175   3.15 3.440  17.02    0    0      3
  carb.y
1      4
2      4
3      1
4      1
5      2</code></pre>
</div>
</div>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>pd.merge(mtcars, mtcars, left_on<span class="op">=</span><span class="st">'model_name'</span>, right_on<span class="op">=</span><span class="st">'model_name'</span>, how<span class="op">=</span><span class="st">'inner'</span>).head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          model_name  mpg_x  cyl_x  disp_x  ...  am_y  gear_y  carb_y  new_mpg_y
0          Mazda RX4   21.0    6.0   160.0  ...   1.0     4.0     4.0       22.0
1      Mazda RX4 Wag   21.0    6.0   160.0  ...   1.0     4.0     4.0       22.0
2         Datsun 710   22.8    4.0   108.0  ...   1.0     4.0     1.0       23.8
3     Hornet 4 Drive   21.4    6.0   258.0  ...   0.0     3.0     1.0       22.4
4  Hornet Sportabout   18.7    8.0   360.0  ...   0.0     3.0     2.0       19.7

[5 rows x 25 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-12-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="op">&gt;&gt;</span> inner_join(_,mtcars, on <span class="op">=</span> {<span class="st">"model_name"</span>: <span class="st">"model_name"</span>}) <span class="op">&gt;&gt;</span> head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          model_name  mpg_x  cyl_x  disp_x  ...  am_y  gear_y  carb_y  new_mpg_y
0          Mazda RX4   21.0    6.0   160.0  ...   1.0     4.0     4.0       22.0
1      Mazda RX4 Wag   21.0    6.0   160.0  ...   1.0     4.0     4.0       22.0
2         Datsun 710   22.8    4.0   108.0  ...   1.0     4.0     1.0       23.8
3     Hornet 4 Drive   21.4    6.0   258.0  ...   0.0     3.0     1.0       22.4
4  Hornet Sportabout   18.7    8.0   360.0  ...   0.0     3.0     2.0       19.7

[5 rows x 25 columns]</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="append-rows" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> append rows</h1>
<section id="append-without-duplicate-elimination-union-all" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="append-without-duplicate-elimination-union-all"><span class="header-section-number">13.1</span> append without duplicate elimination <code>union all</code></h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">sql</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">from</span> mtcars_table</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead>
<tr class="header">
<th style="text-align: right;">count_star()</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> temp <span class="kw">table</span> double_mtcars_table <span class="kw">as</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">from</span> mtcars_table </span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="kw">union</span> <span class="kw">all</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">from</span> mtcars_table </span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">from</span> double_mtcars_table</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead>
<tr class="header">
<th style="text-align: right;">count_star()</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">20</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>(mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                              model_name  mpg cyl  disp  hp drat    wt  qsec vs
Mazda RX4...1                  Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0
Mazda RX4 Wag...2          Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0
Datsun 710...3                Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1
Hornet 4 Drive...4        Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1
Hornet Sportabout...5  Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0
Valiant...6                      Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1
Duster 360...7                Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0
Merc 240D...8                  Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1
Merc 230...9                    Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1
Merc 280...10                   Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1
Mazda RX4...11                 Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0
Mazda RX4 Wag...12         Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0
Datsun 710...13               Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1
Hornet 4 Drive...14       Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1
Hornet Sportabout...15 Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0
Valiant...16                     Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1
Duster 360...17               Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0
Merc 240D...18                 Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1
Merc 230...19                   Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1
Merc 280...20                   Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1
                       am gear carb
Mazda RX4...1           1    4    4
Mazda RX4 Wag...2       1    4    4
Datsun 710...3          1    4    1
Hornet 4 Drive...4      0    3    1
Hornet Sportabout...5   0    3    2
Valiant...6             0    3    1
Duster 360...7          0    3    4
Merc 240D...8           0    4    2
Merc 230...9            0    4    2
Merc 280...10           0    4    4
Mazda RX4...11          1    4    4
Mazda RX4 Wag...12      1    4    4
Datsun 710...13         1    4    1
Hornet 4 Drive...14     0    3    1
Hornet Sportabout...15  0    3    2
Valiant...16            0    3    1
Duster 360...17         0    3    4
Merc 240D...18          0    4    2
Merc 230...19           0    4    2
Merc 280...20           0    4    4</code></pre>
</div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>pd.concat([mtcars,mtcars],ignore_index<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           model_name   mpg  cyl   disp     hp  ...   vs   am  gear  carb  new_mpg
0           Mazda RX4  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0
1       Mazda RX4 Wag  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0
2          Datsun 710  22.8  4.0  108.0   93.0  ...  1.0  1.0   4.0   1.0     23.8
3      Hornet 4 Drive  21.4  6.0  258.0  110.0  ...  1.0  0.0   3.0   1.0     22.4
4   Hornet Sportabout  18.7  8.0  360.0  175.0  ...  0.0  0.0   3.0   2.0     19.7
5             Valiant  18.1  6.0  225.0  105.0  ...  1.0  0.0   3.0   1.0     19.1
6          Duster 360  14.3  8.0  360.0  245.0  ...  0.0  0.0   3.0   4.0     15.3
7           Merc 240D  24.4  4.0  146.7   62.0  ...  1.0  0.0   4.0   2.0     25.4
8            Merc 230  22.8  4.0  140.8   95.0  ...  1.0  0.0   4.0   2.0     23.8
9            Merc 280  19.2  6.0  167.6  123.0  ...  1.0  0.0   4.0   4.0     20.2
10          Mazda RX4  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0
11      Mazda RX4 Wag  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0
12         Datsun 710  22.8  4.0  108.0   93.0  ...  1.0  1.0   4.0   1.0     23.8
13     Hornet 4 Drive  21.4  6.0  258.0  110.0  ...  1.0  0.0   3.0   1.0     22.4
14  Hornet Sportabout  18.7  8.0  360.0  175.0  ...  0.0  0.0   3.0   2.0     19.7
15            Valiant  18.1  6.0  225.0  105.0  ...  1.0  0.0   3.0   1.0     19.1
16         Duster 360  14.3  8.0  360.0  245.0  ...  0.0  0.0   3.0   4.0     15.3
17          Merc 240D  24.4  4.0  146.7   62.0  ...  1.0  0.0   4.0   2.0     25.4
18           Merc 230  22.8  4.0  140.8   95.0  ...  1.0  0.0   4.0   2.0     23.8
19           Merc 280  19.2  6.0  167.6  123.0  ...  1.0  0.0   4.0   4.0     20.2

[20 rows x 13 columns]</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="append-with-duplicate-elimination-union" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="append-with-duplicate-elimination-union"><span class="header-section-number">13.2</span> append with duplicate elimination <code>union</code></h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">sql</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">OR</span> <span class="kw">REPLACE</span> temp <span class="kw">table</span> double_mtcars_table <span class="kw">as</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">from</span> mtcars_table </span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="kw">union</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">from</span> mtcars_table </span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">from</span> double_mtcars_table</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead>
<tr class="header">
<th style="text-align: right;">count_star()</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">from</span> (</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">distinct</span> <span class="op">*</span> <span class="kw">from</span> double_mtcars_table</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead>
<tr class="header">
<th style="text-align: right;">count_star()</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>(mtcars) <span class="sc">|&gt;</span> <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                         model_name  mpg cyl  disp  hp drat    wt  qsec vs am
Mazda RX4                 Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0  1
Mazda RX4 Wag         Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1
Datsun 710               Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1  1
Hornet 4 Drive       Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0
Hornet Sportabout Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0
Valiant                     Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1  0
Duster 360               Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0  0
Merc 240D                 Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1  0
Merc 230                   Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1  0
Merc 280                   Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1  0
                  gear carb
Mazda RX4            4    4
Mazda RX4 Wag        4    4
Datsun 710           4    1
Hornet 4 Drive       3    1
Hornet Sportabout    3    2
Valiant              3    1
Duster 360           3    4
Merc 240D            4    2
Merc 230             4    2
Merc 280             4    4</code></pre>
</div>
</div>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>pd.concat([mtcars,mtcars],ignore_index<span class="op">=</span><span class="va">True</span>).drop_duplicates()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          model_name   mpg  cyl   disp     hp  ...   vs   am  gear  carb  new_mpg
0          Mazda RX4  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0
1      Mazda RX4 Wag  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0
2         Datsun 710  22.8  4.0  108.0   93.0  ...  1.0  1.0   4.0   1.0     23.8
3     Hornet 4 Drive  21.4  6.0  258.0  110.0  ...  1.0  0.0   3.0   1.0     22.4
4  Hornet Sportabout  18.7  8.0  360.0  175.0  ...  0.0  0.0   3.0   2.0     19.7
5            Valiant  18.1  6.0  225.0  105.0  ...  1.0  0.0   3.0   1.0     19.1
6         Duster 360  14.3  8.0  360.0  245.0  ...  0.0  0.0   3.0   4.0     15.3
7          Merc 240D  24.4  4.0  146.7   62.0  ...  1.0  0.0   4.0   2.0     25.4
8           Merc 230  22.8  4.0  140.8   95.0  ...  1.0  0.0   4.0   2.0     23.8
9           Merc 280  19.2  6.0  167.6  123.0  ...  1.0  0.0   4.0   4.0     20.2

[10 rows x 13 columns]</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="delete-rows" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> delete rows</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">sql</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-4" role="tab" aria-controls="tabset-15-4" aria-selected="false">Python siuba</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DELETE</span> <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> model_name <span class="op">=</span> <span class="st">'Mazda RX4'</span>;</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">from</span> mtcars_table</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead>
<tr class="header">
<th style="text-align: right;">count_star()</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(model_name <span class="sc">!=</span> <span class="st">'Mazda RX4'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                         model_name  mpg cyl  disp  hp drat    wt  qsec vs am
Mazda RX4 Wag         Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1
Datsun 710               Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1  1
Hornet 4 Drive       Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0
Hornet Sportabout Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0
Valiant                     Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1  0
Duster 360               Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0  0
Merc 240D                 Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1  0
Merc 230                   Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1  0
Merc 280                   Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1  0
                  gear carb
Mazda RX4 Wag        4    4
Datsun 710           4    1
Hornet 4 Drive       3    1
Hornet Sportabout    3    2
Valiant              3    1
Duster 360           3    4
Merc 240D            4    2
Merc 230             4    2
Merc 280             4    4</code></pre>
</div>
</div>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>mtcars[mtcars[<span class="st">'model_name'</span>] <span class="op">!=</span> <span class="st">'Mazda RX4'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                          model_name   mpg  cyl  ...  gear  carb  new_mpg
Mazda RX4 Wag          Mazda RX4 Wag  21.0  6.0  ...   4.0   4.0     22.0
Datsun 710                Datsun 710  22.8  4.0  ...   4.0   1.0     23.8
Hornet 4 Drive        Hornet 4 Drive  21.4  6.0  ...   3.0   1.0     22.4
Hornet Sportabout  Hornet Sportabout  18.7  8.0  ...   3.0   2.0     19.7
Valiant                      Valiant  18.1  6.0  ...   3.0   1.0     19.1
Duster 360                Duster 360  14.3  8.0  ...   3.0   4.0     15.3
Merc 240D                  Merc 240D  24.4  4.0  ...   4.0   2.0     25.4
Merc 230                    Merc 230  22.8  4.0  ...   4.0   2.0     23.8
Merc 280                    Merc 280  19.2  6.0  ...   4.0   4.0     20.2

[9 rows x 13 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-15-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="op">&gt;&gt;</span> <span class="bu">filter</span>(_.model_name <span class="op">!=</span> <span class="st">'Mazda RX4'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                          model_name   mpg  cyl  ...  gear  carb  new_mpg
Mazda RX4 Wag          Mazda RX4 Wag  21.0  6.0  ...   4.0   4.0     22.0
Datsun 710                Datsun 710  22.8  4.0  ...   4.0   1.0     23.8
Hornet 4 Drive        Hornet 4 Drive  21.4  6.0  ...   3.0   1.0     22.4
Hornet Sportabout  Hornet Sportabout  18.7  8.0  ...   3.0   2.0     19.7
Valiant                      Valiant  18.1  6.0  ...   3.0   1.0     19.1
Duster 360                Duster 360  14.3  8.0  ...   3.0   4.0     15.3
Merc 240D                  Merc 240D  24.4  4.0  ...   4.0   2.0     25.4
Merc 230                    Merc 230  22.8  4.0  ...   4.0   2.0     23.8
Merc 280                    Merc 280  19.2  6.0  ...   4.0   4.0     20.2

[9 rows x 13 columns]</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="update-rows" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> update rows</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true">sql</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-3" role="tab" aria-controls="tabset-16-3" aria-selected="false">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-4" role="tab" aria-controls="tabset-16-4" aria-selected="false">Python siuba</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> model_name,mpg  <span class="kw">from</span> mtcars_table <span class="kw">where</span> model_name<span class="op">=</span> <span class="st">'Mazda RX4'</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top">
<caption>0 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">mpg</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="kw">UPDATE</span> mtcars_table</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SET</span> mpg <span class="op">=</span> <span class="dv">999</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> model_name<span class="op">=</span> <span class="st">'Mazda RX4'</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> model_name,mpg <span class="kw">from</span> mtcars_table <span class="kw">where</span> model_name<span class="op">=</span> <span class="st">'Mazda RX4'</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top">
<caption>0 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">mpg</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(model_name <span class="sc">==</span> <span class="st">'Mazda RX4 Wag'</span>) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">mpg=</span><span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 model_name mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4 Wag Mazda RX4 Wag 999   6  160 110  3.9 2.875 17.02  0  1    4    4</code></pre>
</div>
</div>
</div>
<div id="tabset-16-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>mtcars.loc[mtcars[<span class="st">'model_name'</span>] <span class="op">==</span> <span class="st">'Mazda RX4 Wag'</span>, <span class="st">'mpg'</span>] <span class="op">=</span> <span class="dv">999</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>mtcars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                          model_name    mpg  cyl  ...  gear  carb  new_mpg
Mazda RX4                  Mazda RX4   21.0  6.0  ...   4.0   4.0     22.0
Mazda RX4 Wag          Mazda RX4 Wag  999.0  6.0  ...   4.0   4.0     22.0
Datsun 710                Datsun 710   22.8  4.0  ...   4.0   1.0     23.8
Hornet 4 Drive        Hornet 4 Drive   21.4  6.0  ...   3.0   1.0     22.4
Hornet Sportabout  Hornet Sportabout   18.7  8.0  ...   3.0   2.0     19.7
Valiant                      Valiant   18.1  6.0  ...   3.0   1.0     19.1
Duster 360                Duster 360   14.3  8.0  ...   3.0   4.0     15.3
Merc 240D                  Merc 240D   24.4  4.0  ...   4.0   2.0     25.4
Merc 230                    Merc 230   22.8  4.0  ...   4.0   2.0     23.8
Merc 280                    Merc 280   19.2  6.0  ...   4.0   4.0     20.2

[10 rows x 13 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-16-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="op">&gt;&gt;</span> <span class="bu">filter</span>(_.model_name <span class="op">==</span> <span class="st">'Mazda RX4 Wag'</span>) <span class="op">&gt;&gt;</span> mutate(mpg<span class="op">=</span><span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                  model_name  mpg  cyl   disp  ...   am  gear  carb  new_mpg
Mazda RX4 Wag  Mazda RX4 Wag  999  6.0  160.0  ...  1.0   4.0   4.0     22.0

[1 rows x 13 columns]</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="drop-table" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> drop table</h1>
<p>Before drop</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>SHOW <span class="kw">ALL</span> <span class="kw">TABLES</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>5 records</caption>
<colgroup>
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 5%">
<col style="width: 34%">
<col style="width: 53%">
<col style="width: 2%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">database</th>
<th style="text-align: left;">schema</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">column_names</th>
<th style="text-align: left;">column_types</th>
<th style="text-align: left;">temporary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">my-db</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">iris_table</td>
<td style="text-align: left;">Sepal.Length, Sepal.Width , Petal.Length, Petal.Width , Species</td>
<td style="text-align: left;">DOUBLE , DOUBLE , DOUBLE , DOUBLE , ENUM(‘setosa’, ‘versicolor’, ‘virginica’)</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">my-db</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">mtcars_table</td>
<td style="text-align: left;">model_name, mpg , cyl , disp , hp , drat , wt , qsec , vs , am , gear , carb</td>
<td style="text-align: left;">VARCHAR, DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">my-db</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">new_mtcars_table_group</td>
<td style="text-align: left;">model_name, total_mpg , cyl_mean</td>
<td style="text-align: left;">VARCHAR, DOUBLE , DOUBLE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">temp</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">double_mtcars_table</td>
<td style="text-align: left;">model_name, mpg , cyl , disp , hp , drat , wt , qsec , vs , am , gear , carb</td>
<td style="text-align: left;">VARCHAR, DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">temp</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">mtcars_table_group</td>
<td style="text-align: left;">model_name, total_mpg , cyl_mean</td>
<td style="text-align: left;">VARCHAR, DOUBLE , DOUBLE</td>
<td style="text-align: left;">TRUE</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>dropping</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">table</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> mtcars_table_group;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>after drop</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>SHOW <span class="kw">ALL</span> <span class="kw">TABLES</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>4 records</caption>
<colgroup>
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 5%">
<col style="width: 34%">
<col style="width: 53%">
<col style="width: 2%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">database</th>
<th style="text-align: left;">schema</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">column_names</th>
<th style="text-align: left;">column_types</th>
<th style="text-align: left;">temporary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">my-db</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">iris_table</td>
<td style="text-align: left;">Sepal.Length, Sepal.Width , Petal.Length, Petal.Width , Species</td>
<td style="text-align: left;">DOUBLE , DOUBLE , DOUBLE , DOUBLE , ENUM(‘setosa’, ‘versicolor’, ‘virginica’)</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">my-db</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">mtcars_table</td>
<td style="text-align: left;">model_name, mpg , cyl , disp , hp , drat , wt , qsec , vs , am , gear , carb</td>
<td style="text-align: left;">VARCHAR, DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">my-db</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">new_mtcars_table_group</td>
<td style="text-align: left;">model_name, total_mpg , cyl_mean</td>
<td style="text-align: left;">VARCHAR, DOUBLE , DOUBLE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">temp</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">double_mtcars_table</td>
<td style="text-align: left;">model_name, mpg , cyl , disp , hp , drat , wt , qsec , vs , am , gear , carb</td>
<td style="text-align: left;">VARCHAR, DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE</td>
<td style="text-align: left;">TRUE</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="pivot" class="level1" data-number="17">
<h1 data-number="17"><span class="header-section-number">17</span> PIVOT</h1>
<p>long to wide</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">table</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> cities;</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> temp <span class="kw">TABLE</span>  cities (</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>    country <span class="dt">VARCHAR</span>, name <span class="dt">VARCHAR</span>, <span class="dt">year</span> <span class="dt">INTEGER</span>, population <span class="dt">INTEGER</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> cities <span class="kw">VALUES</span></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'NL'</span>, <span class="st">'Amsterdam'</span>, <span class="dv">2000</span>, <span class="dv">1005</span>),</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'NL'</span>, <span class="st">'Amsterdam'</span>, <span class="dv">2010</span>, <span class="dv">1065</span>),</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'NL'</span>, <span class="st">'Amsterdam'</span>, <span class="dv">2020</span>, <span class="dv">1158</span>),</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'Seattle'</span>, <span class="dv">2000</span>, <span class="dv">564</span>),</span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'Seattle'</span>, <span class="dv">2010</span>, <span class="dv">608</span>),</span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'Seattle'</span>, <span class="dv">2020</span>, <span class="dv">738</span>),</span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'New York City'</span>, <span class="dv">2000</span>, <span class="dv">8015</span>),</span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'New York City'</span>, <span class="dv">2010</span>, <span class="dv">8175</span>),</span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'New York City'</span>, <span class="dv">2020</span>, <span class="dv">8772</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cities;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>9 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">country</th>
<th style="text-align: left;">name</th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NL</td>
<td style="text-align: left;">Amsterdam</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">1005</td>
</tr>
<tr class="even">
<td style="text-align: left;">NL</td>
<td style="text-align: left;">Amsterdam</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">1065</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NL</td>
<td style="text-align: left;">Amsterdam</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">1158</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: left;">Seattle</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">564</td>
</tr>
<tr class="odd">
<td style="text-align: left;">US</td>
<td style="text-align: left;">Seattle</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">608</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: left;">Seattle</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">738</td>
</tr>
<tr class="odd">
<td style="text-align: left;">US</td>
<td style="text-align: left;">New York City</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">8015</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: left;">New York City</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">8175</td>
</tr>
<tr class="odd">
<td style="text-align: left;">US</td>
<td style="text-align: left;">New York City</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">8772</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="pivot-on-one-column" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="pivot-on-one-column"><span class="header-section-number">17.1</span> PIVOT on one column</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>PIVOT cities</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> <span class="dt">year</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="kw">USING</span> <span class="fu">sum</span>(population)</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> country;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>2 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">country</th>
<th style="text-align: right;">2000</th>
<th style="text-align: right;">2010</th>
<th style="text-align: right;">2020</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">US</td>
<td style="text-align: right;">8579</td>
<td style="text-align: right;">8783</td>
<td style="text-align: right;">9510</td>
</tr>
<tr class="even">
<td style="text-align: left;">NL</td>
<td style="text-align: right;">1005</td>
<td style="text-align: right;">1065</td>
<td style="text-align: right;">1158</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="pivot-on-two-column" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="pivot-on-two-column"><span class="header-section-number">17.2</span> PIVOT on two column</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>PIVOT cities</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> country, name</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="kw">USING</span> <span class="fu">sum</span>(population);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>3 records</caption>
<colgroup>
<col style="width: 5%">
<col style="width: 14%">
<col style="width: 19%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 19%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: right;">NL_Amsterdam</th>
<th style="text-align: right;">NL_New York City</th>
<th style="text-align: right;">NL_Seattle</th>
<th style="text-align: right;">US_Amsterdam</th>
<th style="text-align: right;">US_New York City</th>
<th style="text-align: right;">US_Seattle</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2000</td>
<td style="text-align: right;">1005</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">8015</td>
<td style="text-align: right;">564</td>
</tr>
<tr class="even">
<td style="text-align: right;">2010</td>
<td style="text-align: right;">1065</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">8175</td>
<td style="text-align: right;">608</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2020</td>
<td style="text-align: right;">1158</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">8772</td>
<td style="text-align: right;">738</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="unpivot" class="level1" data-number="18">
<h1 data-number="18"><span class="header-section-number">18</span> unpivot</h1>
<p>wide to long</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>UNPIVOT</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>PIVOT cities</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> <span class="dt">year</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="kw">USING</span> <span class="fu">sum</span>(population)</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> country</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> <span class="kw">COLUMNS</span>(<span class="op">*</span> EXCLUDE (country))</span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a><span class="kw">INTO</span></span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>    NAME <span class="dt">year</span></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">VALUE</span> population;</span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>6 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">country</th>
<th style="text-align: left;">year</th>
<th style="text-align: right;">population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NL</td>
<td style="text-align: left;">2000</td>
<td style="text-align: right;">1005</td>
</tr>
<tr class="even">
<td style="text-align: left;">NL</td>
<td style="text-align: left;">2010</td>
<td style="text-align: right;">1065</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NL</td>
<td style="text-align: left;">2020</td>
<td style="text-align: right;">1158</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: left;">2000</td>
<td style="text-align: right;">8579</td>
</tr>
<tr class="odd">
<td style="text-align: left;">US</td>
<td style="text-align: left;">2010</td>
<td style="text-align: right;">8783</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: left;">2020</td>
<td style="text-align: right;">9510</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="explain" class="level1" data-number="19">
<h1 data-number="19"><span class="header-section-number">19</span> EXPLAIN</h1>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="kw">EXPLAIN</span> </span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t1.model_name,t1.mpg ,t1.cyl,t2.<span class="op">*</span> <span class="kw">from</span> mtcars_table t1 </span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="kw">inner</span> <span class="kw">join</span> (<span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> mtcars_table <span class="kw">limit</span> <span class="dv">5</span>) t2 <span class="kw">on</span> t1.model_name <span class="op">=</span> t2.model_name</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="kw">EXPLAIN</span> <span class="kw">ANALYZE</span> </span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t1.model_name,t1.mpg ,t1.cyl,t2.<span class="op">*</span> <span class="kw">from</span> mtcars_table t1 </span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="kw">inner</span> <span class="kw">join</span> (<span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> mtcars_table <span class="kw">limit</span> <span class="dv">5</span>) t2 <span class="kw">on</span> t1.model_name <span class="op">=</span> t2.model_name</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(con, <span class="at">shutdown=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="display-beautiful-table" class="level1" data-number="20">
<h1 data-number="20"><span class="header-section-number">20</span> Display beautiful table</h1>
<p>in R and Python using GT package</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">gt</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="turonhawss" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#turonhawss table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#turonhawss thead, #turonhawss tbody, #turonhawss tfoot, #turonhawss tr, #turonhawss td, #turonhawss th {
  border-style: none;
}

#turonhawss p {
  margin: 0;
  padding: 0;
}

#turonhawss .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#turonhawss .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#turonhawss .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#turonhawss .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#turonhawss .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#turonhawss .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#turonhawss .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#turonhawss .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#turonhawss .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#turonhawss .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#turonhawss .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#turonhawss .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#turonhawss .gt_spanner_row {
  border-bottom-style: hidden;
}

#turonhawss .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#turonhawss .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#turonhawss .gt_from_md > :first-child {
  margin-top: 0;
}

#turonhawss .gt_from_md > :last-child {
  margin-bottom: 0;
}

#turonhawss .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#turonhawss .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#turonhawss .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#turonhawss .gt_row_group_first td {
  border-top-width: 2px;
}

#turonhawss .gt_row_group_first th {
  border-top-width: 2px;
}

#turonhawss .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#turonhawss .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#turonhawss .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#turonhawss .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#turonhawss .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#turonhawss .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#turonhawss .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#turonhawss .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#turonhawss .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#turonhawss .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#turonhawss .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#turonhawss .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#turonhawss .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#turonhawss .gt_left {
  text-align: left;
}

#turonhawss .gt_center {
  text-align: center;
}

#turonhawss .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#turonhawss .gt_font_normal {
  font-weight: normal;
}

#turonhawss .gt_font_bold {
  font-weight: bold;
}

#turonhawss .gt_font_italic {
  font-style: italic;
}

#turonhawss .gt_super {
  font-size: 65%;
}

#turonhawss .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#turonhawss .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#turonhawss .gt_indent_1 {
  text-indent: 5px;
}

#turonhawss .gt_indent_2 {
  text-indent: 10px;
}

#turonhawss .gt_indent_3 {
  text-indent: 15px;
}

#turonhawss .gt_indent_4 {
  text-indent: 20px;
}

#turonhawss .gt_indent_5 {
  text-indent: 25px;
}

#turonhawss .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#turonhawss div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="model_name" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">model_name</th>
<th id="mpg" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">mpg</th>
<th id="cyl" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">cyl</th>
<th id="disp" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">disp</th>
<th id="hp" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">hp</th>
<th id="drat" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">drat</th>
<th id="wt" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">wt</th>
<th id="qsec" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">qsec</th>
<th id="vs" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">vs</th>
<th id="am" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">am</th>
<th id="gear" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">gear</th>
<th id="carb" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">carb</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="model_name">Mazda RX4</td>
<td class="gt_row gt_right" headers="mpg">21.0</td>
<td class="gt_row gt_right" headers="cyl">6</td>
<td class="gt_row gt_right" headers="disp">160.0</td>
<td class="gt_row gt_right" headers="hp">110</td>
<td class="gt_row gt_right" headers="drat">3.90</td>
<td class="gt_row gt_right" headers="wt">2.620</td>
<td class="gt_row gt_right" headers="qsec">16.46</td>
<td class="gt_row gt_right" headers="vs">0</td>
<td class="gt_row gt_right" headers="am">1</td>
<td class="gt_row gt_right" headers="gear">4</td>
<td class="gt_row gt_right" headers="carb">4</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="model_name">Mazda RX4 Wag</td>
<td class="gt_row gt_right" headers="mpg">21.0</td>
<td class="gt_row gt_right" headers="cyl">6</td>
<td class="gt_row gt_right" headers="disp">160.0</td>
<td class="gt_row gt_right" headers="hp">110</td>
<td class="gt_row gt_right" headers="drat">3.90</td>
<td class="gt_row gt_right" headers="wt">2.875</td>
<td class="gt_row gt_right" headers="qsec">17.02</td>
<td class="gt_row gt_right" headers="vs">0</td>
<td class="gt_row gt_right" headers="am">1</td>
<td class="gt_row gt_right" headers="gear">4</td>
<td class="gt_row gt_right" headers="carb">4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="model_name">Datsun 710</td>
<td class="gt_row gt_right" headers="mpg">22.8</td>
<td class="gt_row gt_right" headers="cyl">4</td>
<td class="gt_row gt_right" headers="disp">108.0</td>
<td class="gt_row gt_right" headers="hp">93</td>
<td class="gt_row gt_right" headers="drat">3.85</td>
<td class="gt_row gt_right" headers="wt">2.320</td>
<td class="gt_row gt_right" headers="qsec">18.61</td>
<td class="gt_row gt_right" headers="vs">1</td>
<td class="gt_row gt_right" headers="am">1</td>
<td class="gt_row gt_right" headers="gear">4</td>
<td class="gt_row gt_right" headers="carb">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="model_name">Hornet 4 Drive</td>
<td class="gt_row gt_right" headers="mpg">21.4</td>
<td class="gt_row gt_right" headers="cyl">6</td>
<td class="gt_row gt_right" headers="disp">258.0</td>
<td class="gt_row gt_right" headers="hp">110</td>
<td class="gt_row gt_right" headers="drat">3.08</td>
<td class="gt_row gt_right" headers="wt">3.215</td>
<td class="gt_row gt_right" headers="qsec">19.44</td>
<td class="gt_row gt_right" headers="vs">1</td>
<td class="gt_row gt_right" headers="am">0</td>
<td class="gt_row gt_right" headers="gear">3</td>
<td class="gt_row gt_right" headers="carb">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="model_name">Hornet Sportabout</td>
<td class="gt_row gt_right" headers="mpg">18.7</td>
<td class="gt_row gt_right" headers="cyl">8</td>
<td class="gt_row gt_right" headers="disp">360.0</td>
<td class="gt_row gt_right" headers="hp">175</td>
<td class="gt_row gt_right" headers="drat">3.15</td>
<td class="gt_row gt_right" headers="wt">3.440</td>
<td class="gt_row gt_right" headers="qsec">17.02</td>
<td class="gt_row gt_right" headers="vs">0</td>
<td class="gt_row gt_right" headers="am">0</td>
<td class="gt_row gt_right" headers="gear">3</td>
<td class="gt_row gt_right" headers="carb">2</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="model_name">Valiant</td>
<td class="gt_row gt_right" headers="mpg">18.1</td>
<td class="gt_row gt_right" headers="cyl">6</td>
<td class="gt_row gt_right" headers="disp">225.0</td>
<td class="gt_row gt_right" headers="hp">105</td>
<td class="gt_row gt_right" headers="drat">2.76</td>
<td class="gt_row gt_right" headers="wt">3.460</td>
<td class="gt_row gt_right" headers="qsec">20.22</td>
<td class="gt_row gt_right" headers="vs">1</td>
<td class="gt_row gt_right" headers="am">0</td>
<td class="gt_row gt_right" headers="gear">3</td>
<td class="gt_row gt_right" headers="carb">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="model_name">Duster 360</td>
<td class="gt_row gt_right" headers="mpg">14.3</td>
<td class="gt_row gt_right" headers="cyl">8</td>
<td class="gt_row gt_right" headers="disp">360.0</td>
<td class="gt_row gt_right" headers="hp">245</td>
<td class="gt_row gt_right" headers="drat">3.21</td>
<td class="gt_row gt_right" headers="wt">3.570</td>
<td class="gt_row gt_right" headers="qsec">15.84</td>
<td class="gt_row gt_right" headers="vs">0</td>
<td class="gt_row gt_right" headers="am">0</td>
<td class="gt_row gt_right" headers="gear">3</td>
<td class="gt_row gt_right" headers="carb">4</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="model_name">Merc 240D</td>
<td class="gt_row gt_right" headers="mpg">24.4</td>
<td class="gt_row gt_right" headers="cyl">4</td>
<td class="gt_row gt_right" headers="disp">146.7</td>
<td class="gt_row gt_right" headers="hp">62</td>
<td class="gt_row gt_right" headers="drat">3.69</td>
<td class="gt_row gt_right" headers="wt">3.190</td>
<td class="gt_row gt_right" headers="qsec">20.00</td>
<td class="gt_row gt_right" headers="vs">1</td>
<td class="gt_row gt_right" headers="am">0</td>
<td class="gt_row gt_right" headers="gear">4</td>
<td class="gt_row gt_right" headers="carb">2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="model_name">Merc 230</td>
<td class="gt_row gt_right" headers="mpg">22.8</td>
<td class="gt_row gt_right" headers="cyl">4</td>
<td class="gt_row gt_right" headers="disp">140.8</td>
<td class="gt_row gt_right" headers="hp">95</td>
<td class="gt_row gt_right" headers="drat">3.92</td>
<td class="gt_row gt_right" headers="wt">3.150</td>
<td class="gt_row gt_right" headers="qsec">22.90</td>
<td class="gt_row gt_right" headers="vs">1</td>
<td class="gt_row gt_right" headers="am">0</td>
<td class="gt_row gt_right" headers="gear">4</td>
<td class="gt_row gt_right" headers="carb">2</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="model_name">Merc 280</td>
<td class="gt_row gt_right" headers="mpg">19.2</td>
<td class="gt_row gt_right" headers="cyl">6</td>
<td class="gt_row gt_right" headers="disp">167.6</td>
<td class="gt_row gt_right" headers="hp">123</td>
<td class="gt_row gt_right" headers="drat">3.92</td>
<td class="gt_row gt_right" headers="wt">3.440</td>
<td class="gt_row gt_right" headers="qsec">18.30</td>
<td class="gt_row gt_right" headers="vs">1</td>
<td class="gt_row gt_right" headers="am">0</td>
<td class="gt_row gt_right" headers="gear">4</td>
<td class="gt_row gt_right" headers="carb">4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> great_tables <span class="im">import</span> GT</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>GT(mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>GT(_tbl_data=                          model_name    mpg  cyl  ...  gear  carb  new_mpg
Mazda RX4                  Mazda RX4   21.0  6.0  ...   4.0   4.0     22.0
Mazda RX4 Wag          Mazda RX4 Wag  999.0  6.0  ...   4.0   4.0     22.0
Datsun 710                Datsun 710   22.8  4.0  ...   4.0   1.0     23.8
Hornet 4 Drive        Hornet 4 Drive   21.4  6.0  ...   3.0   1.0     22.4
Hornet Sportabout  Hornet Sportabout   18.7  8.0  ...   3.0   2.0     19.7
Valiant                      Valiant   18.1  6.0  ...   3.0   1.0     19.1
Duster 360                Duster 360   14.3  8.0  ...   3.0   4.0     15.3
Merc 240D                  Merc 240D   24.4  4.0  ...   4.0   2.0     25.4
Merc 230                    Merc 230   22.8  4.0  ...   4.0   2.0     23.8
Merc 280                    Merc 280   19.2  6.0  ...   4.0   4.0     20.2

[10 rows x 13 columns], _body=&lt;great_tables._gt_data.Body object at 0x16672a890&gt;, _boxhead=Boxhead([ColInfo(var='model_name', type=&lt;ColInfoTypeEnum.default: 1&gt;, column_label='model_name', column_align='left', column_width=None), ColInfo(var='mpg', type=&lt;ColInfoTypeEnum.default: 1&gt;, column_label='mpg', column_align='right', column_width=None), ColInfo(var='cyl', type=&lt;ColInfoTypeEnum.default: 1&gt;, column_label='cyl', column_align='right', column_width=None), ColInfo(var='disp', type=&lt;ColInfoTypeEnum.default: 1&gt;, column_label='disp', column_align='right', column_width=None), ColInfo(var='hp', type=&lt;ColInfoTypeEnum.default: 1&gt;, column_label='hp', column_align='right', column_width=None), ColInfo(var='drat', type=&lt;ColInfoTypeEnum.default: 1&gt;, column_label='drat', column_align='right', column_width=None), ColInfo(var='wt', type=&lt;ColInfoTypeEnum.default: 1&gt;, column_label='wt', column_align='right', column_width=None), ColInfo(var='qsec', type=&lt;ColInfoTypeEnum.default: 1&gt;, column_label='qsec', column_align='right', column_width=None), ColInfo(var='vs', type=&lt;ColInfoTypeEnum.default: 1&gt;, column_label='vs', column_align='right', column_width=None), ColInfo(var='am', type=&lt;ColInfoTypeEnum.default: 1&gt;, column_label='am', column_align='right', column_width=None), ColInfo(var='gear', type=&lt;ColInfoTypeEnum.default: 1&gt;, column_label='gear', column_align='right', column_width=None), ColInfo(var='carb', type=&lt;ColInfoTypeEnum.default: 1&gt;, column_label='carb', column_align='right', column_width=None), ColInfo(var='new_mpg', type=&lt;ColInfoTypeEnum.default: 1&gt;, column_label='new_mpg', column_align='right', column_width=None)]), _stub=&lt;great_tables._gt_data.Stub object at 0x167b9d050&gt;, _spanners=Spanners([]), _heading=Heading(title=None, subtitle=None, preheader=None), _stubhead=None, _source_notes=[], _footnotes=[], _styles=[], _locale=&lt;great_tables._gt_data.Locale object at 0x167b90450&gt;, _formats=[], _substitutions=[], _options=Options(table_id=OptionsInfo(scss=False, category='table', type='value', value=None), table_caption=OptionsInfo(scss=False, category='table', type='value', value=None), table_width=OptionsInfo(scss=True, category='table', type='px', value='auto'), table_layout=OptionsInfo(scss=True, category='table', type='value', value='fixed'), table_margin_left=OptionsInfo(scss=True, category='table', type='px', value='auto'), table_margin_right=OptionsInfo(scss=True, category='table', type='px', value='auto'), table_background_color=OptionsInfo(scss=True, category='table', type='value', value='#FFFFFF'), table_additional_css=OptionsInfo(scss=False, category='table', type='values', value=[]), table_font_names=OptionsInfo(scss=False, category='table', type='values', value=['-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Helvetica Neue', 'Fira Sans', 'Droid Sans', 'Arial', 'sans-serif']), table_font_size=OptionsInfo(scss=True, category='table', type='px', value='16px'), table_font_weight=OptionsInfo(scss=True, category='table', type='value', value='normal'), table_font_style=OptionsInfo(scss=True, category='table', type='value', value='normal'), table_font_color=OptionsInfo(scss=True, category='table', type='value', value='#333333'), table_font_color_light=OptionsInfo(scss=True, category='table', type='value', value='#FFFFFF'), table_border_top_include=OptionsInfo(scss=False, category='table', type='boolean', value=True), table_border_top_style=OptionsInfo(scss=True, category='table', type='value', value='solid'), table_border_top_width=OptionsInfo(scss=True, category='table', type='px', value='2px'), table_border_top_color=OptionsInfo(scss=True, category='table', type='value', value='#A8A8A8'), table_border_right_style=OptionsInfo(scss=True, category='table', type='value', value='none'), table_border_right_width=OptionsInfo(scss=True, category='table', type='px', value='2px'), table_border_right_color=OptionsInfo(scss=True, category='table', type='value', value='#D3D3D3'), table_border_bottom_include=OptionsInfo(scss=False, category='table', type='boolean', value=True), table_border_bottom_style=OptionsInfo(scss=True, category='table', type='value', value='solid'), table_border_bottom_width=OptionsInfo(scss=True, category='table', type='px', value='2px'), table_border_bottom_color=OptionsInfo(scss=True, category='table', type='value', value='#A8A8A8'), table_border_left_style=OptionsInfo(scss=True, category='table', type='value', value='none'), table_border_left_width=OptionsInfo(scss=True, category='table', type='px', value='2px'), table_border_left_color=OptionsInfo(scss=True, category='table', type='value', value='#D3D3D3'), heading_background_color=OptionsInfo(scss=True, category='heading', type='value', value=None), heading_align=OptionsInfo(scss=True, category='heading', type='value', value='center'), heading_title_font_size=OptionsInfo(scss=True, category='heading', type='px', value='125%'), heading_title_font_weight=OptionsInfo(scss=True, category='heading', type='value', value='initial'), heading_subtitle_font_size=OptionsInfo(scss=True, category='heading', type='px', value='85%'), heading_subtitle_font_weight=OptionsInfo(scss=True, category='heading', type='value', value='initial'), heading_padding=OptionsInfo(scss=True, category='heading', type='px', value='4px'), heading_padding_horizontal=OptionsInfo(scss=True, category='heading', type='px', value='5px'), heading_border_bottom_style=OptionsInfo(scss=True, category='heading', type='value', value='solid'), heading_border_bottom_width=OptionsInfo(scss=True, category='heading', type='px', value='2px'), heading_border_bottom_color=OptionsInfo(scss=True, category='heading', type='value', value='#D3D3D3'), heading_border_lr_style=OptionsInfo(scss=True, category='heading', type='value', value='none'), heading_border_lr_width=OptionsInfo(scss=True, category='heading', type='px', value='1px'), heading_border_lr_color=OptionsInfo(scss=True, category='heading', type='value', value='#D3D3D3'), column_labels_background_color=OptionsInfo(scss=True, category='column_labels', type='value', value=None), column_labels_font_size=OptionsInfo(scss=True, category='column_labels', type='px', value='100%'), column_labels_font_weight=OptionsInfo(scss=True, category='column_labels', type='value', value='normal'), column_labels_text_transform=OptionsInfo(scss=True, category='column_labels', type='value', value='inherit'), column_labels_padding=OptionsInfo(scss=True, category='column_labels', type='px', value='5px'), column_labels_padding_horizontal=OptionsInfo(scss=True, category='column_labels', type='px', value='5px'), column_labels_vlines_style=OptionsInfo(scss=True, category='table_body', type='value', value='none'), column_labels_vlines_width=OptionsInfo(scss=True, category='table_body', type='px', value='1px'), column_labels_vlines_color=OptionsInfo(scss=True, category='table_body', type='value', value='#D3D3D3'), column_labels_border_top_style=OptionsInfo(scss=True, category='column_labels', type='value', value='solid'), column_labels_border_top_width=OptionsInfo(scss=True, category='column_labels', type='px', value='2px'), column_labels_border_top_color=OptionsInfo(scss=True, category='column_labels', type='value', value='#D3D3D3'), column_labels_border_bottom_style=OptionsInfo(scss=True, category='column_labels', type='value', value='solid'), column_labels_border_bottom_width=OptionsInfo(scss=True, category='column_labels', type='px', value='2px'), column_labels_border_bottom_color=OptionsInfo(scss=True, category='column_labels', type='value', value='#D3D3D3'), column_labels_border_lr_style=OptionsInfo(scss=True, category='column_labels', type='value', value='none'), column_labels_border_lr_width=OptionsInfo(scss=True, category='column_labels', type='px', value='1px'), column_labels_border_lr_color=OptionsInfo(scss=True, category='column_labels', type='value', value='#D3D3D3'), column_labels_hidden=OptionsInfo(scss=False, category='column_labels', type='boolean', value=False), row_group_background_color=OptionsInfo(scss=True, category='row_group', type='value', value=None), row_group_font_size=OptionsInfo(scss=True, category='row_group', type='px', value='100%'), row_group_font_weight=OptionsInfo(scss=True, category='row_group', type='value', value='initial'), row_group_text_transform=OptionsInfo(scss=True, category='row_group', type='value', value='inherit'), row_group_padding=OptionsInfo(scss=True, category='row_group', type='px', value='8px'), row_group_padding_horizontal=OptionsInfo(scss=True, category='row_group', type='px', value='5px'), row_group_border_top_style=OptionsInfo(scss=True, category='row_group', type='value', value='solid'), row_group_border_top_width=OptionsInfo(scss=True, category='row_group', type='px', value='2px'), row_group_border_top_color=OptionsInfo(scss=True, category='row_group', type='value', value='#D3D3D3'), row_group_border_right_style=OptionsInfo(scss=True, category='row_group', type='value', value='none'), row_group_border_right_width=OptionsInfo(scss=True, category='row_group', type='px', value='1px'), row_group_border_right_color=OptionsInfo(scss=True, category='row_group', type='value', value='#D3D3D3'), row_group_border_bottom_style=OptionsInfo(scss=True, category='row_group', type='value', value='solid'), row_group_border_bottom_width=OptionsInfo(scss=True, category='row_group', type='px', value='2px'), row_group_border_bottom_color=OptionsInfo(scss=True, category='row_group', type='value', value='#D3D3D3'), row_group_border_left_style=OptionsInfo(scss=True, category='row_group', type='value', value='none'), row_group_border_left_width=OptionsInfo(scss=True, category='row_group', type='px', value='1px'), row_group_border_left_color=OptionsInfo(scss=True, category='row_group', type='value', value='#D3D3D3'), row_group_as_column=OptionsInfo(scss=False, category='row_group', type='boolean', value=False), table_body_hlines_style=OptionsInfo(scss=True, category='table_body', type='value', value='solid'), table_body_hlines_width=OptionsInfo(scss=True, category='table_body', type='px', value='1px'), table_body_hlines_color=OptionsInfo(scss=True, category='table_body', type='value', value='#D3D3D3'), table_body_vlines_style=OptionsInfo(scss=True, category='table_body', type='value', value='none'), table_body_vlines_width=OptionsInfo(scss=True, category='table_body', type='px', value='1px'), table_body_vlines_color=OptionsInfo(scss=True, category='table_body', type='value', value='#D3D3D3'), table_body_border_top_style=OptionsInfo(scss=True, category='table_body', type='value', value='solid'), table_body_border_top_width=OptionsInfo(scss=True, category='table_body', type='px', value='2px'), table_body_border_top_color=OptionsInfo(scss=True, category='table_body', type='value', value='#D3D3D3'), table_body_border_bottom_style=OptionsInfo(scss=True, category='table_body', type='value', value='solid'), table_body_border_bottom_width=OptionsInfo(scss=True, category='table_body', type='px', value='2px'), table_body_border_bottom_color=OptionsInfo(scss=True, category='table_body', type='value', value='#D3D3D3'), data_row_padding=OptionsInfo(scss=True, category='data_row', type='px', value='8px'), data_row_padding_horizontal=OptionsInfo(scss=True, category='data_row', type='px', value='5px'), stub_background_color=OptionsInfo(scss=True, category='stub', type='value', value=None), stub_font_size=OptionsInfo(scss=True, category='stub', type='px', value='100%'), stub_font_weight=OptionsInfo(scss=True, category='stub', type='value', value='initial'), stub_text_transform=OptionsInfo(scss=True, category='stub', type='value', value='inherit'), stub_border_style=OptionsInfo(scss=True, category='stub', type='value', value='solid'), stub_border_width=OptionsInfo(scss=True, category='stub', type='px', value='2px'), stub_border_color=OptionsInfo(scss=True, category='stub', type='value', value='#D3D3D3'), stub_row_group_background_color=OptionsInfo(scss=True, category='stub', type='value', value=None), stub_row_group_font_size=OptionsInfo(scss=True, category='stub', type='px', value='100%'), stub_row_group_font_weight=OptionsInfo(scss=True, category='stub', type='value', value='initial'), stub_row_group_text_transform=OptionsInfo(scss=True, category='stub', type='value', value='inherit'), stub_row_group_border_style=OptionsInfo(scss=True, category='stub', type='value', value='solid'), stub_row_group_border_width=OptionsInfo(scss=True, category='stub', type='px', value='2px'), stub_row_group_border_color=OptionsInfo(scss=True, category='stub', type='value', value='#D3D3D3'), source_notes_padding=OptionsInfo(scss=True, category='source_notes', type='px', value='4px'), source_notes_padding_horizontal=OptionsInfo(scss=True, category='source_notes', type='px', value='5px'), source_notes_background_color=OptionsInfo(scss=True, category='source_notes', type='value', value=None), source_notes_font_size=OptionsInfo(scss=True, category='source_notes', type='px', value='90%'), source_notes_border_bottom_style=OptionsInfo(scss=True, category='source_notes', type='value', value='none'), source_notes_border_bottom_width=OptionsInfo(scss=True, category='source_notes', type='px', value='2px'), source_notes_border_bottom_color=OptionsInfo(scss=True, category='source_notes', type='value', value='#D3D3D3'), source_notes_border_lr_style=OptionsInfo(scss=True, category='source_notes', type='value', value='none'), source_notes_border_lr_width=OptionsInfo(scss=True, category='source_notes', type='px', value='2px'), source_notes_border_lr_color=OptionsInfo(scss=True, category='source_notes', type='value', value='#D3D3D3'), source_notes_multiline=OptionsInfo(scss=False, category='source_notes', type='boolean', value=True), source_notes_sep=OptionsInfo(scss=False, category='source_notes', type='value', value=' '), row_striping_background_color=OptionsInfo(scss=True, category='row', type='value', value='rgba(128,128,128,0.05)'), row_striping_include_stub=OptionsInfo(scss=False, category='row', type='boolean', value=False), row_striping_include_table_body=OptionsInfo(scss=False, category='row', type='boolean', value=False), container_width=OptionsInfo(scss=False, category='container', type='px', value='auto'), container_height=OptionsInfo(scss=False, category='container', type='px', value='auto'), container_padding_x=OptionsInfo(scss=False, category='container', type='px', value='0px'), container_padding_y=OptionsInfo(scss=False, category='container', type='px', value='10px'), container_overflow_x=OptionsInfo(scss=False, category='container', type='overflow', value='auto'), container_overflow_y=OptionsInfo(scss=False, category='container', type='overflow', value='auto'), quarto_disable_processing=OptionsInfo(scss=False, category='quarto', type='logical', value=False), quarto_use_bootstrap=OptionsInfo(scss=False, category='quarto', type='logical', value=False)), _has_built=False)</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="reference" class="level1" data-number="21">
<h1 data-number="21"><span class="header-section-number">21</span> reference:</h1>
<p>https://duckdb.org/docs/stable/clients/r.html</p>
<p>https://duckdb.org/docs/stable/sql/statements</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark_dimmed">
<script>
function loadGiscusWhenReady() {
  // Function to get the theme based on body class
  const getTheme = () => {
    const baseTheme = document.getElementById('giscus-base-theme').value;
    const altTheme = document.getElementById('giscus-alt-theme').value;
    return document.body.classList.contains('quarto-dark') ? altTheme : baseTheme;
  };
  // Create the Giscus script and add it to the desired location
  const loadGiscus = () => {
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.async = true;
    script.dataset.repo = "JCfly3000/into_sql";
    script.dataset.repoId = "R_kgDOOC5J8A";
    script.dataset.category = "General";
    script.dataset.categoryId = "DIC_kwDOOC5J8M4Cnyr2";
    script.dataset.mapping = "title";
    script.dataset.reactionsEnabled = "1";
    script.dataset.emitMetadata = "0";
    script.dataset.inputPosition = "bottom";
    script.dataset.theme = getTheme();
    script.dataset.lang = "en";
    script.crossOrigin = "anonymous";
    // Append the script to the desired div instead of at the end of the body
    document.getElementById("quarto-content").appendChild(script);
  };
  // MutationObserver to detect when the 'quarto-light' or 'quarto-dark' class is added to the body
  const observer = new MutationObserver((mutations) => {
    for (const mutation of mutations) {
      if (mutation.type === "attributes" && mutation.attributeName === "class") {
        if (document.body.classList.contains('quarto-light') || document.body.classList.contains('quarto-dark')) {
          loadGiscus();
          observer.disconnect(); // Stop observing once Giscus is loaded
          break;
        }
      }
    }
  });
  // Start observing the body for class attribute changes
  observer.observe(document.body, {
    attributes: true,
    attributeFilter: ["class"],
  });
}
loadGiscusWhenReady();
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb148" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Code"</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Tony Duan"</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a><span class="co">  error: false</span></span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a><span class="co">  </span></span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: right</span></span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb148-16"><a href="#cb148-16" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb148-17"><a href="#cb148-17" aria-hidden="true" tabindex="-1"></a><span class="co">    code-block-bg: true</span></span>
<span id="cb148-18"><a href="#cb148-18" aria-hidden="true" tabindex="-1"></a><span class="co">    code-block-border-left: "#31BAE9"</span></span>
<span id="cb148-19"><a href="#cb148-19" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb148-20"><a href="#cb148-20" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb148-21"><a href="#cb148-21" aria-hidden="true" tabindex="-1"></a><span class="an">engine:</span><span class="co"> knitr</span></span>
<span id="cb148-22"><a href="#cb148-22" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb148-23"><a href="#cb148-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-24"><a href="#cb148-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-27"><a href="#cb148-27" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-28"><a href="#cb148-28" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="at">RETICULATE_PYTHON =</span> <span class="st">"/Library/Frameworks/Python.framework/Versions/3.11/bin/python3.11"</span>)</span>
<span id="cb148-29"><a href="#cb148-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb148-30"><a href="#cb148-30" aria-hidden="true" tabindex="-1"></a><span class="fu">use_python</span>(<span class="st">"/Library/Frameworks/Python.framework/Versions/3.11/bin/python3.11"</span>)</span>
<span id="cb148-31"><a href="#cb148-31" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-32"><a href="#cb148-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-33"><a href="#cb148-33" aria-hidden="true" tabindex="-1"></a>Using python 3.11 for siuba pacakege</span>
<span id="cb148-34"><a href="#cb148-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-37"><a href="#cb148-37" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-38"><a href="#cb148-38" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> platform <span class="im">import</span> python_version</span>
<span id="cb148-39"><a href="#cb148-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(python_version())</span>
<span id="cb148-40"><a href="#cb148-40" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-41"><a href="#cb148-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-44"><a href="#cb148-44" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-45"><a href="#cb148-45" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb148-46"><a href="#cb148-46" aria-hidden="true" tabindex="-1"></a>os.system(<span class="st">'pip show pandas'</span>)</span>
<span id="cb148-47"><a href="#cb148-47" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-48"><a href="#cb148-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-49"><a href="#cb148-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-52"><a href="#cb148-52" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-53"><a href="#cb148-53" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb148-54"><a href="#cb148-54" aria-hidden="true" tabindex="-1"></a>os.system(<span class="st">'pip show siuba'</span>)</span>
<span id="cb148-55"><a href="#cb148-55" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-56"><a href="#cb148-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-57"><a href="#cb148-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-58"><a href="#cb148-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-59"><a href="#cb148-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-62"><a href="#cb148-62" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-63"><a href="#cb148-63" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb148-64"><a href="#cb148-64" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb148-65"><a href="#cb148-65" aria-hidden="true" tabindex="-1"></a><span class="co"># set up duckdb database</span></span>
<span id="cb148-66"><a href="#cb148-66" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DBI)</span>
<span id="cb148-67"><a href="#cb148-67" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb148-68"><a href="#cb148-68" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSQLite)</span>
<span id="cb148-69"><a href="#cb148-69" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(connections)</span>
<span id="cb148-70"><a href="#cb148-70" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(duckdb)</span>
<span id="cb148-71"><a href="#cb148-71" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-72"><a href="#cb148-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-75"><a href="#cb148-75" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-76"><a href="#cb148-76" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb148-77"><a href="#cb148-77" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb148-78"><a href="#cb148-78" aria-hidden="true" tabindex="-1"></a><span class="co"># set up R data</span></span>
<span id="cb148-79"><a href="#cb148-79" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(mtcars) </span>
<span id="cb148-80"><a href="#cb148-80" aria-hidden="true" tabindex="-1"></a>mtcars<span class="ot">=</span><span class="fu">cbind</span>(<span class="at">model_name =</span> <span class="fu">rownames</span>(mtcars), mtcars) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb148-81"><a href="#cb148-81" aria-hidden="true" tabindex="-1"></a>iris<span class="ot">=</span>iris<span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb148-82"><a href="#cb148-82" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-83"><a href="#cb148-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-86"><a href="#cb148-86" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-87"><a href="#cb148-87" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb148-88"><a href="#cb148-88" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb148-89"><a href="#cb148-89" aria-hidden="true" tabindex="-1"></a><span class="co"># set up Python data</span></span>
<span id="cb148-90"><a href="#cb148-90" aria-hidden="true" tabindex="-1"></a>mtcars<span class="op">=</span>r.mtcars</span>
<span id="cb148-91"><a href="#cb148-91" aria-hidden="true" tabindex="-1"></a>iris<span class="op">=</span>r.iris</span>
<span id="cb148-92"><a href="#cb148-92" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-93"><a href="#cb148-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-96"><a href="#cb148-96" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-97"><a href="#cb148-97" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb148-98"><a href="#cb148-98" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb148-99"><a href="#cb148-99" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">"my-db.duckdb"</span>)) {<span class="fu">file.remove</span>(<span class="st">"my-db.duckdb"</span>)</span>
<span id="cb148-100"><a href="#cb148-100" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb148-101"><a href="#cb148-101" aria-hidden="true" tabindex="-1"></a><span class="co">#con &lt;- dbConnect(duckdb(), dbdir = "my-db.duckdb", read_only = TRUE)</span></span>
<span id="cb148-102"><a href="#cb148-102" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(<span class="fu">duckdb</span>(), <span class="at">dbdir =</span> <span class="st">"my-db.duckdb"</span>, <span class="at">read_only =</span> <span class="cn">FALSE</span>)</span>
<span id="cb148-103"><a href="#cb148-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-104"><a href="#cb148-104" aria-hidden="true" tabindex="-1"></a><span class="fu">dbWriteTable</span>(con, <span class="st">"iris_table"</span>, iris,<span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span>
<span id="cb148-105"><a href="#cb148-105" aria-hidden="true" tabindex="-1"></a><span class="fu">dbWriteTable</span>(con, <span class="st">"mtcars_table"</span>, mtcars,<span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span>
<span id="cb148-106"><a href="#cb148-106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-107"><a href="#cb148-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-108"><a href="#cb148-108" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>There are table <span class="in">`iris_table`</span> and <span class="in">`mtcars_table`</span> in duckdb <span class="in">`my-db.duckdb`</span></span>
<span id="cb148-109"><a href="#cb148-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-110"><a href="#cb148-110" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>There are table <span class="in">`iris`</span> and <span class="in">`mtcars`</span> R environment</span>
<span id="cb148-111"><a href="#cb148-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-112"><a href="#cb148-112" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>There are table <span class="in">`iris`</span> and <span class="in">`mtcars`</span> Python environment</span>
<span id="cb148-113"><a href="#cb148-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-114"><a href="#cb148-114" aria-hidden="true" tabindex="-1"></a><span class="fu"># show all table</span></span>
<span id="cb148-115"><a href="#cb148-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-116"><a href="#cb148-116" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb148-117"><a href="#cb148-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-118"><a href="#cb148-118" aria-hidden="true" tabindex="-1"></a><span class="fu">## sql</span></span>
<span id="cb148-119"><a href="#cb148-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-122"><a href="#cb148-122" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-123"><a href="#cb148-123" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-124"><a href="#cb148-124" aria-hidden="true" tabindex="-1"></a><span class="kw">SHOW</span> <span class="kw">ALL</span> <span class="kw">TABLES</span>;</span>
<span id="cb148-125"><a href="#cb148-125" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-126"><a href="#cb148-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-127"><a href="#cb148-127" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb148-128"><a href="#cb148-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-131"><a href="#cb148-131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-132"><a href="#cb148-132" aria-hidden="true" tabindex="-1"></a>dflist <span class="ot">&lt;-</span> <span class="fu">Filter</span>(is.data.frame, <span class="fu">as.list</span>(.GlobalEnv))</span>
<span id="cb148-133"><a href="#cb148-133" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dflist)</span>
<span id="cb148-134"><a href="#cb148-134" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-135"><a href="#cb148-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-136"><a href="#cb148-136" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb148-137"><a href="#cb148-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-140"><a href="#cb148-140" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-141"><a href="#cb148-141" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb148-142"><a href="#cb148-142" aria-hidden="true" tabindex="-1"></a>alldfs <span class="op">=</span> [var <span class="cf">for</span> var <span class="kw">in</span> <span class="bu">dir</span>() <span class="cf">if</span> <span class="bu">isinstance</span>(<span class="bu">eval</span>(var), pd.core.frame.DataFrame)]</span>
<span id="cb148-143"><a href="#cb148-143" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alldfs)</span>
<span id="cb148-144"><a href="#cb148-144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-145"><a href="#cb148-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-146"><a href="#cb148-146" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb148-147"><a href="#cb148-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-148"><a href="#cb148-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-149"><a href="#cb148-149" aria-hidden="true" tabindex="-1"></a><span class="fu"># Describe a table</span></span>
<span id="cb148-150"><a href="#cb148-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-151"><a href="#cb148-151" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb148-152"><a href="#cb148-152" aria-hidden="true" tabindex="-1"></a><span class="fu">## sql</span></span>
<span id="cb148-153"><a href="#cb148-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-156"><a href="#cb148-156" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-157"><a href="#cb148-157" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-158"><a href="#cb148-158" aria-hidden="true" tabindex="-1"></a><span class="kw">DESCRIBE</span> mtcars_table;</span>
<span id="cb148-159"><a href="#cb148-159" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-160"><a href="#cb148-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-161"><a href="#cb148-161" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb148-162"><a href="#cb148-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-165"><a href="#cb148-165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-166"><a href="#cb148-166" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(mtcars)</span>
<span id="cb148-167"><a href="#cb148-167" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-168"><a href="#cb148-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-169"><a href="#cb148-169" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb148-170"><a href="#cb148-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-173"><a href="#cb148-173" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-174"><a href="#cb148-174" aria-hidden="true" tabindex="-1"></a>mtcars.describe(include<span class="op">=</span><span class="st">'all'</span>)</span>
<span id="cb148-175"><a href="#cb148-175" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-176"><a href="#cb148-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-177"><a href="#cb148-177" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb148-178"><a href="#cb148-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-179"><a href="#cb148-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-180"><a href="#cb148-180" aria-hidden="true" tabindex="-1"></a><span class="fu"># show column name</span></span>
<span id="cb148-181"><a href="#cb148-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-182"><a href="#cb148-182" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb148-183"><a href="#cb148-183" aria-hidden="true" tabindex="-1"></a><span class="fu">## sql</span></span>
<span id="cb148-184"><a href="#cb148-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-185"><a href="#cb148-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-186"><a href="#cb148-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-189"><a href="#cb148-189" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-190"><a href="#cb148-190" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-191"><a href="#cb148-191" aria-hidden="true" tabindex="-1"></a>PRAGMA table_info(mtcars_table);</span>
<span id="cb148-192"><a href="#cb148-192" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-193"><a href="#cb148-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-194"><a href="#cb148-194" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb148-195"><a href="#cb148-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-198"><a href="#cb148-198" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-199"><a href="#cb148-199" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mtcars)</span>
<span id="cb148-200"><a href="#cb148-200" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-201"><a href="#cb148-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-202"><a href="#cb148-202" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb148-203"><a href="#cb148-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-206"><a href="#cb148-206" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-207"><a href="#cb148-207" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb148-208"><a href="#cb148-208" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(mtcars.columns.values)</span>
<span id="cb148-209"><a href="#cb148-209" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-210"><a href="#cb148-210" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb148-211"><a href="#cb148-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-212"><a href="#cb148-212" aria-hidden="true" tabindex="-1"></a><span class="fu"># select</span></span>
<span id="cb148-213"><a href="#cb148-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-214"><a href="#cb148-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-215"><a href="#cb148-215" aria-hidden="true" tabindex="-1"></a><span class="fu">## select top 6 and rename</span></span>
<span id="cb148-216"><a href="#cb148-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-217"><a href="#cb148-217" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb148-218"><a href="#cb148-218" aria-hidden="true" tabindex="-1"></a><span class="fu">## sql</span></span>
<span id="cb148-219"><a href="#cb148-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-222"><a href="#cb148-222" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-223"><a href="#cb148-223" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-224"><a href="#cb148-224" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name <span class="kw">as</span> model,mpg,cyl <span class="kw">from</span> mtcars_table <span class="kw">limit</span> <span class="dv">6</span> ;</span>
<span id="cb148-225"><a href="#cb148-225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-226"><a href="#cb148-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-227"><a href="#cb148-227" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb148-228"><a href="#cb148-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-231"><a href="#cb148-231" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-232"><a href="#cb148-232" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars,<span class="dv">6</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="at">model=</span>model_name,mpg,cyl)</span>
<span id="cb148-233"><a href="#cb148-233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-234"><a href="#cb148-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-235"><a href="#cb148-235" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb148-236"><a href="#cb148-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-239"><a href="#cb148-239" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-240"><a href="#cb148-240" aria-hidden="true" tabindex="-1"></a>mtcars.rename(columns<span class="op">=</span>{<span class="st">'model_name'</span>: <span class="st">'model'</span>})</span>
<span id="cb148-241"><a href="#cb148-241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-242"><a href="#cb148-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-243"><a href="#cb148-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-244"><a href="#cb148-244" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python siuba</span></span>
<span id="cb148-245"><a href="#cb148-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-248"><a href="#cb148-248" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-249"><a href="#cb148-249" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> siuba <span class="im">import</span> <span class="op">*</span></span>
<span id="cb148-250"><a href="#cb148-250" aria-hidden="true" tabindex="-1"></a>mtcars <span class="op">&gt;&gt;</span> rename(model<span class="op">=</span>_.model_name) <span class="op">&gt;&gt;</span> select(_.model, _.mpg, _.cyl) <span class="op">&gt;&gt;</span> head(<span class="dv">6</span>)</span>
<span id="cb148-251"><a href="#cb148-251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-252"><a href="#cb148-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-253"><a href="#cb148-253" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb148-254"><a href="#cb148-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-255"><a href="#cb148-255" aria-hidden="true" tabindex="-1"></a><span class="fu">## select distinct</span></span>
<span id="cb148-256"><a href="#cb148-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-257"><a href="#cb148-257" aria-hidden="true" tabindex="-1"></a>all distinct record of mpg and cyl</span>
<span id="cb148-258"><a href="#cb148-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-259"><a href="#cb148-259" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb148-260"><a href="#cb148-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-261"><a href="#cb148-261" aria-hidden="true" tabindex="-1"></a><span class="fu">## sql</span></span>
<span id="cb148-262"><a href="#cb148-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-265"><a href="#cb148-265" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-266"><a href="#cb148-266" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-267"><a href="#cb148-267" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">distinct</span> mpg,cyl <span class="kw">from</span> mtcars_table;</span>
<span id="cb148-268"><a href="#cb148-268" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-269"><a href="#cb148-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-270"><a href="#cb148-270" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb148-271"><a href="#cb148-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-274"><a href="#cb148-274" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-275"><a href="#cb148-275" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">distinct</span>(mpg,cyl)</span>
<span id="cb148-276"><a href="#cb148-276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-277"><a href="#cb148-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-278"><a href="#cb148-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-279"><a href="#cb148-279" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb148-280"><a href="#cb148-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-283"><a href="#cb148-283" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-284"><a href="#cb148-284" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>mtcars[[<span class="st">"mpg"</span>, <span class="st">"cyl"</span>]]</span>
<span id="cb148-285"><a href="#cb148-285" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.drop_duplicates())</span>
<span id="cb148-286"><a href="#cb148-286" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-287"><a href="#cb148-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-288"><a href="#cb148-288" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python siuba</span></span>
<span id="cb148-289"><a href="#cb148-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-292"><a href="#cb148-292" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-293"><a href="#cb148-293" aria-hidden="true" tabindex="-1"></a>mtcars <span class="op">&gt;&gt;</span> distinct(_.mpg, _.cyl)</span>
<span id="cb148-294"><a href="#cb148-294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-295"><a href="#cb148-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-296"><a href="#cb148-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-297"><a href="#cb148-297" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb148-298"><a href="#cb148-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-299"><a href="#cb148-299" aria-hidden="true" tabindex="-1"></a><span class="fu"># check row number and column number</span></span>
<span id="cb148-300"><a href="#cb148-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-301"><a href="#cb148-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-302"><a href="#cb148-302" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb148-303"><a href="#cb148-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-304"><a href="#cb148-304" aria-hidden="true" tabindex="-1"></a><span class="fu">## sql</span></span>
<span id="cb148-305"><a href="#cb148-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-306"><a href="#cb148-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-309"><a href="#cb148-309" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-310"><a href="#cb148-310" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-311"><a href="#cb148-311" aria-hidden="true" tabindex="-1"></a><span class="co">/*Gives number of rows*/</span></span>
<span id="cb148-312"><a href="#cb148-312" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">as</span> row_number <span class="kw">from</span> mtcars_table;</span>
<span id="cb148-313"><a href="#cb148-313" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-314"><a href="#cb148-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-317"><a href="#cb148-317" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-318"><a href="#cb148-318" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-319"><a href="#cb148-319" aria-hidden="true" tabindex="-1"></a><span class="co">/*Gives number of columns*/</span></span>
<span id="cb148-320"><a href="#cb148-320" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">as</span> column_number <span class="kw">from</span> (<span class="kw">DESCRIBE</span> mtcars_table);</span>
<span id="cb148-321"><a href="#cb148-321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-322"><a href="#cb148-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-323"><a href="#cb148-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-324"><a href="#cb148-324" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb148-327"><a href="#cb148-327" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-328"><a href="#cb148-328" aria-hidden="true" tabindex="-1"></a><span class="co"># Gives number of rows</span></span>
<span id="cb148-329"><a href="#cb148-329" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(mtcars) </span>
<span id="cb148-330"><a href="#cb148-330" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-331"><a href="#cb148-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-332"><a href="#cb148-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-335"><a href="#cb148-335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-336"><a href="#cb148-336" aria-hidden="true" tabindex="-1"></a> <span class="co"># Gives number of columns</span></span>
<span id="cb148-337"><a href="#cb148-337" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(mtcars) </span>
<span id="cb148-338"><a href="#cb148-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-339"><a href="#cb148-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-340"><a href="#cb148-340" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb148-341"><a href="#cb148-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-344"><a href="#cb148-344" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-345"><a href="#cb148-345" aria-hidden="true" tabindex="-1"></a><span class="co"># Gives number of rows</span></span>
<span id="cb148-346"><a href="#cb148-346" aria-hidden="true" tabindex="-1"></a>mtcars.shape[<span class="dv">0</span>]</span>
<span id="cb148-347"><a href="#cb148-347" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-348"><a href="#cb148-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-351"><a href="#cb148-351" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-352"><a href="#cb148-352" aria-hidden="true" tabindex="-1"></a><span class="co"># Gives number of columns</span></span>
<span id="cb148-353"><a href="#cb148-353" aria-hidden="true" tabindex="-1"></a>mtcars.shape[<span class="dv">1</span>] </span>
<span id="cb148-354"><a href="#cb148-354" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-355"><a href="#cb148-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-356"><a href="#cb148-356" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb148-357"><a href="#cb148-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-358"><a href="#cb148-358" aria-hidden="true" tabindex="-1"></a><span class="fu"># create column</span></span>
<span id="cb148-359"><a href="#cb148-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-360"><a href="#cb148-360" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb148-361"><a href="#cb148-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-362"><a href="#cb148-362" aria-hidden="true" tabindex="-1"></a><span class="fu">## sql</span></span>
<span id="cb148-365"><a href="#cb148-365" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-366"><a href="#cb148-366" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-367"><a href="#cb148-367" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span>, mpg<span class="op">+</span><span class="dv">1</span> <span class="kw">as</span> new_mpg <span class="kw">from</span> mtcars_table;</span>
<span id="cb148-368"><a href="#cb148-368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-369"><a href="#cb148-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-370"><a href="#cb148-370" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb148-373"><a href="#cb148-373" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-374"><a href="#cb148-374" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">new_mpg=</span>mpg<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb148-375"><a href="#cb148-375" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-376"><a href="#cb148-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-377"><a href="#cb148-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-378"><a href="#cb148-378" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb148-379"><a href="#cb148-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-382"><a href="#cb148-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-383"><a href="#cb148-383" aria-hidden="true" tabindex="-1"></a>mtcars[<span class="st">"new_mpg"</span>]<span class="op">=</span>mtcars[<span class="st">"mpg"</span>]<span class="op">+</span><span class="dv">1</span></span>
<span id="cb148-384"><a href="#cb148-384" aria-hidden="true" tabindex="-1"></a>mtcars</span>
<span id="cb148-385"><a href="#cb148-385" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-386"><a href="#cb148-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-387"><a href="#cb148-387" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python siuba</span></span>
<span id="cb148-388"><a href="#cb148-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-391"><a href="#cb148-391" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-392"><a href="#cb148-392" aria-hidden="true" tabindex="-1"></a>mtcars <span class="op">&gt;&gt;</span> mutate(new_mpg<span class="op">=</span>_.mpg<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb148-393"><a href="#cb148-393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-394"><a href="#cb148-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-395"><a href="#cb148-395" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb148-396"><a href="#cb148-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-397"><a href="#cb148-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-398"><a href="#cb148-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-399"><a href="#cb148-399" aria-hidden="true" tabindex="-1"></a><span class="fu"># Filter</span></span>
<span id="cb148-400"><a href="#cb148-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-401"><a href="#cb148-401" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb148-402"><a href="#cb148-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-403"><a href="#cb148-403" aria-hidden="true" tabindex="-1"></a><span class="fu">## sql</span></span>
<span id="cb148-404"><a href="#cb148-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-407"><a href="#cb148-407" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-408"><a href="#cb148-408" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-409"><a href="#cb148-409" aria-hidden="true" tabindex="-1"></a><span class="co">/* and */</span></span>
<span id="cb148-410"><a href="#cb148-410" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">from</span> mtcars_table <span class="kw">where</span> mpg<span class="op">=</span><span class="dv">21</span> <span class="kw">and</span> cyl<span class="op">=</span><span class="dv">6</span>;</span>
<span id="cb148-411"><a href="#cb148-411" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-412"><a href="#cb148-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-415"><a href="#cb148-415" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-416"><a href="#cb148-416" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-417"><a href="#cb148-417" aria-hidden="true" tabindex="-1"></a><span class="co">/* or */</span></span>
<span id="cb148-418"><a href="#cb148-418" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">from</span> mtcars_table <span class="kw">where</span> mpg<span class="op">=</span><span class="dv">21</span> <span class="kw">or</span> cyl<span class="op">=</span><span class="dv">6</span>;</span>
<span id="cb148-419"><a href="#cb148-419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-420"><a href="#cb148-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-421"><a href="#cb148-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-422"><a href="#cb148-422" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb148-423"><a href="#cb148-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-426"><a href="#cb148-426" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-427"><a href="#cb148-427" aria-hidden="true" tabindex="-1"></a><span class="co"># and</span></span>
<span id="cb148-428"><a href="#cb148-428" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(mpg<span class="sc">==</span><span class="dv">21</span><span class="sc">&amp;</span>cyl<span class="sc">==</span><span class="dv">6</span>)</span>
<span id="cb148-429"><a href="#cb148-429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-430"><a href="#cb148-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-433"><a href="#cb148-433" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-434"><a href="#cb148-434" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb148-435"><a href="#cb148-435" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(mpg<span class="sc">==</span><span class="dv">21</span><span class="sc">|</span>cyl<span class="sc">==</span><span class="dv">6</span>)</span>
<span id="cb148-436"><a href="#cb148-436" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-437"><a href="#cb148-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-438"><a href="#cb148-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-439"><a href="#cb148-439" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb148-440"><a href="#cb148-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-441"><a href="#cb148-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-444"><a href="#cb148-444" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-445"><a href="#cb148-445" aria-hidden="true" tabindex="-1"></a><span class="co"># and</span></span>
<span id="cb148-446"><a href="#cb148-446" aria-hidden="true" tabindex="-1"></a>mtcars.query(<span class="st">'mpg==21 and cyl==6'</span>)</span>
<span id="cb148-447"><a href="#cb148-447" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-448"><a href="#cb148-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-449"><a href="#cb148-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-452"><a href="#cb148-452" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-453"><a href="#cb148-453" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb148-454"><a href="#cb148-454" aria-hidden="true" tabindex="-1"></a>mtcars.query(<span class="st">'mpg==21 or cyl==6'</span>)</span>
<span id="cb148-455"><a href="#cb148-455" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-456"><a href="#cb148-456" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python siuba</span></span>
<span id="cb148-457"><a href="#cb148-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-460"><a href="#cb148-460" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-461"><a href="#cb148-461" aria-hidden="true" tabindex="-1"></a><span class="co"># and</span></span>
<span id="cb148-462"><a href="#cb148-462" aria-hidden="true" tabindex="-1"></a>mtcars <span class="op">&gt;&gt;</span> <span class="bu">filter</span>(_.mpg<span class="op">==</span><span class="dv">21</span>,_.cyl<span class="op">==</span><span class="dv">6</span>)</span>
<span id="cb148-463"><a href="#cb148-463" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-466"><a href="#cb148-466" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-467"><a href="#cb148-467" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb148-468"><a href="#cb148-468" aria-hidden="true" tabindex="-1"></a>mtcars <span class="op">&gt;&gt;</span> <span class="bu">filter</span>((_.mpg<span class="op">==</span><span class="dv">21</span>) <span class="op">|</span>(_.cyl<span class="op">==</span><span class="dv">6</span>))</span>
<span id="cb148-469"><a href="#cb148-469" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-470"><a href="#cb148-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-471"><a href="#cb148-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-472"><a href="#cb148-472" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb148-473"><a href="#cb148-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-474"><a href="#cb148-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-475"><a href="#cb148-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-476"><a href="#cb148-476" aria-hidden="true" tabindex="-1"></a><span class="fu"># order</span></span>
<span id="cb148-477"><a href="#cb148-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-478"><a href="#cb148-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-479"><a href="#cb148-479" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb148-480"><a href="#cb148-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-481"><a href="#cb148-481" aria-hidden="true" tabindex="-1"></a><span class="fu">## sql</span></span>
<span id="cb148-482"><a href="#cb148-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-485"><a href="#cb148-485" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-486"><a href="#cb148-486" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-487"><a href="#cb148-487" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name <span class="kw">as</span> model,mpg,cyl <span class="kw">from</span> mtcars_table <span class="kw">order</span> <span class="kw">by</span> mpg <span class="kw">desc</span> <span class="kw">limit</span> <span class="dv">3</span>;</span>
<span id="cb148-488"><a href="#cb148-488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-489"><a href="#cb148-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-490"><a href="#cb148-490" aria-hidden="true" tabindex="-1"></a><span class="fu">## R  </span></span>
<span id="cb148-491"><a href="#cb148-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-494"><a href="#cb148-494" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-495"><a href="#cb148-495" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="at">model=</span>model_name,mpg,cyl) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(mpg)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">3</span>)</span>
<span id="cb148-496"><a href="#cb148-496" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-497"><a href="#cb148-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-498"><a href="#cb148-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-499"><a href="#cb148-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-500"><a href="#cb148-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-501"><a href="#cb148-501" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb148-502"><a href="#cb148-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-505"><a href="#cb148-505" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-506"><a href="#cb148-506" aria-hidden="true" tabindex="-1"></a>mtcars[[<span class="st">"model_name"</span>,<span class="st">"mpg"</span>,<span class="st">"cyl"</span>]].sort_values(by<span class="op">=</span><span class="st">'mpg'</span>,ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">3</span>)</span>
<span id="cb148-507"><a href="#cb148-507" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-508"><a href="#cb148-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-509"><a href="#cb148-509" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python siuba</span></span>
<span id="cb148-510"><a href="#cb148-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-513"><a href="#cb148-513" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-514"><a href="#cb148-514" aria-hidden="true" tabindex="-1"></a>mtcars <span class="op">&gt;&gt;</span> select(_.model_name,_.mpg,_.cyl) <span class="op">&gt;&gt;</span> arrange(<span class="op">-</span>_.mpg) <span class="op">&gt;&gt;</span> head(<span class="dv">3</span>)</span>
<span id="cb148-515"><a href="#cb148-515" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-516"><a href="#cb148-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-517"><a href="#cb148-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-518"><a href="#cb148-518" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb148-519"><a href="#cb148-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-520"><a href="#cb148-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-521"><a href="#cb148-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-522"><a href="#cb148-522" aria-hidden="true" tabindex="-1"></a><span class="fu"># group by</span></span>
<span id="cb148-523"><a href="#cb148-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-524"><a href="#cb148-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-525"><a href="#cb148-525" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb148-526"><a href="#cb148-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-527"><a href="#cb148-527" aria-hidden="true" tabindex="-1"></a><span class="fu">## sql</span></span>
<span id="cb148-530"><a href="#cb148-530" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-531"><a href="#cb148-531" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-532"><a href="#cb148-532" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, <span class="fu">sum</span>(mpg) <span class="kw">as</span> total_mpg,mean(cyl) <span class="kw">as</span> cyl_mean <span class="kw">from</span> mtcars_table</span>
<span id="cb148-533"><a href="#cb148-533" aria-hidden="true" tabindex="-1"></a><span class="kw">group</span> <span class="kw">by</span> <span class="dv">1</span> <span class="kw">limit</span> <span class="dv">5</span></span>
<span id="cb148-534"><a href="#cb148-534" aria-hidden="true" tabindex="-1"></a>;</span>
<span id="cb148-535"><a href="#cb148-535" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-536"><a href="#cb148-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-537"><a href="#cb148-537" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb148-538"><a href="#cb148-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-541"><a href="#cb148-541" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-542"><a href="#cb148-542" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">group_by</span>(model_name) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="at">total_mpg=</span><span class="fu">sum</span>(mpg),<span class="at">cyl_mean=</span><span class="fu">mean</span>(cyl)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>)</span>
<span id="cb148-543"><a href="#cb148-543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-544"><a href="#cb148-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-545"><a href="#cb148-545" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb148-546"><a href="#cb148-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-549"><a href="#cb148-549" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-550"><a href="#cb148-550" aria-hidden="true" tabindex="-1"></a>mtcars.groupby(<span class="st">'model_name'</span>).agg({<span class="st">'mpg'</span>: <span class="st">'sum'</span>, <span class="st">'cyl'</span>: <span class="st">'mean'</span>}).head(<span class="dv">5</span>)</span>
<span id="cb148-551"><a href="#cb148-551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-552"><a href="#cb148-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-553"><a href="#cb148-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-554"><a href="#cb148-554" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python siuba</span></span>
<span id="cb148-555"><a href="#cb148-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-558"><a href="#cb148-558" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-559"><a href="#cb148-559" aria-hidden="true" tabindex="-1"></a>mtcars <span class="op">&gt;&gt;</span> group_by(_.model_name) <span class="op">&gt;&gt;</span> summarize(total_mpg<span class="op">=</span>_.mpg.<span class="bu">sum</span>(),cyl_mean<span class="op">=</span>_.cyl.mean()) <span class="op">&gt;&gt;</span> head(<span class="dv">5</span>)</span>
<span id="cb148-560"><a href="#cb148-560" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-561"><a href="#cb148-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-562"><a href="#cb148-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-563"><a href="#cb148-563" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb148-564"><a href="#cb148-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-565"><a href="#cb148-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-566"><a href="#cb148-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-567"><a href="#cb148-567" aria-hidden="true" tabindex="-1"></a><span class="fu"># create table</span></span>
<span id="cb148-568"><a href="#cb148-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-569"><a href="#cb148-569" aria-hidden="true" tabindex="-1"></a><span class="fu">## CREATE OR REPLACE</span></span>
<span id="cb148-570"><a href="#cb148-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-571"><a href="#cb148-571" aria-hidden="true" tabindex="-1"></a>allows a new table to be created or for an existing table to be overwritten by the new table. This is shorthand for dropping the existing table and then creating the new one.</span>
<span id="cb148-572"><a href="#cb148-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-575"><a href="#cb148-575" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-576"><a href="#cb148-576" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-577"><a href="#cb148-577" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">OR</span> <span class="kw">REPLACE</span> temp <span class="kw">table</span> mtcars_table_group <span class="kw">as</span></span>
<span id="cb148-578"><a href="#cb148-578" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, <span class="fu">sum</span>(mpg) <span class="kw">as</span> total_mpg,mean(cyl) <span class="kw">as</span> cyl_mean <span class="kw">from</span> mtcars_table</span>
<span id="cb148-579"><a href="#cb148-579" aria-hidden="true" tabindex="-1"></a><span class="kw">group</span> <span class="kw">by</span> <span class="dv">1</span></span>
<span id="cb148-580"><a href="#cb148-580" aria-hidden="true" tabindex="-1"></a>;</span>
<span id="cb148-581"><a href="#cb148-581" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-582"><a href="#cb148-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-583"><a href="#cb148-583" aria-hidden="true" tabindex="-1"></a><span class="fu">## CREATE TABLE IF NOT EXISTS</span></span>
<span id="cb148-584"><a href="#cb148-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-585"><a href="#cb148-585" aria-hidden="true" tabindex="-1"></a>will only proceed with the creation of the table if it does not already exist. If the table already exists, no action will be taken and the existing table will remain in the database.</span>
<span id="cb148-586"><a href="#cb148-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-589"><a href="#cb148-589" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-590"><a href="#cb148-590" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-591"><a href="#cb148-591" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">NOT</span> <span class="kw">EXISTS</span>  new_mtcars_table_group <span class="kw">as</span></span>
<span id="cb148-592"><a href="#cb148-592" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, <span class="fu">sum</span>(mpg) <span class="kw">as</span> total_mpg,mean(cyl) <span class="kw">as</span> cyl_mean <span class="kw">from</span> mtcars_table</span>
<span id="cb148-593"><a href="#cb148-593" aria-hidden="true" tabindex="-1"></a><span class="kw">group</span> <span class="kw">by</span> <span class="dv">1</span></span>
<span id="cb148-594"><a href="#cb148-594" aria-hidden="true" tabindex="-1"></a>;</span>
<span id="cb148-595"><a href="#cb148-595" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-596"><a href="#cb148-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-597"><a href="#cb148-597" aria-hidden="true" tabindex="-1"></a><span class="fu"># unique</span></span>
<span id="cb148-598"><a href="#cb148-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-599"><a href="#cb148-599" aria-hidden="true" tabindex="-1"></a><span class="fu">## check unique</span></span>
<span id="cb148-600"><a href="#cb148-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-603"><a href="#cb148-603" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-604"><a href="#cb148-604" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-605"><a href="#cb148-605" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>),<span class="fu">count</span>(<span class="kw">distinct</span> model_name) <span class="kw">from</span> mtcars_table</span>
<span id="cb148-606"><a href="#cb148-606" aria-hidden="true" tabindex="-1"></a>;</span>
<span id="cb148-607"><a href="#cb148-607" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-608"><a href="#cb148-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-609"><a href="#cb148-609" aria-hidden="true" tabindex="-1"></a><span class="fu"># join</span></span>
<span id="cb148-610"><a href="#cb148-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-613"><a href="#cb148-613" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-614"><a href="#cb148-614" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-615"><a href="#cb148-615" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  <span class="op">*</span> <span class="kw">from</span> mtcars_table_group t1 ;</span>
<span id="cb148-616"><a href="#cb148-616" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-617"><a href="#cb148-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-618"><a href="#cb148-618" aria-hidden="true" tabindex="-1"></a><span class="fu">## left join</span></span>
<span id="cb148-619"><a href="#cb148-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-620"><a href="#cb148-620" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb148-621"><a href="#cb148-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-622"><a href="#cb148-622" aria-hidden="true" tabindex="-1"></a><span class="fu"># sql</span></span>
<span id="cb148-625"><a href="#cb148-625" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-626"><a href="#cb148-626" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-627"><a href="#cb148-627" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t1<span class="ch">.</span>model_name,t1<span class="ch">.</span>mpg ,t1<span class="ch">.</span>cyl,t2<span class="ch">.</span><span class="op">*</span> <span class="kw">from</span> mtcars_table t1 </span>
<span id="cb148-628"><a href="#cb148-628" aria-hidden="true" tabindex="-1"></a><span class="kw">left</span> <span class="kw">join</span> mtcars_table_group t2 <span class="kw">on</span> t1<span class="ch">.</span>model_name <span class="op">=</span> t2<span class="ch">.</span>model_name</span>
<span id="cb148-629"><a href="#cb148-629" aria-hidden="true" tabindex="-1"></a><span class="kw">limit</span> <span class="dv">5</span></span>
<span id="cb148-630"><a href="#cb148-630" aria-hidden="true" tabindex="-1"></a>;</span>
<span id="cb148-631"><a href="#cb148-631" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-632"><a href="#cb148-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-633"><a href="#cb148-633" aria-hidden="true" tabindex="-1"></a><span class="fu"># R</span></span>
<span id="cb148-634"><a href="#cb148-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-637"><a href="#cb148-637" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-638"><a href="#cb148-638" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">left_join</span>(mtcars, <span class="at">by =</span> <span class="fu">join_by</span>(model_name <span class="sc">==</span> model_name)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>)</span>
<span id="cb148-639"><a href="#cb148-639" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-640"><a href="#cb148-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-641"><a href="#cb148-641" aria-hidden="true" tabindex="-1"></a><span class="fu"># Python</span></span>
<span id="cb148-642"><a href="#cb148-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-645"><a href="#cb148-645" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-646"><a href="#cb148-646" aria-hidden="true" tabindex="-1"></a>pd.merge(mtcars, mtcars, left_on<span class="op">=</span><span class="st">'model_name'</span>, right_on<span class="op">=</span><span class="st">'model_name'</span>, how<span class="op">=</span><span class="st">'left'</span>).head(<span class="dv">5</span>)</span>
<span id="cb148-647"><a href="#cb148-647" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-648"><a href="#cb148-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-649"><a href="#cb148-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-650"><a href="#cb148-650" aria-hidden="true" tabindex="-1"></a><span class="fu"># Python siuba</span></span>
<span id="cb148-651"><a href="#cb148-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-654"><a href="#cb148-654" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-655"><a href="#cb148-655" aria-hidden="true" tabindex="-1"></a>mtcars <span class="op">&gt;&gt;</span> left_join(_,mtcars, on <span class="op">=</span> {<span class="st">"model_name"</span>: <span class="st">"model_name"</span>}) <span class="op">&gt;&gt;</span> head(<span class="dv">5</span>)</span>
<span id="cb148-656"><a href="#cb148-656" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-657"><a href="#cb148-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-658"><a href="#cb148-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-659"><a href="#cb148-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-660"><a href="#cb148-660" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb148-661"><a href="#cb148-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-662"><a href="#cb148-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-663"><a href="#cb148-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-664"><a href="#cb148-664" aria-hidden="true" tabindex="-1"></a><span class="fu">## inter join</span></span>
<span id="cb148-665"><a href="#cb148-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-666"><a href="#cb148-666" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb148-667"><a href="#cb148-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-668"><a href="#cb148-668" aria-hidden="true" tabindex="-1"></a><span class="fu"># sql</span></span>
<span id="cb148-669"><a href="#cb148-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-672"><a href="#cb148-672" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-673"><a href="#cb148-673" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-674"><a href="#cb148-674" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t1<span class="ch">.</span>model_name,t1<span class="ch">.</span>mpg ,t1<span class="ch">.</span>cyl,t2<span class="ch">.</span><span class="op">*</span> <span class="kw">from</span> mtcars_table t1 </span>
<span id="cb148-675"><a href="#cb148-675" aria-hidden="true" tabindex="-1"></a><span class="kw">inner</span> <span class="kw">join</span> (<span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> mtcars_table_group <span class="kw">limit</span> <span class="dv">5</span>) t2 <span class="kw">on</span> t1<span class="ch">.</span>model_name <span class="op">=</span> t2<span class="ch">.</span>model_name</span>
<span id="cb148-676"><a href="#cb148-676" aria-hidden="true" tabindex="-1"></a>;</span>
<span id="cb148-677"><a href="#cb148-677" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-678"><a href="#cb148-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-679"><a href="#cb148-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-680"><a href="#cb148-680" aria-hidden="true" tabindex="-1"></a><span class="fu"># R</span></span>
<span id="cb148-681"><a href="#cb148-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-684"><a href="#cb148-684" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-685"><a href="#cb148-685" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">inner_join</span>(mtcars, <span class="at">by =</span> <span class="fu">join_by</span>(model_name <span class="sc">==</span> model_name)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>)</span>
<span id="cb148-686"><a href="#cb148-686" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-687"><a href="#cb148-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-688"><a href="#cb148-688" aria-hidden="true" tabindex="-1"></a><span class="fu"># Python</span></span>
<span id="cb148-689"><a href="#cb148-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-692"><a href="#cb148-692" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-693"><a href="#cb148-693" aria-hidden="true" tabindex="-1"></a>pd.merge(mtcars, mtcars, left_on<span class="op">=</span><span class="st">'model_name'</span>, right_on<span class="op">=</span><span class="st">'model_name'</span>, how<span class="op">=</span><span class="st">'inner'</span>).head(<span class="dv">5</span>)</span>
<span id="cb148-694"><a href="#cb148-694" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-695"><a href="#cb148-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-696"><a href="#cb148-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-697"><a href="#cb148-697" aria-hidden="true" tabindex="-1"></a><span class="fu"># Python siuba</span></span>
<span id="cb148-698"><a href="#cb148-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-701"><a href="#cb148-701" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-702"><a href="#cb148-702" aria-hidden="true" tabindex="-1"></a>mtcars <span class="op">&gt;&gt;</span> inner_join(_,mtcars, on <span class="op">=</span> {<span class="st">"model_name"</span>: <span class="st">"model_name"</span>}) <span class="op">&gt;&gt;</span> head(<span class="dv">5</span>)</span>
<span id="cb148-703"><a href="#cb148-703" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-704"><a href="#cb148-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-705"><a href="#cb148-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-706"><a href="#cb148-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-707"><a href="#cb148-707" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb148-708"><a href="#cb148-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-709"><a href="#cb148-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-710"><a href="#cb148-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-711"><a href="#cb148-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-712"><a href="#cb148-712" aria-hidden="true" tabindex="-1"></a><span class="fu"># append rows</span></span>
<span id="cb148-713"><a href="#cb148-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-714"><a href="#cb148-714" aria-hidden="true" tabindex="-1"></a><span class="fu">## append without duplicate elimination `union all`</span></span>
<span id="cb148-715"><a href="#cb148-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-716"><a href="#cb148-716" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb148-717"><a href="#cb148-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-718"><a href="#cb148-718" aria-hidden="true" tabindex="-1"></a><span class="fu">### sql</span></span>
<span id="cb148-719"><a href="#cb148-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-722"><a href="#cb148-722" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-723"><a href="#cb148-723" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-724"><a href="#cb148-724" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">from</span> mtcars_table</span>
<span id="cb148-725"><a href="#cb148-725" aria-hidden="true" tabindex="-1"></a>;</span>
<span id="cb148-726"><a href="#cb148-726" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-727"><a href="#cb148-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-730"><a href="#cb148-730" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-731"><a href="#cb148-731" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-732"><a href="#cb148-732" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> temp <span class="kw">table</span> double_mtcars_table <span class="kw">as</span></span>
<span id="cb148-733"><a href="#cb148-733" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">from</span> mtcars_table </span>
<span id="cb148-734"><a href="#cb148-734" aria-hidden="true" tabindex="-1"></a><span class="kw">union</span> <span class="kw">all</span></span>
<span id="cb148-735"><a href="#cb148-735" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">from</span> mtcars_table </span>
<span id="cb148-736"><a href="#cb148-736" aria-hidden="true" tabindex="-1"></a>;</span>
<span id="cb148-737"><a href="#cb148-737" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-738"><a href="#cb148-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-741"><a href="#cb148-741" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-742"><a href="#cb148-742" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-743"><a href="#cb148-743" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">from</span> double_mtcars_table</span>
<span id="cb148-744"><a href="#cb148-744" aria-hidden="true" tabindex="-1"></a>;</span>
<span id="cb148-745"><a href="#cb148-745" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-746"><a href="#cb148-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-747"><a href="#cb148-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-748"><a href="#cb148-748" aria-hidden="true" tabindex="-1"></a><span class="fu">### R</span></span>
<span id="cb148-749"><a href="#cb148-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-752"><a href="#cb148-752" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-753"><a href="#cb148-753" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>(mtcars)</span>
<span id="cb148-754"><a href="#cb148-754" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-755"><a href="#cb148-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-756"><a href="#cb148-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-757"><a href="#cb148-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-758"><a href="#cb148-758" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python</span></span>
<span id="cb148-759"><a href="#cb148-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-762"><a href="#cb148-762" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-763"><a href="#cb148-763" aria-hidden="true" tabindex="-1"></a>pd.concat([mtcars,mtcars],ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb148-764"><a href="#cb148-764" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-765"><a href="#cb148-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-766"><a href="#cb148-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-767"><a href="#cb148-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-768"><a href="#cb148-768" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb148-769"><a href="#cb148-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-770"><a href="#cb148-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-771"><a href="#cb148-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-772"><a href="#cb148-772" aria-hidden="true" tabindex="-1"></a><span class="fu">## append with duplicate elimination `union`</span></span>
<span id="cb148-773"><a href="#cb148-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-774"><a href="#cb148-774" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb148-775"><a href="#cb148-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-776"><a href="#cb148-776" aria-hidden="true" tabindex="-1"></a><span class="fu">### sql</span></span>
<span id="cb148-777"><a href="#cb148-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-780"><a href="#cb148-780" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-781"><a href="#cb148-781" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-782"><a href="#cb148-782" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">OR</span> <span class="kw">REPLACE</span> temp <span class="kw">table</span> double_mtcars_table <span class="kw">as</span></span>
<span id="cb148-783"><a href="#cb148-783" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">from</span> mtcars_table </span>
<span id="cb148-784"><a href="#cb148-784" aria-hidden="true" tabindex="-1"></a><span class="kw">union</span></span>
<span id="cb148-785"><a href="#cb148-785" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">from</span> mtcars_table </span>
<span id="cb148-786"><a href="#cb148-786" aria-hidden="true" tabindex="-1"></a>;</span>
<span id="cb148-787"><a href="#cb148-787" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-788"><a href="#cb148-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-791"><a href="#cb148-791" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-792"><a href="#cb148-792" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-793"><a href="#cb148-793" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">from</span> double_mtcars_table</span>
<span id="cb148-794"><a href="#cb148-794" aria-hidden="true" tabindex="-1"></a>;</span>
<span id="cb148-795"><a href="#cb148-795" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-796"><a href="#cb148-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-799"><a href="#cb148-799" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-800"><a href="#cb148-800" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con </span></span>
<span id="cb148-801"><a href="#cb148-801" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">from</span> (</span>
<span id="cb148-802"><a href="#cb148-802" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">distinct</span> <span class="op">*</span> <span class="kw">from</span> double_mtcars_table</span>
<span id="cb148-803"><a href="#cb148-803" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb148-804"><a href="#cb148-804" aria-hidden="true" tabindex="-1"></a>;</span>
<span id="cb148-805"><a href="#cb148-805" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-806"><a href="#cb148-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-807"><a href="#cb148-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-808"><a href="#cb148-808" aria-hidden="true" tabindex="-1"></a><span class="fu">### R</span></span>
<span id="cb148-809"><a href="#cb148-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-812"><a href="#cb148-812" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-813"><a href="#cb148-813" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>(mtcars) <span class="sc">|&gt;</span> <span class="fu">distinct</span>()</span>
<span id="cb148-814"><a href="#cb148-814" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-815"><a href="#cb148-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-816"><a href="#cb148-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-817"><a href="#cb148-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-818"><a href="#cb148-818" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python</span></span>
<span id="cb148-819"><a href="#cb148-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-822"><a href="#cb148-822" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-823"><a href="#cb148-823" aria-hidden="true" tabindex="-1"></a>pd.concat([mtcars,mtcars],ignore_index<span class="op">=</span><span class="va">True</span>).drop_duplicates()</span>
<span id="cb148-824"><a href="#cb148-824" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-825"><a href="#cb148-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-826"><a href="#cb148-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-827"><a href="#cb148-827" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb148-828"><a href="#cb148-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-829"><a href="#cb148-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-830"><a href="#cb148-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-831"><a href="#cb148-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-832"><a href="#cb148-832" aria-hidden="true" tabindex="-1"></a><span class="fu"># delete rows</span></span>
<span id="cb148-833"><a href="#cb148-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-834"><a href="#cb148-834" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb148-835"><a href="#cb148-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-836"><a href="#cb148-836" aria-hidden="true" tabindex="-1"></a><span class="fu">## sql</span></span>
<span id="cb148-839"><a href="#cb148-839" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-840"><a href="#cb148-840" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-841"><a href="#cb148-841" aria-hidden="true" tabindex="-1"></a><span class="kw">DELETE</span> <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> model_name <span class="op">=</span> <span class="st">'Mazda RX4'</span>;</span>
<span id="cb148-842"><a href="#cb148-842" aria-hidden="true" tabindex="-1"></a>;</span>
<span id="cb148-843"><a href="#cb148-843" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-844"><a href="#cb148-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-847"><a href="#cb148-847" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-848"><a href="#cb148-848" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-849"><a href="#cb148-849" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">from</span> mtcars_table</span>
<span id="cb148-850"><a href="#cb148-850" aria-hidden="true" tabindex="-1"></a>;</span>
<span id="cb148-851"><a href="#cb148-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-852"><a href="#cb148-852" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-853"><a href="#cb148-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-854"><a href="#cb148-854" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb148-855"><a href="#cb148-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-858"><a href="#cb148-858" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-859"><a href="#cb148-859" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(model_name <span class="sc">!=</span> <span class="st">'Mazda RX4'</span>)</span>
<span id="cb148-860"><a href="#cb148-860" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-861"><a href="#cb148-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-862"><a href="#cb148-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-863"><a href="#cb148-863" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb148-864"><a href="#cb148-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-867"><a href="#cb148-867" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-868"><a href="#cb148-868" aria-hidden="true" tabindex="-1"></a>mtcars[mtcars[<span class="st">'model_name'</span>] <span class="op">!=</span> <span class="st">'Mazda RX4'</span>]</span>
<span id="cb148-869"><a href="#cb148-869" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-870"><a href="#cb148-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-871"><a href="#cb148-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-872"><a href="#cb148-872" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python siuba</span></span>
<span id="cb148-873"><a href="#cb148-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-876"><a href="#cb148-876" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-877"><a href="#cb148-877" aria-hidden="true" tabindex="-1"></a>mtcars <span class="op">&gt;&gt;</span> <span class="bu">filter</span>(_.model_name <span class="op">!=</span> <span class="st">'Mazda RX4'</span>)</span>
<span id="cb148-878"><a href="#cb148-878" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-879"><a href="#cb148-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-880"><a href="#cb148-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-881"><a href="#cb148-881" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb148-882"><a href="#cb148-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-883"><a href="#cb148-883" aria-hidden="true" tabindex="-1"></a><span class="fu"># update rows</span></span>
<span id="cb148-884"><a href="#cb148-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-885"><a href="#cb148-885" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb148-886"><a href="#cb148-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-887"><a href="#cb148-887" aria-hidden="true" tabindex="-1"></a><span class="fu">## sql</span></span>
<span id="cb148-890"><a href="#cb148-890" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-891"><a href="#cb148-891" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-892"><a href="#cb148-892" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> model_name,mpg  <span class="kw">from</span> mtcars_table <span class="kw">where</span> model_name<span class="op">=</span> <span class="st">'Mazda RX4'</span></span>
<span id="cb148-893"><a href="#cb148-893" aria-hidden="true" tabindex="-1"></a>;</span>
<span id="cb148-894"><a href="#cb148-894" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-895"><a href="#cb148-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-898"><a href="#cb148-898" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-899"><a href="#cb148-899" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-900"><a href="#cb148-900" aria-hidden="true" tabindex="-1"></a><span class="kw">UPDATE</span> mtcars_table</span>
<span id="cb148-901"><a href="#cb148-901" aria-hidden="true" tabindex="-1"></a><span class="kw">SET</span> mpg <span class="op">=</span> <span class="dv">999</span></span>
<span id="cb148-902"><a href="#cb148-902" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> model_name<span class="op">=</span> <span class="st">'Mazda RX4'</span></span>
<span id="cb148-903"><a href="#cb148-903" aria-hidden="true" tabindex="-1"></a>;</span>
<span id="cb148-904"><a href="#cb148-904" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-905"><a href="#cb148-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-908"><a href="#cb148-908" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-909"><a href="#cb148-909" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-910"><a href="#cb148-910" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> model_name,mpg <span class="kw">from</span> mtcars_table <span class="kw">where</span> model_name<span class="op">=</span> <span class="st">'Mazda RX4'</span></span>
<span id="cb148-911"><a href="#cb148-911" aria-hidden="true" tabindex="-1"></a>;</span>
<span id="cb148-912"><a href="#cb148-912" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-913"><a href="#cb148-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-914"><a href="#cb148-914" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb148-915"><a href="#cb148-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-918"><a href="#cb148-918" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-919"><a href="#cb148-919" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(model_name <span class="sc">==</span> <span class="st">'Mazda RX4 Wag'</span>) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">mpg=</span><span class="dv">999</span>)</span>
<span id="cb148-920"><a href="#cb148-920" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-921"><a href="#cb148-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-922"><a href="#cb148-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-923"><a href="#cb148-923" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb148-924"><a href="#cb148-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-927"><a href="#cb148-927" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-928"><a href="#cb148-928" aria-hidden="true" tabindex="-1"></a>mtcars.loc[mtcars[<span class="st">'model_name'</span>] <span class="op">==</span> <span class="st">'Mazda RX4 Wag'</span>, <span class="st">'mpg'</span>] <span class="op">=</span> <span class="dv">999</span></span>
<span id="cb148-929"><a href="#cb148-929" aria-hidden="true" tabindex="-1"></a>mtcars</span>
<span id="cb148-930"><a href="#cb148-930" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-931"><a href="#cb148-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-932"><a href="#cb148-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-933"><a href="#cb148-933" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python siuba</span></span>
<span id="cb148-934"><a href="#cb148-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-937"><a href="#cb148-937" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-938"><a href="#cb148-938" aria-hidden="true" tabindex="-1"></a>mtcars <span class="op">&gt;&gt;</span> <span class="bu">filter</span>(_.model_name <span class="op">==</span> <span class="st">'Mazda RX4 Wag'</span>) <span class="op">&gt;&gt;</span> mutate(mpg<span class="op">=</span><span class="dv">999</span>)</span>
<span id="cb148-939"><a href="#cb148-939" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-940"><a href="#cb148-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-941"><a href="#cb148-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-942"><a href="#cb148-942" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb148-943"><a href="#cb148-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-944"><a href="#cb148-944" aria-hidden="true" tabindex="-1"></a><span class="fu"># drop table</span></span>
<span id="cb148-945"><a href="#cb148-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-946"><a href="#cb148-946" aria-hidden="true" tabindex="-1"></a>Before drop</span>
<span id="cb148-947"><a href="#cb148-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-950"><a href="#cb148-950" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-951"><a href="#cb148-951" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-952"><a href="#cb148-952" aria-hidden="true" tabindex="-1"></a><span class="kw">SHOW</span> <span class="kw">ALL</span> <span class="kw">TABLES</span>;</span>
<span id="cb148-953"><a href="#cb148-953" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-954"><a href="#cb148-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-955"><a href="#cb148-955" aria-hidden="true" tabindex="-1"></a>dropping</span>
<span id="cb148-956"><a href="#cb148-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-959"><a href="#cb148-959" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-960"><a href="#cb148-960" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-961"><a href="#cb148-961" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">table</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> mtcars_table_group;</span>
<span id="cb148-962"><a href="#cb148-962" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-963"><a href="#cb148-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-964"><a href="#cb148-964" aria-hidden="true" tabindex="-1"></a>after drop</span>
<span id="cb148-965"><a href="#cb148-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-968"><a href="#cb148-968" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-969"><a href="#cb148-969" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-970"><a href="#cb148-970" aria-hidden="true" tabindex="-1"></a><span class="kw">SHOW</span> <span class="kw">ALL</span> <span class="kw">TABLES</span>;</span>
<span id="cb148-971"><a href="#cb148-971" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-972"><a href="#cb148-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-973"><a href="#cb148-973" aria-hidden="true" tabindex="-1"></a><span class="fu"># PIVOT</span></span>
<span id="cb148-974"><a href="#cb148-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-975"><a href="#cb148-975" aria-hidden="true" tabindex="-1"></a>long to wide</span>
<span id="cb148-976"><a href="#cb148-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-979"><a href="#cb148-979" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-980"><a href="#cb148-980" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-981"><a href="#cb148-981" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">table</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> cities;</span>
<span id="cb148-982"><a href="#cb148-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-983"><a href="#cb148-983" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> temp <span class="kw">TABLE</span>  cities (</span>
<span id="cb148-984"><a href="#cb148-984" aria-hidden="true" tabindex="-1"></a>    country <span class="dt">VARCHAR</span>, name <span class="dt">VARCHAR</span>, <span class="fu">year</span> <span class="dt">INTEGER</span>, population <span class="dt">INTEGER</span></span>
<span id="cb148-985"><a href="#cb148-985" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb148-986"><a href="#cb148-986" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> cities <span class="kw">VALUES</span></span>
<span id="cb148-987"><a href="#cb148-987" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'NL'</span>, <span class="st">'Amsterdam'</span>, <span class="dv">2000</span>, <span class="dv">1005</span>),</span>
<span id="cb148-988"><a href="#cb148-988" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'NL'</span>, <span class="st">'Amsterdam'</span>, <span class="dv">2010</span>, <span class="dv">1065</span>),</span>
<span id="cb148-989"><a href="#cb148-989" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'NL'</span>, <span class="st">'Amsterdam'</span>, <span class="dv">2020</span>, <span class="dv">1158</span>),</span>
<span id="cb148-990"><a href="#cb148-990" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'Seattle'</span>, <span class="dv">2000</span>, <span class="dv">564</span>),</span>
<span id="cb148-991"><a href="#cb148-991" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'Seattle'</span>, <span class="dv">2010</span>, <span class="dv">608</span>),</span>
<span id="cb148-992"><a href="#cb148-992" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'Seattle'</span>, <span class="dv">2020</span>, <span class="dv">738</span>),</span>
<span id="cb148-993"><a href="#cb148-993" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'New York City'</span>, <span class="dv">2000</span>, <span class="dv">8015</span>),</span>
<span id="cb148-994"><a href="#cb148-994" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'New York City'</span>, <span class="dv">2010</span>, <span class="dv">8175</span>),</span>
<span id="cb148-995"><a href="#cb148-995" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'New York City'</span>, <span class="dv">2020</span>, <span class="dv">8772</span>);</span>
<span id="cb148-996"><a href="#cb148-996" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-997"><a href="#cb148-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1000"><a href="#cb148-1000" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-1001"><a href="#cb148-1001" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-1002"><a href="#cb148-1002" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span></span>
<span id="cb148-1003"><a href="#cb148-1003" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cities;</span>
<span id="cb148-1004"><a href="#cb148-1004" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-1005"><a href="#cb148-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1006"><a href="#cb148-1006" aria-hidden="true" tabindex="-1"></a><span class="fu">## PIVOT on one column</span></span>
<span id="cb148-1007"><a href="#cb148-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1010"><a href="#cb148-1010" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-1011"><a href="#cb148-1011" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-1012"><a href="#cb148-1012" aria-hidden="true" tabindex="-1"></a>PIVOT cities</span>
<span id="cb148-1013"><a href="#cb148-1013" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> <span class="fu">year</span></span>
<span id="cb148-1014"><a href="#cb148-1014" aria-hidden="true" tabindex="-1"></a><span class="kw">USING</span> <span class="fu">sum</span>(population)</span>
<span id="cb148-1015"><a href="#cb148-1015" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> country;</span>
<span id="cb148-1016"><a href="#cb148-1016" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-1017"><a href="#cb148-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1018"><a href="#cb148-1018" aria-hidden="true" tabindex="-1"></a><span class="fu">## PIVOT on two column</span></span>
<span id="cb148-1019"><a href="#cb148-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1022"><a href="#cb148-1022" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-1023"><a href="#cb148-1023" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-1024"><a href="#cb148-1024" aria-hidden="true" tabindex="-1"></a>PIVOT cities</span>
<span id="cb148-1025"><a href="#cb148-1025" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> country, name</span>
<span id="cb148-1026"><a href="#cb148-1026" aria-hidden="true" tabindex="-1"></a><span class="kw">USING</span> <span class="fu">sum</span>(population);</span>
<span id="cb148-1027"><a href="#cb148-1027" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-1028"><a href="#cb148-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1029"><a href="#cb148-1029" aria-hidden="true" tabindex="-1"></a><span class="fu"># unpivot</span></span>
<span id="cb148-1030"><a href="#cb148-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1031"><a href="#cb148-1031" aria-hidden="true" tabindex="-1"></a>wide to long</span>
<span id="cb148-1032"><a href="#cb148-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1035"><a href="#cb148-1035" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-1036"><a href="#cb148-1036" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-1037"><a href="#cb148-1037" aria-hidden="true" tabindex="-1"></a>UNPIVOT</span>
<span id="cb148-1038"><a href="#cb148-1038" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb148-1039"><a href="#cb148-1039" aria-hidden="true" tabindex="-1"></a>PIVOT cities</span>
<span id="cb148-1040"><a href="#cb148-1040" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> <span class="fu">year</span></span>
<span id="cb148-1041"><a href="#cb148-1041" aria-hidden="true" tabindex="-1"></a><span class="kw">USING</span> <span class="fu">sum</span>(population)</span>
<span id="cb148-1042"><a href="#cb148-1042" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> country</span>
<span id="cb148-1043"><a href="#cb148-1043" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb148-1044"><a href="#cb148-1044" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> <span class="kw">COLUMNS</span>(<span class="op">*</span> EXCLUDE (country))</span>
<span id="cb148-1045"><a href="#cb148-1045" aria-hidden="true" tabindex="-1"></a><span class="kw">INTO</span></span>
<span id="cb148-1046"><a href="#cb148-1046" aria-hidden="true" tabindex="-1"></a>    NAME <span class="fu">year</span></span>
<span id="cb148-1047"><a href="#cb148-1047" aria-hidden="true" tabindex="-1"></a>    VALUE population;</span>
<span id="cb148-1048"><a href="#cb148-1048" aria-hidden="true" tabindex="-1"></a>;</span>
<span id="cb148-1049"><a href="#cb148-1049" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-1050"><a href="#cb148-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1051"><a href="#cb148-1051" aria-hidden="true" tabindex="-1"></a><span class="fu"># EXPLAIN</span></span>
<span id="cb148-1052"><a href="#cb148-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1055"><a href="#cb148-1055" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-1056"><a href="#cb148-1056" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb148-1057"><a href="#cb148-1057" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-1058"><a href="#cb148-1058" aria-hidden="true" tabindex="-1"></a><span class="kw">EXPLAIN</span> </span>
<span id="cb148-1059"><a href="#cb148-1059" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t1<span class="ch">.</span>model_name,t1<span class="ch">.</span>mpg ,t1<span class="ch">.</span>cyl,t2<span class="ch">.</span><span class="op">*</span> <span class="kw">from</span> mtcars_table t1 </span>
<span id="cb148-1060"><a href="#cb148-1060" aria-hidden="true" tabindex="-1"></a><span class="kw">inner</span> <span class="kw">join</span> (<span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> mtcars_table <span class="kw">limit</span> <span class="dv">5</span>) t2 <span class="kw">on</span> t1<span class="ch">.</span>model_name <span class="op">=</span> t2<span class="ch">.</span>model_name</span>
<span id="cb148-1061"><a href="#cb148-1061" aria-hidden="true" tabindex="-1"></a>;</span>
<span id="cb148-1062"><a href="#cb148-1062" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-1063"><a href="#cb148-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1066"><a href="#cb148-1066" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb148-1067"><a href="#cb148-1067" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb148-1068"><a href="#cb148-1068" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb148-1069"><a href="#cb148-1069" aria-hidden="true" tabindex="-1"></a><span class="kw">EXPLAIN</span> <span class="kw">ANALYZE</span> </span>
<span id="cb148-1070"><a href="#cb148-1070" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t1<span class="ch">.</span>model_name,t1<span class="ch">.</span>mpg ,t1<span class="ch">.</span>cyl,t2<span class="ch">.</span><span class="op">*</span> <span class="kw">from</span> mtcars_table t1 </span>
<span id="cb148-1071"><a href="#cb148-1071" aria-hidden="true" tabindex="-1"></a><span class="kw">inner</span> <span class="kw">join</span> (<span class="kw">select</span> <span class="op">*</span> <span class="kw">from</span> mtcars_table <span class="kw">limit</span> <span class="dv">5</span>) t2 <span class="kw">on</span> t1<span class="ch">.</span>model_name <span class="op">=</span> t2<span class="ch">.</span>model_name</span>
<span id="cb148-1072"><a href="#cb148-1072" aria-hidden="true" tabindex="-1"></a>;</span>
<span id="cb148-1073"><a href="#cb148-1073" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-1074"><a href="#cb148-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1077"><a href="#cb148-1077" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-1078"><a href="#cb148-1078" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(con, <span class="at">shutdown=</span><span class="cn">TRUE</span>)</span>
<span id="cb148-1079"><a href="#cb148-1079" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-1080"><a href="#cb148-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1081"><a href="#cb148-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1082"><a href="#cb148-1082" aria-hidden="true" tabindex="-1"></a><span class="fu"># Display beautiful table</span></span>
<span id="cb148-1083"><a href="#cb148-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1084"><a href="#cb148-1084" aria-hidden="true" tabindex="-1"></a>in R and Python using GT package</span>
<span id="cb148-1085"><a href="#cb148-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1086"><a href="#cb148-1086" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb148-1087"><a href="#cb148-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1088"><a href="#cb148-1088" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb148-1091"><a href="#cb148-1091" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb148-1092"><a href="#cb148-1092" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb148-1093"><a href="#cb148-1093" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">gt</span>() </span>
<span id="cb148-1094"><a href="#cb148-1094" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-1095"><a href="#cb148-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1096"><a href="#cb148-1096" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb148-1097"><a href="#cb148-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1100"><a href="#cb148-1100" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb148-1101"><a href="#cb148-1101" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> great_tables <span class="im">import</span> GT</span>
<span id="cb148-1102"><a href="#cb148-1102" aria-hidden="true" tabindex="-1"></a>GT(mtcars)</span>
<span id="cb148-1103"><a href="#cb148-1103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb148-1104"><a href="#cb148-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1105"><a href="#cb148-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1106"><a href="#cb148-1106" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb148-1107"><a href="#cb148-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1108"><a href="#cb148-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1109"><a href="#cb148-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1110"><a href="#cb148-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1111"><a href="#cb148-1111" aria-hidden="true" tabindex="-1"></a><span class="fu"># reference:</span></span>
<span id="cb148-1112"><a href="#cb148-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1113"><a href="#cb148-1113" aria-hidden="true" tabindex="-1"></a>https://duckdb.org/docs/stable/clients/r.html</span>
<span id="cb148-1114"><a href="#cb148-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-1115"><a href="#cb148-1115" aria-hidden="true" tabindex="-1"></a>https://duckdb.org/docs/stable/sql/statements</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This blog is built with ❤️ and <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>