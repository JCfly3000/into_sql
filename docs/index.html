<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tony Duan">

<title>SQL handbook</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./SQL-Database.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-494121dfa8658343c03537e94414993d.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-a0649ace7b9e9e15dfb5fe311d767a49.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-986303d758dc40252cacaa55bda3e039.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-e97d633d3e9de2170d947f5f0b9a7695.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./SQL-Database.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">SQL handbook</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup-and-configuration" id="toc-setup-and-configuration" class="nav-link active" data-scroll-target="#setup-and-configuration"><span class="header-section-number">1</span> Setup and Configuration</a></li>
  <li><a href="#show-all-tables" id="toc-show-all-tables" class="nav-link" data-scroll-target="#show-all-tables"><span class="header-section-number">2</span> Show All Tables</a></li>
  <li><a href="#describe-a-table" id="toc-describe-a-table" class="nav-link" data-scroll-target="#describe-a-table"><span class="header-section-number">3</span> Describe a Table</a></li>
  <li><a href="#show-column-names" id="toc-show-column-names" class="nav-link" data-scroll-target="#show-column-names"><span class="header-section-number">4</span> Show Column Names</a></li>
  <li><a href="#select" id="toc-select" class="nav-link" data-scroll-target="#select"><span class="header-section-number">5</span> Select</a>
  <ul class="collapse">
  <li><a href="#select-top-6-and-rename" id="toc-select-top-6-and-rename" class="nav-link" data-scroll-target="#select-top-6-and-rename"><span class="header-section-number">5.1</span> Select Top 6 and Rename</a></li>
  <li><a href="#select-distinct" id="toc-select-distinct" class="nav-link" data-scroll-target="#select-distinct"><span class="header-section-number">5.2</span> Select Distinct</a></li>
  </ul></li>
  <li><a href="#check-row-and-column-number" id="toc-check-row-and-column-number" class="nav-link" data-scroll-target="#check-row-and-column-number"><span class="header-section-number">6</span> Check Row and Column Number</a></li>
  <li><a href="#create-column" id="toc-create-column" class="nav-link" data-scroll-target="#create-column"><span class="header-section-number">7</span> Create Column</a></li>
  <li><a href="#filter" id="toc-filter" class="nav-link" data-scroll-target="#filter"><span class="header-section-number">8</span> Filter</a></li>
  <li><a href="#order" id="toc-order" class="nav-link" data-scroll-target="#order"><span class="header-section-number">9</span> Order</a></li>
  <li><a href="#group-by" id="toc-group-by" class="nav-link" data-scroll-target="#group-by"><span class="header-section-number">10</span> Group By</a></li>
  <li><a href="#create-table" id="toc-create-table" class="nav-link" data-scroll-target="#create-table"><span class="header-section-number">11</span> Create Table</a>
  <ul class="collapse">
  <li><a href="#create-or-replace" id="toc-create-or-replace" class="nav-link" data-scroll-target="#create-or-replace"><span class="header-section-number">11.1</span> CREATE OR REPLACE</a></li>
  <li><a href="#create-table-if-not-exists" id="toc-create-table-if-not-exists" class="nav-link" data-scroll-target="#create-table-if-not-exists"><span class="header-section-number">11.2</span> CREATE TABLE IF NOT EXISTS</a></li>
  </ul></li>
  <li><a href="#unique" id="toc-unique" class="nav-link" data-scroll-target="#unique"><span class="header-section-number">12</span> Unique</a>
  <ul class="collapse">
  <li><a href="#check-unique" id="toc-check-unique" class="nav-link" data-scroll-target="#check-unique"><span class="header-section-number">12.1</span> Check Unique</a></li>
  <li><a href="#get-duplicate-and-non-duplicate-data" id="toc-get-duplicate-and-non-duplicate-data" class="nav-link" data-scroll-target="#get-duplicate-and-non-duplicate-data"><span class="header-section-number">12.2</span> Get Duplicate and Non-Duplicate Data</a></li>
  </ul></li>
  <li><a href="#join" id="toc-join" class="nav-link" data-scroll-target="#join"><span class="header-section-number">13</span> Join</a>
  <ul class="collapse">
  <li><a href="#left-join" id="toc-left-join" class="nav-link" data-scroll-target="#left-join"><span class="header-section-number">13.1</span> Left Join</a></li>
  <li><a href="#inner-join" id="toc-inner-join" class="nav-link" data-scroll-target="#inner-join"><span class="header-section-number">13.2</span> Inner Join</a></li>
  </ul></li>
  <li><a href="#append-rows" id="toc-append-rows" class="nav-link" data-scroll-target="#append-rows"><span class="header-section-number">14</span> Append Rows</a>
  <ul class="collapse">
  <li><a href="#append-without-duplicate-elimination-union-all" id="toc-append-without-duplicate-elimination-union-all" class="nav-link" data-scroll-target="#append-without-duplicate-elimination-union-all"><span class="header-section-number">14.1</span> Append Without Duplicate Elimination (<code>union all</code>)</a></li>
  <li><a href="#append-with-duplicate-elimination-union" id="toc-append-with-duplicate-elimination-union" class="nav-link" data-scroll-target="#append-with-duplicate-elimination-union"><span class="header-section-number">14.2</span> Append With Duplicate Elimination (<code>union</code>)</a></li>
  </ul></li>
  <li><a href="#delete-rows" id="toc-delete-rows" class="nav-link" data-scroll-target="#delete-rows"><span class="header-section-number">15</span> Delete Rows</a></li>
  <li><a href="#update-rows" id="toc-update-rows" class="nav-link" data-scroll-target="#update-rows"><span class="header-section-number">16</span> Update Rows</a></li>
  <li><a href="#drop-table" id="toc-drop-table" class="nav-link" data-scroll-target="#drop-table"><span class="header-section-number">17</span> Drop Table</a></li>
  <li><a href="#pivot" id="toc-pivot" class="nav-link" data-scroll-target="#pivot"><span class="header-section-number">18</span> PIVOT</a>
  <ul class="collapse">
  <li><a href="#pivot-on-one-column" id="toc-pivot-on-one-column" class="nav-link" data-scroll-target="#pivot-on-one-column"><span class="header-section-number">18.1</span> PIVOT on One Column</a></li>
  <li><a href="#pivot-on-two-columns" id="toc-pivot-on-two-columns" class="nav-link" data-scroll-target="#pivot-on-two-columns"><span class="header-section-number">18.2</span> PIVOT on Two Columns</a></li>
  </ul></li>
  <li><a href="#unpivot" id="toc-unpivot" class="nav-link" data-scroll-target="#unpivot"><span class="header-section-number">19</span> UNPIVOT</a></li>
  <li><a href="#explain" id="toc-explain" class="nav-link" data-scroll-target="#explain"><span class="header-section-number">20</span> EXPLAIN</a></li>
  <li><a href="#display-beautiful-table" id="toc-display-beautiful-table" class="nav-link" data-scroll-target="#display-beautiful-table"><span class="header-section-number">21</span> Display Beautiful Table</a></li>
  <li><a href="#reference" id="toc-reference" class="nav-link" data-scroll-target="#reference"><span class="header-section-number">22</span> Reference:</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">SQL handbook</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Tony Duan </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>This document provides a comprehensive guide to performing common data manipulation tasks using SQL, R, and Python. It serves as a reference for understanding how to achieve similar outcomes across these three popular data analysis tools.</p>
<section id="setup-and-configuration" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Setup and Configuration</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">py_require</span>(<span class="fu">c</span>(<span class="st">"pandas"</span>,<span class="st">"Great-Tables"</span>,<span class="st">"polars"</span>,<span class="st">"pyarrow"</span>))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries for database interaction, data manipulation, and connections.</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DBI)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSQLite)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(connections)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(duckdb)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the R dataframes.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the existing mtcars dataset if it exists.</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(mtcars)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the mtcars dataframe from the base R dataset, adding the row names as a new column.</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>mtcars <span class="ot">=</span> <span class="fu">cbind</span>(<span class="at">model_name =</span> <span class="fu">rownames</span>(mtcars), mtcars) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the iris dataframe from the base R dataset.</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>iris <span class="ot">=</span> iris <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the database file if it already exists to start with a clean slate.</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">"my-db.duckdb"</span>)) {</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">file.remove</span>(<span class="st">"my-db.duckdb"</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Establish a connection to the DuckDB database.</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(<span class="fu">duckdb</span>(), <span class="at">dbdir =</span> <span class="st">"my-db.duckdb"</span>, <span class="at">read_only =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Write the iris and mtcars dataframes to the database as tables.</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">dbWriteTable</span>(con, <span class="st">"iris_table"</span>, iris, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">dbWriteTable</span>(con, <span class="st">"mtcars_table"</span>, mtcars, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> platform <span class="im">import</span> python_version</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#print(python_version())</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>cities_pd <span class="op">=</span> pd.DataFrame({</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'country'</span>: [<span class="st">'NL'</span>, <span class="st">'NL'</span>, <span class="st">'NL'</span>, <span class="st">'US'</span>, <span class="st">'US'</span>, <span class="st">'US'</span>, <span class="st">'US'</span>, <span class="st">'US'</span>, <span class="st">'US'</span>],</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'name'</span>: [<span class="st">'Amsterdam'</span>, <span class="st">'Amsterdam'</span>, <span class="st">'Amsterdam'</span>, <span class="st">'Seattle'</span>, <span class="st">'Seattle'</span>, <span class="st">'Seattle'</span>, <span class="st">'New York City'</span>, <span class="st">'New York City'</span>, <span class="st">'New York City'</span>],</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'year'</span>: [<span class="dv">2000</span>, <span class="dv">2010</span>, <span class="dv">2020</span>, <span class="dv">2000</span>, <span class="dv">2010</span>, <span class="dv">2020</span>, <span class="dv">2000</span>, <span class="dv">2010</span>, <span class="dv">2020</span>],</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'population'</span>: [<span class="dv">1005</span>, <span class="dv">1065</span>, <span class="dv">1158</span>, <span class="dv">564</span>, <span class="dv">608</span>, <span class="dv">738</span>, <span class="dv">8015</span>, <span class="dv">8175</span>, <span class="dv">8772</span>]</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the R dataframes available in the Python environment.</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>mtcars_pd <span class="op">=</span> r.mtcars</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>iris_pd <span class="op">=</span> r.iris</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>mtcars_pl <span class="op">=</span> pl.from_pandas(mtcars_pd)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>iris_pl <span class="op">=</span> pl.from_pandas(iris_pd)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>cities_pl<span class="op">=</span>pl.from_pandas(cities_pd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>There are tables <code>iris_table</code> and <code>mtcars_table</code> in the DuckDB database <code>my-db.duckdb</code>.</li>
<li>There are dataframes <code>iris</code> and <code>mtcars</code> in the R environment.</li>
<li>There are dataframes <code>iris</code> and <code>mtcars</code> in the Python environment.</li>
</ul>
</section>
<section id="show-all-tables" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Show All Tables</h1>
<p>This section demonstrates how to list all available tables or dataframes in each environment.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">SQL</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Python pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Python Polars</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Show all tables in the connected database.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>SHOW <span class="kw">ALL</span> <span class="kw">TABLES</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>2 records</caption>
<colgroup>
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 3%">
<col style="width: 35%">
<col style="width: 54%">
<col style="width: 2%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">database</th>
<th style="text-align: left;">schema</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">column_names</th>
<th style="text-align: left;">column_types</th>
<th style="text-align: left;">temporary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">my-db</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">iris_table</td>
<td style="text-align: left;">Sepal.Length, Sepal.Width , Petal.Length, Petal.Width , Species</td>
<td style="text-align: left;">DOUBLE , DOUBLE , DOUBLE , DOUBLE , ENUM(‘setosa’, ‘versicolor’, ‘virginica’)</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">my-db</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">mtcars_table</td>
<td style="text-align: left;">model_name, mpg , cyl , disp , hp , drat , wt , qsec , vs , am , gear , carb</td>
<td style="text-align: left;">VARCHAR, DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE</td>
<td style="text-align: left;">FALSE</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List all dataframes in the current R environment.</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>dflist <span class="ot">&lt;-</span> <span class="fu">Filter</span>(is.data.frame, <span class="fu">as.list</span>(.GlobalEnv))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dflist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "mtcars" "iris"  </code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List all pandas dataframes in the current Python environment.</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>alldfs <span class="op">=</span> [var <span class="cf">for</span> var <span class="kw">in</span> <span class="bu">dir</span>() <span class="cf">if</span> <span class="bu">isinstance</span>(<span class="bu">eval</span>(var), pd.core.frame.DataFrame)]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alldfs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>['cities_pd', 'iris_pd', 'mtcars_pd']</code></pre>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>alldfs <span class="op">=</span> [name <span class="cf">for</span> name, val <span class="kw">in</span> <span class="bu">globals</span>().items() <span class="cf">if</span> <span class="bu">isinstance</span>(val, pl.DataFrame)]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alldfs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>['mtcars_pl', 'iris_pl', 'cities_pl']</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="describe-a-table" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Describe a Table</h1>
<p>This section shows how to get a summary of a table’s structure and statistics.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">SQL</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Python pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">Python Polars</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Describe the columns and data types of the mtcars_table.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>DESCRIBE mtcars_table;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<thead>
<tr class="header">
<th style="text-align: left;">column_name</th>
<th style="text-align: left;">column_type</th>
<th style="text-align: left;">null</th>
<th style="text-align: left;">key</th>
<th style="text-align: left;">default</th>
<th style="text-align: left;">extra</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">model_name</td>
<td style="text-align: left;">VARCHAR</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">mpg</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cyl</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">disp</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hp</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">drat</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wt</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">qsec</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">vs</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">am</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Provide a detailed summary of the mtcars dataframe.</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">mtcars</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">12</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">model_name</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 15%">
<col style="width: 10%">
<col style="width: 15%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mpg</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">20.37</td>
<td style="text-align: right;">2.91</td>
<td style="text-align: right;">14.30</td>
<td style="text-align: right;">18.82</td>
<td style="text-align: right;">21.00</td>
<td style="text-align: right;">22.45</td>
<td style="text-align: right;">24.40</td>
<td style="text-align: left;">▂▂▅▇▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">cyl</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5.80</td>
<td style="text-align: right;">1.48</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">4.50</td>
<td style="text-align: right;">6.00</td>
<td style="text-align: right;">6.00</td>
<td style="text-align: right;">8.00</td>
<td style="text-align: left;">▅▁▇▁▃</td>
</tr>
<tr class="odd">
<td style="text-align: left;">disp</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">208.61</td>
<td style="text-align: right;">90.37</td>
<td style="text-align: right;">108.00</td>
<td style="text-align: right;">150.02</td>
<td style="text-align: right;">163.80</td>
<td style="text-align: right;">249.75</td>
<td style="text-align: right;">360.00</td>
<td style="text-align: left;">▇▇▅▁▅</td>
</tr>
<tr class="even">
<td style="text-align: left;">hp</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">122.80</td>
<td style="text-align: right;">51.45</td>
<td style="text-align: right;">62.00</td>
<td style="text-align: right;">97.50</td>
<td style="text-align: right;">110.00</td>
<td style="text-align: right;">119.75</td>
<td style="text-align: right;">245.00</td>
<td style="text-align: left;">▅▇▁▂▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">drat</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.54</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">3.16</td>
<td style="text-align: right;">3.77</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">3.92</td>
<td style="text-align: left;">▁▃▁▁▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">wt</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.13</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">2.32</td>
<td style="text-align: right;">2.94</td>
<td style="text-align: right;">3.20</td>
<td style="text-align: right;">3.44</td>
<td style="text-align: right;">3.57</td>
<td style="text-align: left;">▂▂▂▆▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">qsec</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">18.58</td>
<td style="text-align: right;">2.14</td>
<td style="text-align: right;">15.84</td>
<td style="text-align: right;">17.02</td>
<td style="text-align: right;">18.45</td>
<td style="text-align: right;">19.86</td>
<td style="text-align: right;">22.90</td>
<td style="text-align: left;">▇▃▃▂▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">vs</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▅▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">am</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">gear</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.60</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: left;">▅▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">carb</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.50</td>
<td style="text-align: right;">1.35</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.25</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: left;">▆▆▁▁▇</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate descriptive statistics for the mtcars dataframe.</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd.describe(include<span class="op">=</span><span class="st">'all'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       model_name        mpg       cyl  ...         am       gear       carb
count          10  10.000000  10.00000  ...  10.000000  10.000000  10.000000
unique         10        NaN       NaN  ...        NaN        NaN        NaN
top     Mazda RX4        NaN       NaN  ...        NaN        NaN        NaN
freq            1        NaN       NaN  ...        NaN        NaN        NaN
mean          NaN  20.370000   5.80000  ...   0.300000   3.600000   2.500000
std           NaN   2.907099   1.47573  ...   0.483046   0.516398   1.354006
min           NaN  14.300000   4.00000  ...   0.000000   3.000000   1.000000
25%           NaN  18.825000   4.50000  ...   0.000000   3.000000   1.250000
50%           NaN  21.000000   6.00000  ...   0.000000   4.000000   2.000000
75%           NaN  22.450000   6.00000  ...   0.750000   4.000000   4.000000
max           NaN  24.400000   8.00000  ...   1.000000   4.000000   4.000000

[11 rows x 12 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mtcars_pl.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (9, 13)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">statistic</th>
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">disp</th>
<th data-quarto-table-cell-role="th">hp</th>
<th data-quarto-table-cell-role="th">drat</th>
<th data-quarto-table-cell-role="th">wt</th>
<th data-quarto-table-cell-role="th">qsec</th>
<th data-quarto-table-cell-role="th">vs</th>
<th data-quarto-table-cell-role="th">am</th>
<th data-quarto-table-cell-role="th">gear</th>
<th data-quarto-table-cell-role="th">carb</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"count"</td>
<td>"10"</td>
<td>10.0</td>
<td>10.0</td>
<td>10.0</td>
<td>10.0</td>
<td>10.0</td>
<td>10.0</td>
<td>10.0</td>
<td>10.0</td>
<td>10.0</td>
<td>10.0</td>
<td>10.0</td>
</tr>
<tr class="even">
<td>"null_count"</td>
<td>"0"</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>"mean"</td>
<td>null</td>
<td>20.37</td>
<td>5.8</td>
<td>208.61</td>
<td>122.8</td>
<td>3.538</td>
<td>3.128</td>
<td>18.581</td>
<td>0.6</td>
<td>0.3</td>
<td>3.6</td>
<td>2.5</td>
</tr>
<tr class="even">
<td>"std"</td>
<td>null</td>
<td>2.907099</td>
<td>1.47573</td>
<td>90.373896</td>
<td>51.449652</td>
<td>0.440651</td>
<td>0.40649</td>
<td>2.135845</td>
<td>0.516398</td>
<td>0.483046</td>
<td>0.516398</td>
<td>1.354006</td>
</tr>
<tr class="odd">
<td>"min"</td>
<td>"Datsun 710"</td>
<td>14.3</td>
<td>4.0</td>
<td>108.0</td>
<td>62.0</td>
<td>2.76</td>
<td>2.32</td>
<td>15.84</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>"25%"</td>
<td>null</td>
<td>18.7</td>
<td>4.0</td>
<td>146.7</td>
<td>95.0</td>
<td>3.15</td>
<td>2.875</td>
<td>17.02</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td>"50%"</td>
<td>null</td>
<td>21.0</td>
<td>6.0</td>
<td>167.6</td>
<td>110.0</td>
<td>3.85</td>
<td>3.215</td>
<td>18.61</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>2.0</td>
</tr>
<tr class="even">
<td>"75%"</td>
<td>null</td>
<td>22.8</td>
<td>6.0</td>
<td>258.0</td>
<td>123.0</td>
<td>3.9</td>
<td>3.44</td>
<td>20.0</td>
<td>1.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>"max"</td>
<td>"Valiant"</td>
<td>24.4</td>
<td>8.0</td>
<td>360.0</td>
<td>245.0</td>
<td>3.92</td>
<td>3.57</td>
<td>22.9</td>
<td>1.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="show-column-names" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Show Column Names</h1>
<p>This section demonstrates how to retrieve the column names of a table.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">SQL</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Python pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">Python Polars</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Show information about the columns in mtcars_table.</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>PRAGMA table_info(mtcars_table);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<thead>
<tr class="header">
<th style="text-align: left;">cid</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">notnull</th>
<th style="text-align: left;">dflt_value</th>
<th style="text-align: left;">pk</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">model_name</td>
<td style="text-align: left;">VARCHAR</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">mpg</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">cyl</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">disp</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: left;">hp</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: left;">drat</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: left;">wt</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: left;">qsec</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: left;">vs</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: left;">am</td>
<td style="text-align: left;">DOUBLE</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the names of the columns in the mtcars dataframe.</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "model_name" "mpg"        "cyl"        "disp"       "hp"        
 [6] "drat"       "wt"         "qsec"       "vs"         "am"        
[11] "gear"       "carb"      </code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a list of column names from the mtcars dataframe.</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(mtcars_pd.columns.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>['model_name', 'mpg', 'cyl', 'disp', 'hp', 'drat', 'wt', 'qsec', 'vs', 'am', 'gear', 'carb']</code></pre>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a list of column names from the mtcars dataframe.</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>mtcars_pl.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>['model_name', 'mpg', 'cyl', 'disp', 'hp', 'drat', 'wt', 'qsec', 'vs', 'am', 'gear', 'carb']</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="select" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Select</h1>
<section id="select-top-6-and-rename" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="select-top-6-and-rename"><span class="header-section-number">5.1</span> Select Top 6 and Rename</h2>
<p>This section shows how to select a subset of columns, rename them, and limit the number of rows returned.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">SQL</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Python pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">Python Polars</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Select and rename columns, limiting the result to the top 6 rows.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name <span class="kw">as</span> model, mpg, cyl <span class="kw">FROM</span> mtcars_table <span class="kw">LIMIT</span> <span class="dv">6</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>6 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hornet Sportabout</td>
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Valiant</td>
<td style="text-align: right;">18.1</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select and rename columns from the first 6 rows of the mtcars dataframe.</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars, <span class="dv">6</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="at">model =</span> model_name, mpg, cyl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                              model  mpg cyl
Mazda RX4                 Mazda RX4 21.0   6
Mazda RX4 Wag         Mazda RX4 Wag 21.0   6
Datsun 710               Datsun 710 22.8   4
Hornet 4 Drive       Hornet 4 Drive 21.4   6
Hornet Sportabout Hornet Sportabout 18.7   8
Valiant                     Valiant 18.1   6</code></pre>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename a column in the mtcars dataframe.</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd.rename(columns<span class="op">=</span>{<span class="st">'model_name'</span>: <span class="st">'model'</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                               model   mpg  cyl   disp  ...   vs   am  gear  carb
Mazda RX4                  Mazda RX4  21.0  6.0  160.0  ...  0.0  1.0   4.0   4.0
Mazda RX4 Wag          Mazda RX4 Wag  21.0  6.0  160.0  ...  0.0  1.0   4.0   4.0
Datsun 710                Datsun 710  22.8  4.0  108.0  ...  1.0  1.0   4.0   1.0
Hornet 4 Drive        Hornet 4 Drive  21.4  6.0  258.0  ...  1.0  0.0   3.0   1.0
Hornet Sportabout  Hornet Sportabout  18.7  8.0  360.0  ...  0.0  0.0   3.0   2.0
Valiant                      Valiant  18.1  6.0  225.0  ...  1.0  0.0   3.0   1.0
Duster 360                Duster 360  14.3  8.0  360.0  ...  0.0  0.0   3.0   4.0
Merc 240D                  Merc 240D  24.4  4.0  146.7  ...  1.0  0.0   4.0   2.0
Merc 230                    Merc 230  22.8  4.0  140.8  ...  1.0  0.0   4.0   2.0
Merc 280                    Merc 280  19.2  6.0  167.6  ...  1.0  0.0   4.0   4.0

[10 rows x 12 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>mtcars_pl.select(pl.col(<span class="st">"model_name"</span>).alias(<span class="st">"model"</span>), pl.col(<span class="st">"mpg"</span>), pl.col(<span class="st">"cyl"</span>)).head(<span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (6, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">model</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
</tr>
<tr class="even">
<th>str</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Mazda RX4"</td>
<td>21.0</td>
<td>6.0</td>
</tr>
<tr class="even">
<td>"Mazda RX4 Wag"</td>
<td>21.0</td>
<td>6.0</td>
</tr>
<tr class="odd">
<td>"Datsun 710"</td>
<td>22.8</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>"Hornet 4 Drive"</td>
<td>21.4</td>
<td>6.0</td>
</tr>
<tr class="odd">
<td>"Hornet Sportabout"</td>
<td>18.7</td>
<td>8.0</td>
</tr>
<tr class="even">
<td>"Valiant"</td>
<td>18.1</td>
<td>6.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="select-distinct" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="select-distinct"><span class="header-section-number">5.2</span> Select Distinct</h2>
<p>This section demonstrates how to retrieve unique rows based on specified columns.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">SQL</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Python pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">Python Polars</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Select distinct combinations of mpg and cyl.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span> mpg, cyl <span class="kw">FROM</span> mtcars_table;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>8 records</caption>
<thead>
<tr class="header">
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">18.1</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.3</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">19.2</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get distinct rows based on mpg and cyl.</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">distinct</span>(mpg, cyl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   mpg cyl
Mazda RX4         21.0   6
Datsun 710        22.8   4
Hornet 4 Drive    21.4   6
Hornet Sportabout 18.7   8
Valiant           18.1   6
Duster 360        14.3   8
Merc 240D         24.4   4
Merc 280          19.2   6</code></pre>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select specific columns and drop duplicate rows.</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> mtcars_pd[[<span class="st">"mpg"</span>, <span class="st">"cyl"</span>]]</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.drop_duplicates())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    mpg  cyl
Mazda RX4          21.0  6.0
Datsun 710         22.8  4.0
Hornet 4 Drive     21.4  6.0
Hornet Sportabout  18.7  8.0
Valiant            18.1  6.0
Duster 360         14.3  8.0
Merc 240D          24.4  4.0
Merc 280           19.2  6.0</code></pre>
</div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>mtcars_pl.select(pl.col(<span class="st">"mpg"</span>), pl.col(<span class="st">"cyl"</span>)).unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (8, 2)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
</tr>
<tr class="even">
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>24.4</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>21.0</td>
<td>6.0</td>
</tr>
<tr class="odd">
<td>18.7</td>
<td>8.0</td>
</tr>
<tr class="even">
<td>18.1</td>
<td>6.0</td>
</tr>
<tr class="odd">
<td>21.4</td>
<td>6.0</td>
</tr>
<tr class="even">
<td>19.2</td>
<td>6.0</td>
</tr>
<tr class="odd">
<td>22.8</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>14.3</td>
<td>8.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="check-row-and-column-number" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Check Row and Column Number</h1>
<p>This section shows how to find the dimensions of a table.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">SQL</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">Python pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false">Python Polars</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Get the total number of rows.</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">AS</span> <span class="fu">row_number</span> <span class="kw">FROM</span> mtcars_table;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead>
<tr class="header">
<th style="text-align: right;">row_number</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Get the total number of columns.</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">AS</span> column_number <span class="kw">FROM</span> (DESCRIBE mtcars_table);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead>
<tr class="header">
<th style="text-align: right;">column_number</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">12</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the number of rows.</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the number of columns.</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12</code></pre>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the number of rows.</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd.shape[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>10</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the number of columns.</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd.shape[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>12</code></pre>
</div>
</div>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the number of rows.</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>mtcars_pl.shape[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>10</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the number of columns.</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>mtcars_pl.shape[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>12</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="create-column" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Create Column</h1>
<p>This section demonstrates how to add a new column to a table based on existing data.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">SQL</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">Python pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-4" role="tab" aria-controls="tabset-7-4" aria-selected="false">Python Polars</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Create a new column by performing a calculation on an existing column.</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span>, mpg <span class="op">+</span> <span class="dv">1</span> <span class="kw">AS</span> new_mpg <span class="kw">FROM</span> mtcars_table;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
<th style="text-align: right;">disp</th>
<th style="text-align: right;">hp</th>
<th style="text-align: right;">drat</th>
<th style="text-align: right;">wt</th>
<th style="text-align: right;">qsec</th>
<th style="text-align: right;">vs</th>
<th style="text-align: right;">am</th>
<th style="text-align: right;">gear</th>
<th style="text-align: right;">carb</th>
<th style="text-align: right;">new_mpg</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">2.620</td>
<td style="text-align: right;">16.46</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">22.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">2.875</td>
<td style="text-align: right;">17.02</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">22.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">108.0</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">3.85</td>
<td style="text-align: right;">2.320</td>
<td style="text-align: right;">18.61</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">23.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">258.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">3.215</td>
<td style="text-align: right;">19.44</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">22.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hornet Sportabout</td>
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">360.0</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">3.15</td>
<td style="text-align: right;">3.440</td>
<td style="text-align: right;">17.02</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">19.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Valiant</td>
<td style="text-align: right;">18.1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">225.0</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">3.460</td>
<td style="text-align: right;">20.22</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">19.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Duster 360</td>
<td style="text-align: right;">14.3</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">360.0</td>
<td style="text-align: right;">245</td>
<td style="text-align: right;">3.21</td>
<td style="text-align: right;">3.570</td>
<td style="text-align: right;">15.84</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">15.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Merc 240D</td>
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">146.7</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">3.69</td>
<td style="text-align: right;">3.190</td>
<td style="text-align: right;">20.00</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">25.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Merc 230</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">140.8</td>
<td style="text-align: right;">95</td>
<td style="text-align: right;">3.92</td>
<td style="text-align: right;">3.150</td>
<td style="text-align: right;">22.90</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">23.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Merc 280</td>
<td style="text-align: right;">19.2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">167.6</td>
<td style="text-align: right;">123</td>
<td style="text-align: right;">3.92</td>
<td style="text-align: right;">3.440</td>
<td style="text-align: right;">18.30</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">20.2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new column to the dataframe.</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">new_mpg =</span> mpg <span class="sc">+</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                         model_name  mpg cyl  disp  hp drat    wt  qsec vs am
Mazda RX4                 Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0  1
Mazda RX4 Wag         Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1
Datsun 710               Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1  1
Hornet 4 Drive       Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0
Hornet Sportabout Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0
Valiant                     Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1  0
Duster 360               Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0  0
Merc 240D                 Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1  0
Merc 230                   Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1  0
Merc 280                   Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1  0
                  gear carb new_mpg
Mazda RX4            4    4    22.0
Mazda RX4 Wag        4    4    22.0
Datsun 710           4    1    23.8
Hornet 4 Drive       3    1    22.4
Hornet Sportabout    3    2    19.7
Valiant              3    1    19.1
Duster 360           3    4    15.3
Merc 240D            4    2    25.4
Merc 230             4    2    23.8
Merc 280             4    4    20.2</code></pre>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column in the dataframe.</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd[<span class="st">"new_mpg"</span>] <span class="op">=</span> mtcars_pd[<span class="st">"mpg"</span>] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>mtcars_pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                          model_name   mpg  cyl  ...  gear  carb  new_mpg
Mazda RX4                  Mazda RX4  21.0  6.0  ...   4.0   4.0     22.0
Mazda RX4 Wag          Mazda RX4 Wag  21.0  6.0  ...   4.0   4.0     22.0
Datsun 710                Datsun 710  22.8  4.0  ...   4.0   1.0     23.8
Hornet 4 Drive        Hornet 4 Drive  21.4  6.0  ...   3.0   1.0     22.4
Hornet Sportabout  Hornet Sportabout  18.7  8.0  ...   3.0   2.0     19.7
Valiant                      Valiant  18.1  6.0  ...   3.0   1.0     19.1
Duster 360                Duster 360  14.3  8.0  ...   3.0   4.0     15.3
Merc 240D                  Merc 240D  24.4  4.0  ...   4.0   2.0     25.4
Merc 230                    Merc 230  22.8  4.0  ...   4.0   2.0     23.8
Merc 280                    Merc 280  19.2  6.0  ...   4.0   4.0     20.2

[10 rows x 13 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-7-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>mtcars_pl.with_columns((pl.col(<span class="st">"mpg"</span>) <span class="op">+</span> <span class="dv">1</span>).alias(<span class="st">"new_mpg"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (10, 13)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">disp</th>
<th data-quarto-table-cell-role="th">hp</th>
<th data-quarto-table-cell-role="th">drat</th>
<th data-quarto-table-cell-role="th">wt</th>
<th data-quarto-table-cell-role="th">qsec</th>
<th data-quarto-table-cell-role="th">vs</th>
<th data-quarto-table-cell-role="th">am</th>
<th data-quarto-table-cell-role="th">gear</th>
<th data-quarto-table-cell-role="th">carb</th>
<th data-quarto-table-cell-role="th">new_mpg</th>
</tr>
<tr class="even">
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Mazda RX4"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.62</td>
<td>16.46</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
<td>22.0</td>
</tr>
<tr class="even">
<td>"Mazda RX4 Wag"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.875</td>
<td>17.02</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
<td>22.0</td>
</tr>
<tr class="odd">
<td>"Datsun 710"</td>
<td>22.8</td>
<td>4.0</td>
<td>108.0</td>
<td>93.0</td>
<td>3.85</td>
<td>2.32</td>
<td>18.61</td>
<td>1.0</td>
<td>1.0</td>
<td>4.0</td>
<td>1.0</td>
<td>23.8</td>
</tr>
<tr class="even">
<td>"Hornet 4 Drive"</td>
<td>21.4</td>
<td>6.0</td>
<td>258.0</td>
<td>110.0</td>
<td>3.08</td>
<td>3.215</td>
<td>19.44</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
<td>22.4</td>
</tr>
<tr class="odd">
<td>"Hornet Sportabout"</td>
<td>18.7</td>
<td>8.0</td>
<td>360.0</td>
<td>175.0</td>
<td>3.15</td>
<td>3.44</td>
<td>17.02</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>2.0</td>
<td>19.7</td>
</tr>
<tr class="even">
<td>"Valiant"</td>
<td>18.1</td>
<td>6.0</td>
<td>225.0</td>
<td>105.0</td>
<td>2.76</td>
<td>3.46</td>
<td>20.22</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
<td>19.1</td>
</tr>
<tr class="odd">
<td>"Duster 360"</td>
<td>14.3</td>
<td>8.0</td>
<td>360.0</td>
<td>245.0</td>
<td>3.21</td>
<td>3.57</td>
<td>15.84</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>4.0</td>
<td>15.3</td>
</tr>
<tr class="even">
<td>"Merc 240D"</td>
<td>24.4</td>
<td>4.0</td>
<td>146.7</td>
<td>62.0</td>
<td>3.69</td>
<td>3.19</td>
<td>20.0</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>2.0</td>
<td>25.4</td>
</tr>
<tr class="odd">
<td>"Merc 230"</td>
<td>22.8</td>
<td>4.0</td>
<td>140.8</td>
<td>95.0</td>
<td>3.92</td>
<td>3.15</td>
<td>22.9</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>2.0</td>
<td>23.8</td>
</tr>
<tr class="even">
<td>"Merc 280"</td>
<td>19.2</td>
<td>6.0</td>
<td>167.6</td>
<td>123.0</td>
<td>3.92</td>
<td>3.44</td>
<td>18.3</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>4.0</td>
<td>20.2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="filter" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Filter</h1>
<p>This section shows how to select rows that meet specific criteria.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">SQL</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">Python pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-4" role="tab" aria-controls="tabset-8-4" aria-selected="false">Python Polars</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Use the AND operator to filter rows based on multiple conditions.</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> mpg <span class="op">=</span> <span class="dv">21</span> <span class="kw">AND</span> cyl <span class="op">=</span> <span class="dv">6</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>2 records</caption>
<colgroup>
<col style="width: 21%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
<th style="text-align: right;">disp</th>
<th style="text-align: right;">hp</th>
<th style="text-align: right;">drat</th>
<th style="text-align: right;">wt</th>
<th style="text-align: right;">qsec</th>
<th style="text-align: right;">vs</th>
<th style="text-align: right;">am</th>
<th style="text-align: right;">gear</th>
<th style="text-align: right;">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">2.620</td>
<td style="text-align: right;">16.46</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">2.875</td>
<td style="text-align: right;">17.02</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Use the OR operator to filter rows.</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> mpg <span class="op">=</span> <span class="dv">21</span> <span class="kw">OR</span> cyl <span class="op">=</span> <span class="dv">6</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>5 records</caption>
<colgroup>
<col style="width: 22%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
<th style="text-align: right;">disp</th>
<th style="text-align: right;">hp</th>
<th style="text-align: right;">drat</th>
<th style="text-align: right;">wt</th>
<th style="text-align: right;">qsec</th>
<th style="text-align: right;">vs</th>
<th style="text-align: right;">am</th>
<th style="text-align: right;">gear</th>
<th style="text-align: right;">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">2.620</td>
<td style="text-align: right;">16.46</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">2.875</td>
<td style="text-align: right;">17.02</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">258.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">3.215</td>
<td style="text-align: right;">19.44</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Valiant</td>
<td style="text-align: right;">18.1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">225.0</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">3.460</td>
<td style="text-align: right;">20.22</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Merc 280</td>
<td style="text-align: right;">19.2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">167.6</td>
<td style="text-align: right;">123</td>
<td style="text-align: right;">3.92</td>
<td style="text-align: right;">3.440</td>
<td style="text-align: right;">18.30</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the &amp; operator for "and" filtering.</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(mpg <span class="sc">==</span> <span class="dv">21</span> <span class="sc">&amp;</span> cyl <span class="sc">==</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 model_name mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         Mazda RX4  21   6  160 110  3.9 2.620 16.46  0  1    4    4
Mazda RX4 Wag Mazda RX4 Wag  21   6  160 110  3.9 2.875 17.02  0  1    4    4</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the | operator for "or" filtering.</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(mpg <span class="sc">==</span> <span class="dv">21</span> <span class="sc">|</span> cyl <span class="sc">==</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   model_name  mpg cyl  disp  hp drat    wt  qsec vs am gear
Mazda RX4           Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0  1    4
Mazda RX4 Wag   Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1    4
Hornet 4 Drive Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0    3
Valiant               Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1  0    3
Merc 280             Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1  0    4
               carb
Mazda RX4         4
Mazda RX4 Wag     4
Hornet 4 Drive    1
Valiant           1
Merc 280          4</code></pre>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the query method for "and" filtering.</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd.query(<span class="st">'mpg == 21 and cyl == 6'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                  model_name   mpg  cyl   disp  ...   am  gear  carb  new_mpg
Mazda RX4          Mazda RX4  21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0
Mazda RX4 Wag  Mazda RX4 Wag  21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0

[2 rows x 13 columns]</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the query method for "or" filtering.</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd.query(<span class="st">'mpg == 21 or cyl == 6'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    model_name   mpg  cyl   disp  ...   am  gear  carb  new_mpg
Mazda RX4            Mazda RX4  21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0
Mazda RX4 Wag    Mazda RX4 Wag  21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0
Hornet 4 Drive  Hornet 4 Drive  21.4  6.0  258.0  ...  0.0   3.0   1.0     22.4
Valiant                Valiant  18.1  6.0  225.0  ...  0.0   3.0   1.0     19.1
Merc 280              Merc 280  19.2  6.0  167.6  ...  0.0   4.0   4.0     20.2

[5 rows x 13 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-8-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># "and" filtering with polars</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>mtcars_pl.<span class="bu">filter</span>((pl.col(<span class="st">"mpg"</span>) <span class="op">==</span> <span class="dv">21</span>) <span class="op">&amp;</span> (pl.col(<span class="st">"cyl"</span>) <span class="op">==</span> <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (2, 12)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">disp</th>
<th data-quarto-table-cell-role="th">hp</th>
<th data-quarto-table-cell-role="th">drat</th>
<th data-quarto-table-cell-role="th">wt</th>
<th data-quarto-table-cell-role="th">qsec</th>
<th data-quarto-table-cell-role="th">vs</th>
<th data-quarto-table-cell-role="th">am</th>
<th data-quarto-table-cell-role="th">gear</th>
<th data-quarto-table-cell-role="th">carb</th>
</tr>
<tr class="even">
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Mazda RX4"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.62</td>
<td>16.46</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>"Mazda RX4 Wag"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.875</td>
<td>17.02</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># "or" filtering with polars</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>mtcars_pl.<span class="bu">filter</span>((pl.col(<span class="st">"mpg"</span>) <span class="op">==</span> <span class="dv">21</span>) <span class="op">|</span> (pl.col(<span class="st">"cyl"</span>) <span class="op">==</span> <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 12)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">disp</th>
<th data-quarto-table-cell-role="th">hp</th>
<th data-quarto-table-cell-role="th">drat</th>
<th data-quarto-table-cell-role="th">wt</th>
<th data-quarto-table-cell-role="th">qsec</th>
<th data-quarto-table-cell-role="th">vs</th>
<th data-quarto-table-cell-role="th">am</th>
<th data-quarto-table-cell-role="th">gear</th>
<th data-quarto-table-cell-role="th">carb</th>
</tr>
<tr class="even">
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Mazda RX4"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.62</td>
<td>16.46</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>"Mazda RX4 Wag"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.875</td>
<td>17.02</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>"Hornet 4 Drive"</td>
<td>21.4</td>
<td>6.0</td>
<td>258.0</td>
<td>110.0</td>
<td>3.08</td>
<td>3.215</td>
<td>19.44</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>"Valiant"</td>
<td>18.1</td>
<td>6.0</td>
<td>225.0</td>
<td>105.0</td>
<td>2.76</td>
<td>3.46</td>
<td>20.22</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td>"Merc 280"</td>
<td>19.2</td>
<td>6.0</td>
<td>167.6</td>
<td>123.0</td>
<td>3.92</td>
<td>3.44</td>
<td>18.3</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="order" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Order</h1>
<p>This section demonstrates how to sort a table based on one or more columns.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">SQL</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">Python pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-4" role="tab" aria-controls="tabset-9-4" aria-selected="false">Python Polars</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Order the results by mpg in descending order and show the top 3.</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name <span class="kw">AS</span> model, mpg, cyl <span class="kw">FROM</span> mtcars_table <span class="kw">ORDER</span> <span class="kw">BY</span> mpg <span class="kw">DESC</span> <span class="kw">LIMIT</span> <span class="dv">3</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>3 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Merc 240D</td>
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Merc 230</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange the dataframe by mpg in descending order.</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="at">model =</span> model_name, mpg, cyl) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(mpg)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                model  mpg cyl
Merc 240D   Merc 240D 24.4   4
Datsun 710 Datsun 710 22.8   4
Merc 230     Merc 230 22.8   4</code></pre>
</div>
</div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort the dataframe by mpg in descending order.</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd[[<span class="st">"model_name"</span>, <span class="st">"mpg"</span>, <span class="st">"cyl"</span>]].sort_values(by<span class="op">=</span><span class="st">'mpg'</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            model_name   mpg  cyl
Merc 240D    Merc 240D  24.4  4.0
Datsun 710  Datsun 710  22.8  4.0
Merc 230      Merc 230  22.8  4.0</code></pre>
</div>
</div>
</div>
<div id="tabset-9-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>mtcars_pl.select(<span class="st">"model_name"</span>, <span class="st">"mpg"</span>, <span class="st">"cyl"</span>).sort(<span class="st">"mpg"</span>, descending<span class="op">=</span><span class="va">True</span>).head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (3, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
</tr>
<tr class="even">
<th>str</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Merc 240D"</td>
<td>24.4</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>"Datsun 710"</td>
<td>22.8</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>"Merc 230"</td>
<td>22.8</td>
<td>4.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="group-by" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Group By</h1>
<p>This section shows how to group rows and perform aggregate calculations.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">SQL</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false">Python pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-4" role="tab" aria-controls="tabset-10-4" aria-selected="false">Python Polars</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Group by model_name and calculate the sum of mpg and the mean of cyl.</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, <span class="fu">sum</span>(mpg) <span class="kw">AS</span> total_mpg, mean(cyl) <span class="kw">AS</span> cyl_mean <span class="kw">FROM</span> mtcars_table</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> <span class="dv">1</span> <span class="kw">LIMIT</span> <span class="dv">5</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>5 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">total_mpg</th>
<th style="text-align: right;">cyl_mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Duster 360</td>
<td style="text-align: right;">14.3</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Merc 230</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by model_name and summarize the data.</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">group_by</span>(model_name) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="at">total_mpg =</span> <span class="fu">sum</span>(mpg), <span class="at">cyl_mean =</span> <span class="fu">mean</span>(cyl)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  model_name        total_mpg cyl_mean
  &lt;chr&gt;                 &lt;dbl&gt;    &lt;dbl&gt;
1 Datsun 710             22.8        4
2 Duster 360             14.3        8
3 Hornet 4 Drive         21.4        6
4 Hornet Sportabout      18.7        8
5 Mazda RX4              21          6</code></pre>
</div>
</div>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by model_name and aggregate the data.</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd.groupby(<span class="st">'model_name'</span>).agg({<span class="st">'mpg'</span>: <span class="st">'sum'</span>, <span class="st">'cyl'</span>: <span class="st">'mean'</span>}).head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    mpg  cyl
model_name                  
Datsun 710         22.8  4.0
Duster 360         14.3  8.0
Hornet 4 Drive     21.4  6.0
Hornet Sportabout  18.7  8.0
Mazda RX4          21.0  6.0</code></pre>
</div>
</div>
</div>
<div id="tabset-10-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>mtcars_pl.group_by(<span class="st">"model_name"</span>).agg([</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>    pl.<span class="bu">sum</span>(<span class="st">"mpg"</span>).alias(<span class="st">"total_mpg"</span>),</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    pl.mean(<span class="st">"cyl"</span>).alias(<span class="st">"cyl_mean"</span>)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>]).head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">total_mpg</th>
<th data-quarto-table-cell-role="th">cyl_mean</th>
</tr>
<tr class="even">
<th>str</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Valiant"</td>
<td>18.1</td>
<td>6.0</td>
</tr>
<tr class="even">
<td>"Mazda RX4 Wag"</td>
<td>21.0</td>
<td>6.0</td>
</tr>
<tr class="odd">
<td>"Mazda RX4"</td>
<td>21.0</td>
<td>6.0</td>
</tr>
<tr class="even">
<td>"Merc 280"</td>
<td>19.2</td>
<td>6.0</td>
</tr>
<tr class="odd">
<td>"Merc 230"</td>
<td>22.8</td>
<td>4.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="create-table" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Create Table</h1>
<section id="create-or-replace" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="create-or-replace"><span class="header-section-number">11.1</span> CREATE OR REPLACE</h2>
<p>This command creates a new table or overwrites an existing one.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Create a temporary table, replacing it if it already exists.</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">OR</span> <span class="kw">REPLACE</span> TEMP <span class="kw">TABLE</span> mtcars_table_group <span class="kw">AS</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, <span class="fu">sum</span>(mpg) <span class="kw">AS</span> total_mpg, mean(cyl) <span class="kw">AS</span> cyl_mean <span class="kw">FROM</span> mtcars_table</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> <span class="dv">1</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="create-table-if-not-exists" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="create-table-if-not-exists"><span class="header-section-number">11.2</span> CREATE TABLE IF NOT EXISTS</h2>
<p>This command creates a table only if it does not already exist.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Create a new table only if it does not already exist.</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">NOT</span> <span class="kw">EXISTS</span> new_mtcars_table_group <span class="kw">AS</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, <span class="fu">sum</span>(mpg) <span class="kw">AS</span> total_mpg, mean(cyl) <span class="kw">AS</span> cyl_mean <span class="kw">FROM</span> mtcars_table</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> <span class="dv">1</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="unique" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Unique</h1>
<section id="check-unique" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="check-unique"><span class="header-section-number">12.1</span> Check Unique</h2>
<p>This section demonstrates how to verify the uniqueness of values in a column.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">SQL</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Python pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false">Python Polars</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Count the total number of rows and the number of distinct model names.</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>), <span class="fu">count</span>(<span class="kw">DISTINCT</span> model_name) <span class="kw">FROM</span> mtcars_table;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead>
<tr class="header">
<th style="text-align: right;">count_star()</th>
<th style="text-align: right;">count(DISTINCT model_name)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the total number of rows and the number of distinct model names.</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(mtcars_pd), mtcars_pd.model_name.nunique())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>10 10</code></pre>
</div>
</div>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the total number of rows and the number of distinct model names.</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>mtcars_pl.select(pl.count(), pl.col(<span class="st">"model_name"</span>).n_unique())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1, 2)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">model_name</th>
</tr>
<tr class="even">
<th>u32</th>
<th>u32</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10</td>
<td>10</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="get-duplicate-and-non-duplicate-data" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="get-duplicate-and-non-duplicate-data"><span class="header-section-number">12.2</span> Get Duplicate and Non-Duplicate Data</h2>
<p>This section demonstrates how to get duplicate and non-duplicate data based on a single column.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">SQL</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false">Python pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-4" role="tab" aria-controls="tabset-12-4" aria-selected="false">Python Polars</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<section id="show-all-duplicate" class="level4" data-number="12.2.0.1">
<h4 data-number="12.2.0.1" class="anchored" data-anchor-id="show-all-duplicate"><span class="header-section-number">12.2.0.1</span> Show all Duplicate</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Get duplicate rows based on the mpg column.</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> mpg <span class="kw">IN</span> (<span class="kw">SELECT</span> mpg <span class="kw">FROM</span> mtcars_table <span class="kw">GROUP</span> <span class="kw">BY</span> mpg <span class="kw">HAVING</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="op">&gt;</span> <span class="dv">1</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>4 records</caption>
<colgroup>
<col style="width: 21%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
<th style="text-align: right;">disp</th>
<th style="text-align: right;">hp</th>
<th style="text-align: right;">drat</th>
<th style="text-align: right;">wt</th>
<th style="text-align: right;">qsec</th>
<th style="text-align: right;">vs</th>
<th style="text-align: right;">am</th>
<th style="text-align: right;">gear</th>
<th style="text-align: right;">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">2.620</td>
<td style="text-align: right;">16.46</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">2.875</td>
<td style="text-align: right;">17.02</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">108.0</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">3.85</td>
<td style="text-align: right;">2.320</td>
<td style="text-align: right;">18.61</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Merc 230</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">140.8</td>
<td style="text-align: right;">95</td>
<td style="text-align: right;">3.92</td>
<td style="text-align: right;">3.150</td>
<td style="text-align: right;">22.90</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>keep non Duplicate</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Get non-duplicate rows based on the mpg column.</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> mpg <span class="kw">IN</span> (<span class="kw">SELECT</span> mpg <span class="kw">FROM</span> mtcars_table <span class="kw">GROUP</span> <span class="kw">BY</span> mpg <span class="kw">HAVING</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="op">=</span> <span class="dv">1</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>6 records</caption>
<colgroup>
<col style="width: 25%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
<th style="text-align: right;">disp</th>
<th style="text-align: right;">hp</th>
<th style="text-align: right;">drat</th>
<th style="text-align: right;">wt</th>
<th style="text-align: right;">qsec</th>
<th style="text-align: right;">vs</th>
<th style="text-align: right;">am</th>
<th style="text-align: right;">gear</th>
<th style="text-align: right;">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">258.0</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">3.215</td>
<td style="text-align: right;">19.44</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hornet Sportabout</td>
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">360.0</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">3.15</td>
<td style="text-align: right;">3.440</td>
<td style="text-align: right;">17.02</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Valiant</td>
<td style="text-align: right;">18.1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">225.0</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">3.460</td>
<td style="text-align: right;">20.22</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Duster 360</td>
<td style="text-align: right;">14.3</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">360.0</td>
<td style="text-align: right;">245</td>
<td style="text-align: right;">3.21</td>
<td style="text-align: right;">3.570</td>
<td style="text-align: right;">15.84</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Merc 240D</td>
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">146.7</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">3.69</td>
<td style="text-align: right;">3.190</td>
<td style="text-align: right;">20.00</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Merc 280</td>
<td style="text-align: right;">19.2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">167.6</td>
<td style="text-align: right;">123</td>
<td style="text-align: right;">3.92</td>
<td style="text-align: right;">3.440</td>
<td style="text-align: right;">18.30</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<section id="show-all-duplicate-1" class="level4" data-number="12.2.0.2">
<h4 data-number="12.2.0.2" class="anchored" data-anchor-id="show-all-duplicate-1"><span class="header-section-number">12.2.0.2</span> Show all Duplicate</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get duplicate rows based on the mpg column.</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">duplicated</span>(mpg) <span class="sc">|</span> <span class="fu">duplicated</span>(mpg, <span class="at">fromLast =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 model_name  mpg cyl  disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
Datsun 710       Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
Merc 230           Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2</code></pre>
</div>
</div>
</section>
<section id="keep-non-duplicate" class="level4" data-number="12.2.0.3">
<h4 data-number="12.2.0.3" class="anchored" data-anchor-id="keep-non-duplicate"><span class="header-section-number">12.2.0.3</span> keep non Duplicate</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get non-duplicate rows based on the mpg column.</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">duplicated</span>(mpg) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">duplicated</span>(mpg, <span class="at">fromLast =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                         model_name  mpg cyl  disp  hp drat    wt  qsec vs am
Hornet 4 Drive       Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0
Hornet Sportabout Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0
Valiant                     Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1  0
Duster 360               Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0  0
Merc 240D                 Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1  0
Merc 280                   Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1  0
                  gear carb
Hornet 4 Drive       3    1
Hornet Sportabout    3    2
Valiant              3    1
Duster 360           3    4
Merc 240D            4    2
Merc 280             4    4</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<section id="show-all-duplicate-2" class="level4" data-number="12.2.0.4">
<h4 data-number="12.2.0.4" class="anchored" data-anchor-id="show-all-duplicate-2"><span class="header-section-number">12.2.0.4</span> Show all Duplicate</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get duplicate rows based on the mpg column.</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd[mtcars_pd.duplicated(subset<span class="op">=</span>[<span class="st">'mpg'</span>], keep<span class="op">=</span><span class="va">False</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                  model_name   mpg  cyl   disp  ...   am  gear  carb  new_mpg
Mazda RX4          Mazda RX4  21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0
Mazda RX4 Wag  Mazda RX4 Wag  21.0  6.0  160.0  ...  1.0   4.0   4.0     22.0
Datsun 710        Datsun 710  22.8  4.0  108.0  ...  1.0   4.0   1.0     23.8
Merc 230            Merc 230  22.8  4.0  140.8  ...  0.0   4.0   2.0     23.8

[4 rows x 13 columns]</code></pre>
</div>
</div>
</section>
<section id="keep-non-duplicate-1" class="level4" data-number="12.2.0.5">
<h4 data-number="12.2.0.5" class="anchored" data-anchor-id="keep-non-duplicate-1"><span class="header-section-number">12.2.0.5</span> keep non Duplicate</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get non-duplicate rows based on the mpg column.</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd[<span class="op">~</span>mtcars_pd.duplicated(subset<span class="op">=</span>[<span class="st">'mpg'</span>], keep<span class="op">=</span><span class="va">False</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                          model_name   mpg  cyl  ...  gear  carb  new_mpg
Hornet 4 Drive        Hornet 4 Drive  21.4  6.0  ...   3.0   1.0     22.4
Hornet Sportabout  Hornet Sportabout  18.7  8.0  ...   3.0   2.0     19.7
Valiant                      Valiant  18.1  6.0  ...   3.0   1.0     19.1
Duster 360                Duster 360  14.3  8.0  ...   3.0   4.0     15.3
Merc 240D                  Merc 240D  24.4  4.0  ...   4.0   2.0     25.4
Merc 280                    Merc 280  19.2  6.0  ...   4.0   4.0     20.2

[6 rows x 13 columns]</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-12-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get duplicate rows based on the mpg column.</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>mtcars_pl.<span class="bu">filter</span>(pl.col(<span class="st">"mpg"</span>).is_duplicated())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (4, 12)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">disp</th>
<th data-quarto-table-cell-role="th">hp</th>
<th data-quarto-table-cell-role="th">drat</th>
<th data-quarto-table-cell-role="th">wt</th>
<th data-quarto-table-cell-role="th">qsec</th>
<th data-quarto-table-cell-role="th">vs</th>
<th data-quarto-table-cell-role="th">am</th>
<th data-quarto-table-cell-role="th">gear</th>
<th data-quarto-table-cell-role="th">carb</th>
</tr>
<tr class="even">
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Mazda RX4"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.62</td>
<td>16.46</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>"Mazda RX4 Wag"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.875</td>
<td>17.02</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>"Datsun 710"</td>
<td>22.8</td>
<td>4.0</td>
<td>108.0</td>
<td>93.0</td>
<td>3.85</td>
<td>2.32</td>
<td>18.61</td>
<td>1.0</td>
<td>1.0</td>
<td>4.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>"Merc 230"</td>
<td>22.8</td>
<td>4.0</td>
<td>140.8</td>
<td>95.0</td>
<td>3.92</td>
<td>3.15</td>
<td>22.9</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>2.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<section id="keep-non-duplicate-2" class="level4" data-number="12.2.0.6">
<h4 data-number="12.2.0.6" class="anchored" data-anchor-id="keep-non-duplicate-2"><span class="header-section-number">12.2.0.6</span> keep non Duplicate</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get non-duplicate rows based on the mpg column.</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>mtcars_pl.<span class="bu">filter</span>(pl.col(<span class="st">"mpg"</span>).is_unique())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (6, 12)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">disp</th>
<th data-quarto-table-cell-role="th">hp</th>
<th data-quarto-table-cell-role="th">drat</th>
<th data-quarto-table-cell-role="th">wt</th>
<th data-quarto-table-cell-role="th">qsec</th>
<th data-quarto-table-cell-role="th">vs</th>
<th data-quarto-table-cell-role="th">am</th>
<th data-quarto-table-cell-role="th">gear</th>
<th data-quarto-table-cell-role="th">carb</th>
</tr>
<tr class="even">
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Hornet 4 Drive"</td>
<td>21.4</td>
<td>6.0</td>
<td>258.0</td>
<td>110.0</td>
<td>3.08</td>
<td>3.215</td>
<td>19.44</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>"Hornet Sportabout"</td>
<td>18.7</td>
<td>8.0</td>
<td>360.0</td>
<td>175.0</td>
<td>3.15</td>
<td>3.44</td>
<td>17.02</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td>"Valiant"</td>
<td>18.1</td>
<td>6.0</td>
<td>225.0</td>
<td>105.0</td>
<td>2.76</td>
<td>3.46</td>
<td>20.22</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>"Duster 360"</td>
<td>14.3</td>
<td>8.0</td>
<td>360.0</td>
<td>245.0</td>
<td>3.21</td>
<td>3.57</td>
<td>15.84</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>"Merc 240D"</td>
<td>24.4</td>
<td>4.0</td>
<td>146.7</td>
<td>62.0</td>
<td>3.69</td>
<td>3.19</td>
<td>20.0</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>2.0</td>
</tr>
<tr class="even">
<td>"Merc 280"</td>
<td>19.2</td>
<td>6.0</td>
<td>167.6</td>
<td>123.0</td>
<td>3.92</td>
<td>3.44</td>
<td>18.3</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</div>
</div>
</div>
</section>
</section>
<section id="join" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Join</h1>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Select all data from the newly created temporary table.</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table_group t1;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<thead>
<tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">total_mpg</th>
<th style="text-align: right;">cyl_mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Duster 360</td>
<td style="text-align: right;">14.3</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Merc 230</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Merc 240D</td>
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hornet Sportabout</td>
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Valiant</td>
<td style="text-align: right;">18.1</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Merc 280</td>
<td style="text-align: right;">19.2</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="left-join" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="left-join"><span class="header-section-number">13.1</span> Left Join</h2>
<p>This section shows how to perform a left join to combine data from two tables.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">SQL</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false">Python pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-4" role="tab" aria-controls="tabset-13-4" aria-selected="false">Python Polars</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Perform a left join between mtcars_table and mtcars_table_group.</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t1.model_name, t1.mpg, t1.cyl, t2.<span class="op">*</span> <span class="kw">FROM</span> mtcars_table t1</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> mtcars_table_group t2 <span class="kw">ON</span> t1.model_name <span class="op">=</span> t2.model_name</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">5</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>5 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">total_mpg</th>
<th style="text-align: right;">cyl_mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hornet Sportabout</td>
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">Hornet Sportabout</td>
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">8</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a left join on the mtcars dataframe with itself.</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">left_join</span>(mtcars, <span class="at">by =</span> <span class="fu">join_by</span>(model_name <span class="sc">==</span> model_name)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         model_name mpg.x cyl.x disp.x hp.x drat.x  wt.x qsec.x vs.x am.x
1         Mazda RX4  21.0     6    160  110   3.90 2.620  16.46    0    1
2     Mazda RX4 Wag  21.0     6    160  110   3.90 2.875  17.02    0    1
3        Datsun 710  22.8     4    108   93   3.85 2.320  18.61    1    1
4    Hornet 4 Drive  21.4     6    258  110   3.08 3.215  19.44    1    0
5 Hornet Sportabout  18.7     8    360  175   3.15 3.440  17.02    0    0
  gear.x carb.x mpg.y cyl.y disp.y hp.y drat.y  wt.y qsec.y vs.y am.y gear.y
1      4      4  21.0     6    160  110   3.90 2.620  16.46    0    1      4
2      4      4  21.0     6    160  110   3.90 2.875  17.02    0    1      4
3      4      1  22.8     4    108   93   3.85 2.320  18.61    1    1      4
4      3      1  21.4     6    258  110   3.08 3.215  19.44    1    0      3
5      3      2  18.7     8    360  175   3.15 3.440  17.02    0    0      3
  carb.y
1      4
2      4
3      1
4      1
5      2</code></pre>
</div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a left join using pandas.</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>pd.merge(mtcars_pd, mtcars_pd, left_on<span class="op">=</span><span class="st">'model_name'</span>, right_on<span class="op">=</span><span class="st">'model_name'</span>, how<span class="op">=</span><span class="st">'left'</span>).head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          model_name  mpg_x  cyl_x  disp_x  ...  am_y  gear_y  carb_y  new_mpg_y
0          Mazda RX4   21.0    6.0   160.0  ...   1.0     4.0     4.0       22.0
1      Mazda RX4 Wag   21.0    6.0   160.0  ...   1.0     4.0     4.0       22.0
2         Datsun 710   22.8    4.0   108.0  ...   1.0     4.0     1.0       23.8
3     Hornet 4 Drive   21.4    6.0   258.0  ...   0.0     3.0     1.0       22.4
4  Hornet Sportabout   18.7    8.0   360.0  ...   0.0     3.0     2.0       19.7

[5 rows x 25 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-13-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>mtcars_pl.join(mtcars_pl, on<span class="op">=</span><span class="st">"model_name"</span>, how<span class="op">=</span><span class="st">"left"</span>).head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 23)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">disp</th>
<th data-quarto-table-cell-role="th">hp</th>
<th data-quarto-table-cell-role="th">drat</th>
<th data-quarto-table-cell-role="th">wt</th>
<th data-quarto-table-cell-role="th">qsec</th>
<th data-quarto-table-cell-role="th">vs</th>
<th data-quarto-table-cell-role="th">am</th>
<th data-quarto-table-cell-role="th">gear</th>
<th data-quarto-table-cell-role="th">carb</th>
<th data-quarto-table-cell-role="th">mpg_right</th>
<th data-quarto-table-cell-role="th">cyl_right</th>
<th data-quarto-table-cell-role="th">disp_right</th>
<th data-quarto-table-cell-role="th">hp_right</th>
<th data-quarto-table-cell-role="th">drat_right</th>
<th data-quarto-table-cell-role="th">wt_right</th>
<th data-quarto-table-cell-role="th">qsec_right</th>
<th data-quarto-table-cell-role="th">vs_right</th>
<th data-quarto-table-cell-role="th">am_right</th>
<th data-quarto-table-cell-role="th">gear_right</th>
<th data-quarto-table-cell-role="th">carb_right</th>
</tr>
<tr class="even">
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Mazda RX4"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.62</td>
<td>16.46</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.62</td>
<td>16.46</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>"Mazda RX4 Wag"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.875</td>
<td>17.02</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.875</td>
<td>17.02</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>"Datsun 710"</td>
<td>22.8</td>
<td>4.0</td>
<td>108.0</td>
<td>93.0</td>
<td>3.85</td>
<td>2.32</td>
<td>18.61</td>
<td>1.0</td>
<td>1.0</td>
<td>4.0</td>
<td>1.0</td>
<td>22.8</td>
<td>4.0</td>
<td>108.0</td>
<td>93.0</td>
<td>3.85</td>
<td>2.32</td>
<td>18.61</td>
<td>1.0</td>
<td>1.0</td>
<td>4.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>"Hornet 4 Drive"</td>
<td>21.4</td>
<td>6.0</td>
<td>258.0</td>
<td>110.0</td>
<td>3.08</td>
<td>3.215</td>
<td>19.44</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
<td>21.4</td>
<td>6.0</td>
<td>258.0</td>
<td>110.0</td>
<td>3.08</td>
<td>3.215</td>
<td>19.44</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td>"Hornet Sportabout"</td>
<td>18.7</td>
<td>8.0</td>
<td>360.0</td>
<td>175.0</td>
<td>3.15</td>
<td>3.44</td>
<td>17.02</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>2.0</td>
<td>18.7</td>
<td>8.0</td>
<td>360.0</td>
<td>175.0</td>
<td>3.15</td>
<td>3.44</td>
<td>17.02</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>2.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="inner-join" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="inner-join"><span class="header-section-number">13.2</span> Inner Join</h2>
<p>This section demonstrates how to perform an inner join.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">SQL</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false">Python pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-4" role="tab" aria-controls="tabset-14-4" aria-selected="false">Python Polars</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Perform an inner join with a subquery.</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t1.model_name, t1.mpg, t1.cyl, t2.<span class="op">*</span> <span class="kw">FROM</span> mtcars_table t1</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> (<span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table_group <span class="kw">LIMIT</span> <span class="dv">5</span>) t2 <span class="kw">ON</span> t1.model_name <span class="op">=</span> t2.model_name;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>5 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">total_mpg</th>
<th style="text-align: right;">cyl_mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Duster 360</td>
<td style="text-align: right;">14.3</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">Duster 360</td>
<td style="text-align: right;">14.3</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Merc 240D</td>
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Merc 240D</td>
<td style="text-align: right;">24.4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Merc 230</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Merc 230</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform an inner join.</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">inner_join</span>(mtcars, <span class="at">by =</span> <span class="fu">join_by</span>(model_name <span class="sc">==</span> model_name)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         model_name mpg.x cyl.x disp.x hp.x drat.x  wt.x qsec.x vs.x am.x
1         Mazda RX4  21.0     6    160  110   3.90 2.620  16.46    0    1
2     Mazda RX4 Wag  21.0     6    160  110   3.90 2.875  17.02    0    1
3        Datsun 710  22.8     4    108   93   3.85 2.320  18.61    1    1
4    Hornet 4 Drive  21.4     6    258  110   3.08 3.215  19.44    1    0
5 Hornet Sportabout  18.7     8    360  175   3.15 3.440  17.02    0    0
  gear.x carb.x mpg.y cyl.y disp.y hp.y drat.y  wt.y qsec.y vs.y am.y gear.y
1      4      4  21.0     6    160  110   3.90 2.620  16.46    0    1      4
2      4      4  21.0     6    160  110   3.90 2.875  17.02    0    1      4
3      4      1  22.8     4    108   93   3.85 2.320  18.61    1    1      4
4      3      1  21.4     6    258  110   3.08 3.215  19.44    1    0      3
5      3      2  18.7     8    360  175   3.15 3.440  17.02    0    0      3
  carb.y
1      4
2      4
3      1
4      1
5      2</code></pre>
</div>
</div>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform an inner join with pandas.</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>pd.merge(mtcars_pd, mtcars_pd, left_on<span class="op">=</span><span class="st">'model_name'</span>, right_on<span class="op">=</span><span class="st">'model_name'</span>, how<span class="op">=</span><span class="st">'inner'</span>).head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          model_name  mpg_x  cyl_x  disp_x  ...  am_y  gear_y  carb_y  new_mpg_y
0          Mazda RX4   21.0    6.0   160.0  ...   1.0     4.0     4.0       22.0
1      Mazda RX4 Wag   21.0    6.0   160.0  ...   1.0     4.0     4.0       22.0
2         Datsun 710   22.8    4.0   108.0  ...   1.0     4.0     1.0       23.8
3     Hornet 4 Drive   21.4    6.0   258.0  ...   0.0     3.0     1.0       22.4
4  Hornet Sportabout   18.7    8.0   360.0  ...   0.0     3.0     2.0       19.7

[5 rows x 25 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-14-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>mtcars_pl.join(mtcars_pl, on<span class="op">=</span><span class="st">"model_name"</span>, how<span class="op">=</span><span class="st">"inner"</span>).head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 23)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">disp</th>
<th data-quarto-table-cell-role="th">hp</th>
<th data-quarto-table-cell-role="th">drat</th>
<th data-quarto-table-cell-role="th">wt</th>
<th data-quarto-table-cell-role="th">qsec</th>
<th data-quarto-table-cell-role="th">vs</th>
<th data-quarto-table-cell-role="th">am</th>
<th data-quarto-table-cell-role="th">gear</th>
<th data-quarto-table-cell-role="th">carb</th>
<th data-quarto-table-cell-role="th">mpg_right</th>
<th data-quarto-table-cell-role="th">cyl_right</th>
<th data-quarto-table-cell-role="th">disp_right</th>
<th data-quarto-table-cell-role="th">hp_right</th>
<th data-quarto-table-cell-role="th">drat_right</th>
<th data-quarto-table-cell-role="th">wt_right</th>
<th data-quarto-table-cell-role="th">qsec_right</th>
<th data-quarto-table-cell-role="th">vs_right</th>
<th data-quarto-table-cell-role="th">am_right</th>
<th data-quarto-table-cell-role="th">gear_right</th>
<th data-quarto-table-cell-role="th">carb_right</th>
</tr>
<tr class="even">
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Mazda RX4"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.62</td>
<td>16.46</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.62</td>
<td>16.46</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>"Mazda RX4 Wag"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.875</td>
<td>17.02</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.875</td>
<td>17.02</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>"Datsun 710"</td>
<td>22.8</td>
<td>4.0</td>
<td>108.0</td>
<td>93.0</td>
<td>3.85</td>
<td>2.32</td>
<td>18.61</td>
<td>1.0</td>
<td>1.0</td>
<td>4.0</td>
<td>1.0</td>
<td>22.8</td>
<td>4.0</td>
<td>108.0</td>
<td>93.0</td>
<td>3.85</td>
<td>2.32</td>
<td>18.61</td>
<td>1.0</td>
<td>1.0</td>
<td>4.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>"Hornet 4 Drive"</td>
<td>21.4</td>
<td>6.0</td>
<td>258.0</td>
<td>110.0</td>
<td>3.08</td>
<td>3.215</td>
<td>19.44</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
<td>21.4</td>
<td>6.0</td>
<td>258.0</td>
<td>110.0</td>
<td>3.08</td>
<td>3.215</td>
<td>19.44</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td>"Hornet Sportabout"</td>
<td>18.7</td>
<td>8.0</td>
<td>360.0</td>
<td>175.0</td>
<td>3.15</td>
<td>3.44</td>
<td>17.02</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>2.0</td>
<td>18.7</td>
<td>8.0</td>
<td>360.0</td>
<td>175.0</td>
<td>3.15</td>
<td>3.44</td>
<td>17.02</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>2.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="append-rows" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> Append Rows</h1>
<section id="append-without-duplicate-elimination-union-all" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="append-without-duplicate-elimination-union-all"><span class="header-section-number">14.1</span> Append Without Duplicate Elimination (<code>union all</code>)</h2>
<p>This section shows how to combine rows from two tables, keeping all duplicates.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">SQL</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false">Python pandas</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Count the rows in the original table.</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">FROM</span> mtcars_table;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead>
<tr class="header">
<th style="text-align: right;">count_star()</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Create a new table by appending mtcars_table to itself, including duplicates.</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> TEMP <span class="kw">TABLE</span> double_mtcars_table <span class="kw">AS</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="kw">UNION</span> <span class="kw">ALL</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Count the rows in the new table.</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">FROM</span> double_mtcars_table;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead>
<tr class="header">
<th style="text-align: right;">count_star()</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">20</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Append rows using bind_rows.</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>(mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                              model_name  mpg cyl  disp  hp drat    wt  qsec vs
Mazda RX4...1                  Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0
Mazda RX4 Wag...2          Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0
Datsun 710...3                Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1
Hornet 4 Drive...4        Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1
Hornet Sportabout...5  Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0
Valiant...6                      Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1
Duster 360...7                Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0
Merc 240D...8                  Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1
Merc 230...9                    Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1
Merc 280...10                   Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1
Mazda RX4...11                 Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0
Mazda RX4 Wag...12         Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0
Datsun 710...13               Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1
Hornet 4 Drive...14       Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1
Hornet Sportabout...15 Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0
Valiant...16                     Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1
Duster 360...17               Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0
Merc 240D...18                 Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1
Merc 230...19                   Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1
Merc 280...20                   Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1
                       am gear carb
Mazda RX4...1           1    4    4
Mazda RX4 Wag...2       1    4    4
Datsun 710...3          1    4    1
Hornet 4 Drive...4      0    3    1
Hornet Sportabout...5   0    3    2
Valiant...6             0    3    1
Duster 360...7          0    3    4
Merc 240D...8           0    4    2
Merc 230...9            0    4    2
Merc 280...10           0    4    4
Mazda RX4...11          1    4    4
Mazda RX4 Wag...12      1    4    4
Datsun 710...13         1    4    1
Hornet 4 Drive...14     0    3    1
Hornet Sportabout...15  0    3    2
Valiant...16            0    3    1
Duster 360...17         0    3    4
Merc 240D...18          0    4    2
Merc 230...19           0    4    2
Merc 280...20           0    4    4</code></pre>
</div>
</div>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate dataframes, keeping all rows.</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>pd.concat([mtcars_pd, mtcars_pd], ignore_index<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           model_name   mpg  cyl   disp     hp  ...   vs   am  gear  carb  new_mpg
0           Mazda RX4  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0
1       Mazda RX4 Wag  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0
2          Datsun 710  22.8  4.0  108.0   93.0  ...  1.0  1.0   4.0   1.0     23.8
3      Hornet 4 Drive  21.4  6.0  258.0  110.0  ...  1.0  0.0   3.0   1.0     22.4
4   Hornet Sportabout  18.7  8.0  360.0  175.0  ...  0.0  0.0   3.0   2.0     19.7
5             Valiant  18.1  6.0  225.0  105.0  ...  1.0  0.0   3.0   1.0     19.1
6          Duster 360  14.3  8.0  360.0  245.0  ...  0.0  0.0   3.0   4.0     15.3
7           Merc 240D  24.4  4.0  146.7   62.0  ...  1.0  0.0   4.0   2.0     25.4
8            Merc 230  22.8  4.0  140.8   95.0  ...  1.0  0.0   4.0   2.0     23.8
9            Merc 280  19.2  6.0  167.6  123.0  ...  1.0  0.0   4.0   4.0     20.2
10          Mazda RX4  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0
11      Mazda RX4 Wag  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0
12         Datsun 710  22.8  4.0  108.0   93.0  ...  1.0  1.0   4.0   1.0     23.8
13     Hornet 4 Drive  21.4  6.0  258.0  110.0  ...  1.0  0.0   3.0   1.0     22.4
14  Hornet Sportabout  18.7  8.0  360.0  175.0  ...  0.0  0.0   3.0   2.0     19.7
15            Valiant  18.1  6.0  225.0  105.0  ...  1.0  0.0   3.0   1.0     19.1
16         Duster 360  14.3  8.0  360.0  245.0  ...  0.0  0.0   3.0   4.0     15.3
17          Merc 240D  24.4  4.0  146.7   62.0  ...  1.0  0.0   4.0   2.0     25.4
18           Merc 230  22.8  4.0  140.8   95.0  ...  1.0  0.0   4.0   2.0     23.8
19           Merc 280  19.2  6.0  167.6  123.0  ...  1.0  0.0   4.0   4.0     20.2

[20 rows x 13 columns]</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="append-with-duplicate-elimination-union" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="append-with-duplicate-elimination-union"><span class="header-section-number">14.2</span> Append With Duplicate Elimination (<code>union</code>)</h2>
<p>This section demonstrates how to combine rows while removing duplicate entries.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true">SQL</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-3" role="tab" aria-controls="tabset-16-3" aria-selected="false">Python pandas</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Create a table, removing duplicate rows.</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">OR</span> <span class="kw">REPLACE</span> TEMP <span class="kw">TABLE</span> double_mtcars_table <span class="kw">AS</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="kw">UNION</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Count the rows in the new table.</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">FROM</span> double_mtcars_table;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead>
<tr class="header">
<th style="text-align: right;">count_star()</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Verify the count of distinct rows.</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">FROM</span> (</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> <span class="op">*</span> <span class="kw">FROM</span> double_mtcars_table</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead>
<tr class="header">
<th style="text-align: right;">count_star()</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Append rows and then remove duplicates.</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>(mtcars) <span class="sc">|&gt;</span> <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                         model_name  mpg cyl  disp  hp drat    wt  qsec vs am
Mazda RX4                 Mazda RX4 21.0   6 160.0 110 3.90 2.620 16.46  0  1
Mazda RX4 Wag         Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1
Datsun 710               Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1  1
Hornet 4 Drive       Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0
Hornet Sportabout Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0
Valiant                     Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1  0
Duster 360               Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0  0
Merc 240D                 Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1  0
Merc 230                   Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1  0
Merc 280                   Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1  0
                  gear carb
Mazda RX4            4    4
Mazda RX4 Wag        4    4
Datsun 710           4    1
Hornet 4 Drive       3    1
Hornet Sportabout    3    2
Valiant              3    1
Duster 360           3    4
Merc 240D            4    2
Merc 230             4    2
Merc 280             4    4</code></pre>
</div>
</div>
</div>
<div id="tabset-16-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate dataframes and then drop duplicates.</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>pd.concat([mtcars_pd, mtcars_pd], ignore_index<span class="op">=</span><span class="va">True</span>).drop_duplicates()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          model_name   mpg  cyl   disp     hp  ...   vs   am  gear  carb  new_mpg
0          Mazda RX4  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0
1      Mazda RX4 Wag  21.0  6.0  160.0  110.0  ...  0.0  1.0   4.0   4.0     22.0
2         Datsun 710  22.8  4.0  108.0   93.0  ...  1.0  1.0   4.0   1.0     23.8
3     Hornet 4 Drive  21.4  6.0  258.0  110.0  ...  1.0  0.0   3.0   1.0     22.4
4  Hornet Sportabout  18.7  8.0  360.0  175.0  ...  0.0  0.0   3.0   2.0     19.7
5            Valiant  18.1  6.0  225.0  105.0  ...  1.0  0.0   3.0   1.0     19.1
6         Duster 360  14.3  8.0  360.0  245.0  ...  0.0  0.0   3.0   4.0     15.3
7          Merc 240D  24.4  4.0  146.7   62.0  ...  1.0  0.0   4.0   2.0     25.4
8           Merc 230  22.8  4.0  140.8   95.0  ...  1.0  0.0   4.0   2.0     23.8
9           Merc 280  19.2  6.0  167.6  123.0  ...  1.0  0.0   4.0   4.0     20.2

[10 rows x 13 columns]</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="delete-rows" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> Delete Rows</h1>
<p>This section shows how to remove rows from a table based on a condition.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true">SQL</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-3" role="tab" aria-controls="tabset-17-3" aria-selected="false">Python pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-4" role="tab" aria-controls="tabset-17-4" aria-selected="false">Python Polars</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Delete a specific row from the table.</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="kw">DELETE</span> <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> model_name <span class="op">=</span> <span class="st">'Mazda RX4'</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Verify the row count after deletion.</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">FROM</span> mtcars_table;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead>
<tr class="header">
<th style="text-align: right;">count_star()</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out the specified row.</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(model_name <span class="sc">!=</span> <span class="st">'Mazda RX4'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                         model_name  mpg cyl  disp  hp drat    wt  qsec vs am
Mazda RX4 Wag         Mazda RX4 Wag 21.0   6 160.0 110 3.90 2.875 17.02  0  1
Datsun 710               Datsun 710 22.8   4 108.0  93 3.85 2.320 18.61  1  1
Hornet 4 Drive       Hornet 4 Drive 21.4   6 258.0 110 3.08 3.215 19.44  1  0
Hornet Sportabout Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0
Valiant                     Valiant 18.1   6 225.0 105 2.76 3.460 20.22  1  0
Duster 360               Duster 360 14.3   8 360.0 245 3.21 3.570 15.84  0  0
Merc 240D                 Merc 240D 24.4   4 146.7  62 3.69 3.190 20.00  1  0
Merc 230                   Merc 230 22.8   4 140.8  95 3.92 3.150 22.90  1  0
Merc 280                   Merc 280 19.2   6 167.6 123 3.92 3.440 18.30  1  0
                  gear carb
Mazda RX4 Wag        4    4
Datsun 710           4    1
Hornet 4 Drive       3    1
Hornet Sportabout    3    2
Valiant              3    1
Duster 360           3    4
Merc 240D            4    2
Merc 230             4    2
Merc 280             4    4</code></pre>
</div>
</div>
</div>
<div id="tabset-17-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select all rows except the one specified.</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd[mtcars_pd[<span class="st">'model_name'</span>] <span class="op">!=</span> <span class="st">'Mazda RX4'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                          model_name   mpg  cyl  ...  gear  carb  new_mpg
Mazda RX4 Wag          Mazda RX4 Wag  21.0  6.0  ...   4.0   4.0     22.0
Datsun 710                Datsun 710  22.8  4.0  ...   4.0   1.0     23.8
Hornet 4 Drive        Hornet 4 Drive  21.4  6.0  ...   3.0   1.0     22.4
Hornet Sportabout  Hornet Sportabout  18.7  8.0  ...   3.0   2.0     19.7
Valiant                      Valiant  18.1  6.0  ...   3.0   1.0     19.1
Duster 360                Duster 360  14.3  8.0  ...   3.0   4.0     15.3
Merc 240D                  Merc 240D  24.4  4.0  ...   4.0   2.0     25.4
Merc 230                    Merc 230  22.8  4.0  ...   4.0   2.0     23.8
Merc 280                    Merc 280  19.2  6.0  ...   4.0   4.0     20.2

[9 rows x 13 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-17-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>mtcars_pl.<span class="bu">filter</span>(pl.col(<span class="st">"model_name"</span>) <span class="op">!=</span> <span class="st">'Mazda RX4'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (9, 12)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">disp</th>
<th data-quarto-table-cell-role="th">hp</th>
<th data-quarto-table-cell-role="th">drat</th>
<th data-quarto-table-cell-role="th">wt</th>
<th data-quarto-table-cell-role="th">qsec</th>
<th data-quarto-table-cell-role="th">vs</th>
<th data-quarto-table-cell-role="th">am</th>
<th data-quarto-table-cell-role="th">gear</th>
<th data-quarto-table-cell-role="th">carb</th>
</tr>
<tr class="even">
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Mazda RX4 Wag"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.875</td>
<td>17.02</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>"Datsun 710"</td>
<td>22.8</td>
<td>4.0</td>
<td>108.0</td>
<td>93.0</td>
<td>3.85</td>
<td>2.32</td>
<td>18.61</td>
<td>1.0</td>
<td>1.0</td>
<td>4.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td>"Hornet 4 Drive"</td>
<td>21.4</td>
<td>6.0</td>
<td>258.0</td>
<td>110.0</td>
<td>3.08</td>
<td>3.215</td>
<td>19.44</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>"Hornet Sportabout"</td>
<td>18.7</td>
<td>8.0</td>
<td>360.0</td>
<td>175.0</td>
<td>3.15</td>
<td>3.44</td>
<td>17.02</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td>"Valiant"</td>
<td>18.1</td>
<td>6.0</td>
<td>225.0</td>
<td>105.0</td>
<td>2.76</td>
<td>3.46</td>
<td>20.22</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>"Duster 360"</td>
<td>14.3</td>
<td>8.0</td>
<td>360.0</td>
<td>245.0</td>
<td>3.21</td>
<td>3.57</td>
<td>15.84</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>"Merc 240D"</td>
<td>24.4</td>
<td>4.0</td>
<td>146.7</td>
<td>62.0</td>
<td>3.69</td>
<td>3.19</td>
<td>20.0</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>2.0</td>
</tr>
<tr class="even">
<td>"Merc 230"</td>
<td>22.8</td>
<td>4.0</td>
<td>140.8</td>
<td>95.0</td>
<td>3.92</td>
<td>3.15</td>
<td>22.9</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td>"Merc 280"</td>
<td>19.2</td>
<td>6.0</td>
<td>167.6</td>
<td>123.0</td>
<td>3.92</td>
<td>3.44</td>
<td>18.3</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="update-rows" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> Update Rows</h1>
<p>This section demonstrates how to modify existing data in a table.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true">SQL</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-3" role="tab" aria-controls="tabset-18-3" aria-selected="false">Python pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-4" role="tab" aria-controls="tabset-18-4" aria-selected="false">Python Polars</a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Select the row to be updated.</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, mpg <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> model_name <span class="op">=</span> <span class="st">'Mazda RX4 Wag'</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">mpg</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Update the value of a column for a specific row.</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="kw">UPDATE</span> mtcars_table</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SET</span> mpg <span class="op">=</span> <span class="dv">999</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> model_name <span class="op">=</span> <span class="st">'Mazda RX4 Wag'</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Verify the update.</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, mpg <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> model_name <span class="op">=</span> <span class="st">'Mazda RX4 Wag'</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">model_name</th>
<th style="text-align: right;">mpg</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">999</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Update a value within a filtered selection.</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(model_name <span class="sc">==</span> <span class="st">'Mazda RX4 Wag'</span>) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">mpg =</span> <span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 model_name mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4 Wag Mazda RX4 Wag 999   6  160 110  3.9 2.875 17.02  0  1    4    4</code></pre>
</div>
</div>
</div>
<div id="tabset-18-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Update a specific value using .loc.</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>mtcars_pd.loc[mtcars_pd[<span class="st">'model_name'</span>] <span class="op">==</span> <span class="st">'Mazda RX4 Wag'</span>, <span class="st">'mpg'</span>] <span class="op">=</span> <span class="dv">999</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>mtcars_pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                          model_name    mpg  cyl  ...  gear  carb  new_mpg
Mazda RX4                  Mazda RX4   21.0  6.0  ...   4.0   4.0     22.0
Mazda RX4 Wag          Mazda RX4 Wag  999.0  6.0  ...   4.0   4.0     22.0
Datsun 710                Datsun 710   22.8  4.0  ...   4.0   1.0     23.8
Hornet 4 Drive        Hornet 4 Drive   21.4  6.0  ...   3.0   1.0     22.4
Hornet Sportabout  Hornet Sportabout   18.7  8.0  ...   3.0   2.0     19.7
Valiant                      Valiant   18.1  6.0  ...   3.0   1.0     19.1
Duster 360                Duster 360   14.3  8.0  ...   3.0   4.0     15.3
Merc 240D                  Merc 240D   24.4  4.0  ...   4.0   2.0     25.4
Merc 230                    Merc 230   22.8  4.0  ...   4.0   2.0     23.8
Merc 280                    Merc 280   19.2  6.0  ...   4.0   4.0     20.2

[10 rows x 13 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-18-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-4-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>mtcars_pl.with_columns(</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>    pl.when(pl.col(<span class="st">"model_name"</span>) <span class="op">==</span> <span class="st">'Mazda RX4 Wag'</span>)</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>    .then(<span class="dv">999</span>)</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>    .otherwise(pl.col(<span class="st">"mpg"</span>))</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>    .alias(<span class="st">"mpg"</span>)</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (10, 12)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">mpg</th>
<th data-quarto-table-cell-role="th">cyl</th>
<th data-quarto-table-cell-role="th">disp</th>
<th data-quarto-table-cell-role="th">hp</th>
<th data-quarto-table-cell-role="th">drat</th>
<th data-quarto-table-cell-role="th">wt</th>
<th data-quarto-table-cell-role="th">qsec</th>
<th data-quarto-table-cell-role="th">vs</th>
<th data-quarto-table-cell-role="th">am</th>
<th data-quarto-table-cell-role="th">gear</th>
<th data-quarto-table-cell-role="th">carb</th>
</tr>
<tr class="even">
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Mazda RX4"</td>
<td>21.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.62</td>
<td>16.46</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>"Mazda RX4 Wag"</td>
<td>999.0</td>
<td>6.0</td>
<td>160.0</td>
<td>110.0</td>
<td>3.9</td>
<td>2.875</td>
<td>17.02</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>"Datsun 710"</td>
<td>22.8</td>
<td>4.0</td>
<td>108.0</td>
<td>93.0</td>
<td>3.85</td>
<td>2.32</td>
<td>18.61</td>
<td>1.0</td>
<td>1.0</td>
<td>4.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>"Hornet 4 Drive"</td>
<td>21.4</td>
<td>6.0</td>
<td>258.0</td>
<td>110.0</td>
<td>3.08</td>
<td>3.215</td>
<td>19.44</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td>"Hornet Sportabout"</td>
<td>18.7</td>
<td>8.0</td>
<td>360.0</td>
<td>175.0</td>
<td>3.15</td>
<td>3.44</td>
<td>17.02</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>2.0</td>
</tr>
<tr class="even">
<td>"Valiant"</td>
<td>18.1</td>
<td>6.0</td>
<td>225.0</td>
<td>105.0</td>
<td>2.76</td>
<td>3.46</td>
<td>20.22</td>
<td>1.0</td>
<td>0.0</td>
<td>3.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td>"Duster 360"</td>
<td>14.3</td>
<td>8.0</td>
<td>360.0</td>
<td>245.0</td>
<td>3.21</td>
<td>3.57</td>
<td>15.84</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>4.0</td>
</tr>
<tr class="even">
<td>"Merc 240D"</td>
<td>24.4</td>
<td>4.0</td>
<td>146.7</td>
<td>62.0</td>
<td>3.69</td>
<td>3.19</td>
<td>20.0</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td>"Merc 230"</td>
<td>22.8</td>
<td>4.0</td>
<td>140.8</td>
<td>95.0</td>
<td>3.92</td>
<td>3.15</td>
<td>22.9</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>2.0</td>
</tr>
<tr class="even">
<td>"Merc 280"</td>
<td>19.2</td>
<td>6.0</td>
<td>167.6</td>
<td>123.0</td>
<td>3.92</td>
<td>3.44</td>
<td>18.3</td>
<td>1.0</td>
<td>0.0</td>
<td>4.0</td>
<td>4.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="drop-table" class="level1" data-number="17">
<h1 data-number="17"><span class="header-section-number">17</span> Drop Table</h1>
<p>This section shows how to remove a table from the database.</p>
<p>Before dropping the table:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Show all tables before dropping one.</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>SHOW <span class="kw">ALL</span> <span class="kw">TABLES</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>5 records</caption>
<colgroup>
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 5%">
<col style="width: 34%">
<col style="width: 53%">
<col style="width: 2%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">database</th>
<th style="text-align: left;">schema</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">column_names</th>
<th style="text-align: left;">column_types</th>
<th style="text-align: left;">temporary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">my-db</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">iris_table</td>
<td style="text-align: left;">Sepal.Length, Sepal.Width , Petal.Length, Petal.Width , Species</td>
<td style="text-align: left;">DOUBLE , DOUBLE , DOUBLE , DOUBLE , ENUM(‘setosa’, ‘versicolor’, ‘virginica’)</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">my-db</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">mtcars_table</td>
<td style="text-align: left;">model_name, mpg , cyl , disp , hp , drat , wt , qsec , vs , am , gear , carb</td>
<td style="text-align: left;">VARCHAR, DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">my-db</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">new_mtcars_table_group</td>
<td style="text-align: left;">model_name, total_mpg , cyl_mean</td>
<td style="text-align: left;">VARCHAR, DOUBLE , DOUBLE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">temp</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">double_mtcars_table</td>
<td style="text-align: left;">model_name, mpg , cyl , disp , hp , drat , wt , qsec , vs , am , gear , carb</td>
<td style="text-align: left;">VARCHAR, DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">temp</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">mtcars_table_group</td>
<td style="text-align: left;">model_name, total_mpg , cyl_mean</td>
<td style="text-align: left;">VARCHAR, DOUBLE , DOUBLE</td>
<td style="text-align: left;">TRUE</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Dropping the table:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Drop the specified table if it exists.</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> mtcars_table_group;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>After dropping the table:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Show all tables again to confirm the deletion.</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>SHOW <span class="kw">ALL</span> <span class="kw">TABLES</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>4 records</caption>
<colgroup>
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 5%">
<col style="width: 34%">
<col style="width: 53%">
<col style="width: 2%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">database</th>
<th style="text-align: left;">schema</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">column_names</th>
<th style="text-align: left;">column_types</th>
<th style="text-align: left;">temporary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">my-db</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">iris_table</td>
<td style="text-align: left;">Sepal.Length, Sepal.Width , Petal.Length, Petal.Width , Species</td>
<td style="text-align: left;">DOUBLE , DOUBLE , DOUBLE , DOUBLE , ENUM(‘setosa’, ‘versicolor’, ‘virginica’)</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">my-db</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">mtcars_table</td>
<td style="text-align: left;">model_name, mpg , cyl , disp , hp , drat , wt , qsec , vs , am , gear , carb</td>
<td style="text-align: left;">VARCHAR, DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">my-db</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">new_mtcars_table_group</td>
<td style="text-align: left;">model_name, total_mpg , cyl_mean</td>
<td style="text-align: left;">VARCHAR, DOUBLE , DOUBLE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">temp</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">double_mtcars_table</td>
<td style="text-align: left;">model_name, mpg , cyl , disp , hp , drat , wt , qsec , vs , am , gear , carb</td>
<td style="text-align: left;">VARCHAR, DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE , DOUBLE</td>
<td style="text-align: left;">TRUE</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="pivot" class="level1" data-number="18">
<h1 data-number="18"><span class="header-section-number">18</span> PIVOT</h1>
<p>This section demonstrates how to transform data from a long to a wide format.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Create a temporary table for the pivot demonstration.</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> cities;</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> TEMP <span class="kw">TABLE</span> cities (</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>    country <span class="dt">VARCHAR</span>, name <span class="dt">VARCHAR</span>, <span class="dt">year</span> <span class="dt">INTEGER</span>, population <span class="dt">INTEGER</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> cities <span class="kw">VALUES</span></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'NL'</span>, <span class="st">'Amsterdam'</span>, <span class="dv">2000</span>, <span class="dv">1005</span>),</span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'NL'</span>, <span class="st">'Amsterdam'</span>, <span class="dv">2010</span>, <span class="dv">1065</span>),</span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'NL'</span>, <span class="st">'Amsterdam'</span>, <span class="dv">2020</span>, <span class="dv">1158</span>),</span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'Seattle'</span>, <span class="dv">2000</span>, <span class="dv">564</span>),</span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'Seattle'</span>, <span class="dv">2010</span>, <span class="dv">608</span>),</span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'Seattle'</span>, <span class="dv">2020</span>, <span class="dv">738</span>),</span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'New York City'</span>, <span class="dv">2000</span>, <span class="dv">8015</span>),</span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'New York City'</span>, <span class="dv">2010</span>, <span class="dv">8175</span>),</span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'New York City'</span>, <span class="dv">2020</span>, <span class="dv">8772</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- View the raw data.</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> cities;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>9 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">country</th>
<th style="text-align: left;">name</th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NL</td>
<td style="text-align: left;">Amsterdam</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">1005</td>
</tr>
<tr class="even">
<td style="text-align: left;">NL</td>
<td style="text-align: left;">Amsterdam</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">1065</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NL</td>
<td style="text-align: left;">Amsterdam</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">1158</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: left;">Seattle</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">564</td>
</tr>
<tr class="odd">
<td style="text-align: left;">US</td>
<td style="text-align: left;">Seattle</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">608</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: left;">Seattle</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">738</td>
</tr>
<tr class="odd">
<td style="text-align: left;">US</td>
<td style="text-align: left;">New York City</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">8015</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: left;">New York City</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">8175</td>
</tr>
<tr class="odd">
<td style="text-align: left;">US</td>
<td style="text-align: left;">New York City</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">8772</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="pivot-on-one-column" class="level2" data-number="18.1">
<h2 data-number="18.1" class="anchored" data-anchor-id="pivot-on-one-column"><span class="header-section-number">18.1</span> PIVOT on One Column</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true">SQL</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false">Python pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-3" role="tab" aria-controls="tabset-19-3" aria-selected="false">Python Polars</a></li></ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Pivot the table on the 'year' column.</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>PIVOT cities</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> <span class="dt">year</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="kw">USING</span> <span class="fu">sum</span>(population)</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> country;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>2 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">country</th>
<th style="text-align: right;">2000</th>
<th style="text-align: right;">2010</th>
<th style="text-align: right;">2020</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NL</td>
<td style="text-align: right;">1005</td>
<td style="text-align: right;">1065</td>
<td style="text-align: right;">1158</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: right;">8579</td>
<td style="text-align: right;">8783</td>
<td style="text-align: right;">9510</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>cities_pd.pivot_table(index<span class="op">=</span><span class="st">'country'</span>, columns<span class="op">=</span><span class="st">'year'</span>, values<span class="op">=</span><span class="st">'population'</span>, aggfunc<span class="op">=</span><span class="st">'sum'</span>).reset_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>year country  2000  2010  2020
0         NL  1005  1065  1158
1         US  8579  8783  9510</code></pre>
</div>
</div>
</div>
<div id="tabset-19-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>cities_pl.pivot(index<span class="op">=</span><span class="st">'country'</span>, columns<span class="op">=</span><span class="st">'year'</span>, values<span class="op">=</span><span class="st">'population'</span>, aggregate_function<span class="op">=</span><span class="st">'sum'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (2, 4)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">2000</th>
<th data-quarto-table-cell-role="th">2010</th>
<th data-quarto-table-cell-role="th">2020</th>
</tr>
<tr class="even">
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"NL"</td>
<td>1005</td>
<td>1065</td>
<td>1158</td>
</tr>
<tr class="even">
<td>"US"</td>
<td>8579</td>
<td>8783</td>
<td>9510</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="pivot-on-two-columns" class="level2" data-number="18.2">
<h2 data-number="18.2" class="anchored" data-anchor-id="pivot-on-two-columns"><span class="header-section-number">18.2</span> PIVOT on Two Columns</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true">SQL</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false">Python pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-3" role="tab" aria-controls="tabset-20-3" aria-selected="false">Python Polars</a></li></ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Pivot on both 'country' and 'name'.</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>PIVOT cities</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> country, name</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="kw">USING</span> <span class="fu">sum</span>(population);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>3 records</caption>
<colgroup>
<col style="width: 5%">
<col style="width: 14%">
<col style="width: 19%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 19%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: right;">NL_Amsterdam</th>
<th style="text-align: right;">NL_New York City</th>
<th style="text-align: right;">NL_Seattle</th>
<th style="text-align: right;">US_Amsterdam</th>
<th style="text-align: right;">US_New York City</th>
<th style="text-align: right;">US_Seattle</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2000</td>
<td style="text-align: right;">1005</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">8015</td>
<td style="text-align: right;">564</td>
</tr>
<tr class="even">
<td style="text-align: right;">2010</td>
<td style="text-align: right;">1065</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">8175</td>
<td style="text-align: right;">608</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2020</td>
<td style="text-align: right;">1158</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">8772</td>
<td style="text-align: right;">738</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>cities_pd.pivot_table(index<span class="op">=</span>[<span class="st">'country'</span>, <span class="st">'name'</span>], columns<span class="op">=</span><span class="st">'year'</span>, values<span class="op">=</span><span class="st">'population'</span>, aggfunc<span class="op">=</span><span class="st">'sum'</span>).reset_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>year country           name  2000  2010  2020
0         NL      Amsterdam  1005  1065  1158
1         US  New York City  8015  8175  8772
2         US        Seattle   564   608   738</code></pre>
</div>
</div>
</div>
<div id="tabset-20-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>cities_pl.pivot(index<span class="op">=</span>[<span class="st">'country'</span>, <span class="st">'name'</span>], columns<span class="op">=</span><span class="st">'year'</span>, values<span class="op">=</span><span class="st">'population'</span>, aggregate_function<span class="op">=</span><span class="st">'sum'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (3, 5)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">2000</th>
<th data-quarto-table-cell-role="th">2010</th>
<th data-quarto-table-cell-role="th">2020</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>i64</th>
<th>i64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"NL"</td>
<td>"Amsterdam"</td>
<td>1005</td>
<td>1065</td>
<td>1158</td>
</tr>
<tr class="even">
<td>"US"</td>
<td>"Seattle"</td>
<td>564</td>
<td>608</td>
<td>738</td>
</tr>
<tr class="odd">
<td>"US"</td>
<td>"New York City"</td>
<td>8015</td>
<td>8175</td>
<td>8772</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="unpivot" class="level1" data-number="19">
<h1 data-number="19"><span class="header-section-number">19</span> UNPIVOT</h1>
<p>This section shows how to transform data from a wide to a long format.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true">SQL</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false">Python pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-3" role="tab" aria-controls="tabset-21-3" aria-selected="false">Python Polars</a></li></ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Unpivot the previously pivoted table.</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>UNPIVOT</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>  PIVOT cities</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> <span class="dt">year</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">USING</span> <span class="fu">sum</span>(population)</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">GROUP</span> <span class="kw">BY</span> country</span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> <span class="kw">COLUMNS</span>(<span class="op">*</span> EXCLUDE (country))</span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a><span class="kw">INTO</span></span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>    NAME <span class="dt">year</span></span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">VALUE</span> population;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>6 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">country</th>
<th style="text-align: left;">year</th>
<th style="text-align: right;">population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NL</td>
<td style="text-align: left;">2000</td>
<td style="text-align: right;">1005</td>
</tr>
<tr class="even">
<td style="text-align: left;">NL</td>
<td style="text-align: left;">2010</td>
<td style="text-align: right;">1065</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NL</td>
<td style="text-align: left;">2020</td>
<td style="text-align: right;">1158</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: left;">2000</td>
<td style="text-align: right;">8579</td>
</tr>
<tr class="odd">
<td style="text-align: left;">US</td>
<td style="text-align: left;">2010</td>
<td style="text-align: right;">8783</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: left;">2020</td>
<td style="text-align: right;">9510</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>cities_pivot_pd <span class="op">=</span> cities_pd.pivot_table(index<span class="op">=</span><span class="st">'country'</span>, columns<span class="op">=</span><span class="st">'year'</span>, values<span class="op">=</span><span class="st">'population'</span>, aggfunc<span class="op">=</span><span class="st">'sum'</span>).reset_index()</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>cities_pivot_pd.melt(id_vars<span class="op">=</span><span class="st">'country'</span>, value_vars<span class="op">=</span>[<span class="dv">2000</span>, <span class="dv">2010</span>, <span class="dv">2020</span>], var_name<span class="op">=</span><span class="st">'year'</span>, value_name<span class="op">=</span><span class="st">'population'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  country  year  population
0      NL  2000        1005
1      US  2000        8579
2      NL  2010        1065
3      US  2010        8783
4      NL  2020        1158
5      US  2020        9510</code></pre>
</div>
</div>
</div>
<div id="tabset-21-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>cities_pl <span class="op">=</span> pl.from_pandas(cities_pd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>cities_pivot_pl <span class="op">=</span> cities_pl.pivot(index<span class="op">=</span><span class="st">'country'</span>, columns<span class="op">=</span><span class="st">'year'</span>, values<span class="op">=</span><span class="st">'population'</span>, aggregate_function<span class="op">=</span><span class="st">'sum'</span>)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>cities_pivot_pl.unpivot(index<span class="op">=</span><span class="st">'country'</span>, on<span class="op">=</span>[<span class="st">'2000'</span>, <span class="st">'2010'</span>, <span class="st">'2020'</span>], variable_name<span class="op">=</span><span class="st">'year'</span>, value_name<span class="op">=</span><span class="st">'population'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (6, 3)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">population</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"NL"</td>
<td>"2000"</td>
<td>1005</td>
</tr>
<tr class="even">
<td>"US"</td>
<td>"2000"</td>
<td>8579</td>
</tr>
<tr class="odd">
<td>"NL"</td>
<td>"2010"</td>
<td>1065</td>
</tr>
<tr class="even">
<td>"US"</td>
<td>"2010"</td>
<td>8783</td>
</tr>
<tr class="odd">
<td>"NL"</td>
<td>"2020"</td>
<td>1158</td>
</tr>
<tr class="even">
<td>"US"</td>
<td>"2020"</td>
<td>9510</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="explain" class="level1" data-number="20">
<h1 data-number="20"><span class="header-section-number">20</span> EXPLAIN</h1>
<p>This section demonstrates how to analyze the execution plan of a query.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Show the logical execution plan of a query.</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="kw">EXPLAIN</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t1.model_name, t1.mpg, t1.cyl, t2.<span class="op">*</span> <span class="kw">FROM</span> mtcars_table t1</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> (<span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table <span class="kw">LIMIT</span> <span class="dv">5</span>) t2 <span class="kw">ON</span> t1.model_name <span class="op">=</span> t2.model_name;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Show the detailed execution plan, including timing information.</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="kw">EXPLAIN</span> <span class="kw">ANALYZE</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t1.model_name, t1.mpg, t1.cyl, t2.<span class="op">*</span> <span class="kw">FROM</span> mtcars_table t1</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> (<span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table <span class="kw">LIMIT</span> <span class="dv">5</span>) t2 <span class="kw">ON</span> t1.model_name <span class="op">=</span> t2.model_name;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Disconnect from the database and shut it down.</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(con, <span class="at">shutdown =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="display-beautiful-table" class="level1" data-number="21">
<h1 data-number="21"><span class="header-section-number">21</span> Display Beautiful Table</h1>
<p>This section shows how to create nicely formatted tables for presentation.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-2" role="tab" aria-controls="tabset-22-2" aria-selected="false">Python pandas</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-3" role="tab" aria-controls="tabset-22-3" aria-selected="false">Python Polars</a></li></ul>
<div class="tab-content">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the gt library to create a formatted table.</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="jgybmfjgcw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jgybmfjgcw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jgybmfjgcw thead, #jgybmfjgcw tbody, #jgybmfjgcw tfoot, #jgybmfjgcw tr, #jgybmfjgcw td, #jgybmfjgcw th {
  border-style: none;
}

#jgybmfjgcw p {
  margin: 0;
  padding: 0;
}

#jgybmfjgcw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jgybmfjgcw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jgybmfjgcw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jgybmfjgcw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jgybmfjgcw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jgybmfjgcw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jgybmfjgcw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jgybmfjgcw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jgybmfjgcw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jgybmfjgcw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jgybmfjgcw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jgybmfjgcw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jgybmfjgcw .gt_spanner_row {
  border-bottom-style: hidden;
}

#jgybmfjgcw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jgybmfjgcw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jgybmfjgcw .gt_from_md > :first-child {
  margin-top: 0;
}

#jgybmfjgcw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jgybmfjgcw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jgybmfjgcw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jgybmfjgcw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jgybmfjgcw .gt_row_group_first td {
  border-top-width: 2px;
}

#jgybmfjgcw .gt_row_group_first th {
  border-top-width: 2px;
}

#jgybmfjgcw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jgybmfjgcw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jgybmfjgcw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jgybmfjgcw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jgybmfjgcw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jgybmfjgcw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jgybmfjgcw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jgybmfjgcw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jgybmfjgcw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jgybmfjgcw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jgybmfjgcw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jgybmfjgcw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jgybmfjgcw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jgybmfjgcw .gt_left {
  text-align: left;
}

#jgybmfjgcw .gt_center {
  text-align: center;
}

#jgybmfjgcw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jgybmfjgcw .gt_font_normal {
  font-weight: normal;
}

#jgybmfjgcw .gt_font_bold {
  font-weight: bold;
}

#jgybmfjgcw .gt_font_italic {
  font-style: italic;
}

#jgybmfjgcw .gt_super {
  font-size: 65%;
}

#jgybmfjgcw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jgybmfjgcw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jgybmfjgcw .gt_indent_1 {
  text-indent: 5px;
}

#jgybmfjgcw .gt_indent_2 {
  text-indent: 10px;
}

#jgybmfjgcw .gt_indent_3 {
  text-indent: 15px;
}

#jgybmfjgcw .gt_indent_4 {
  text-indent: 20px;
}

#jgybmfjgcw .gt_indent_5 {
  text-indent: 25px;
}

#jgybmfjgcw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#jgybmfjgcw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="model_name" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">model_name</th>
<th id="mpg" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">mpg</th>
<th id="cyl" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">cyl</th>
<th id="disp" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">disp</th>
<th id="hp" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">hp</th>
<th id="drat" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">drat</th>
<th id="wt" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">wt</th>
<th id="qsec" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">qsec</th>
<th id="vs" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">vs</th>
<th id="am" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">am</th>
<th id="gear" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">gear</th>
<th id="carb" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">carb</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="model_name">Mazda RX4</td>
<td class="gt_row gt_right" headers="mpg">21.0</td>
<td class="gt_row gt_right" headers="cyl">6</td>
<td class="gt_row gt_right" headers="disp">160.0</td>
<td class="gt_row gt_right" headers="hp">110</td>
<td class="gt_row gt_right" headers="drat">3.90</td>
<td class="gt_row gt_right" headers="wt">2.620</td>
<td class="gt_row gt_right" headers="qsec">16.46</td>
<td class="gt_row gt_right" headers="vs">0</td>
<td class="gt_row gt_right" headers="am">1</td>
<td class="gt_row gt_right" headers="gear">4</td>
<td class="gt_row gt_right" headers="carb">4</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="model_name">Mazda RX4 Wag</td>
<td class="gt_row gt_right" headers="mpg">21.0</td>
<td class="gt_row gt_right" headers="cyl">6</td>
<td class="gt_row gt_right" headers="disp">160.0</td>
<td class="gt_row gt_right" headers="hp">110</td>
<td class="gt_row gt_right" headers="drat">3.90</td>
<td class="gt_row gt_right" headers="wt">2.875</td>
<td class="gt_row gt_right" headers="qsec">17.02</td>
<td class="gt_row gt_right" headers="vs">0</td>
<td class="gt_row gt_right" headers="am">1</td>
<td class="gt_row gt_right" headers="gear">4</td>
<td class="gt_row gt_right" headers="carb">4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="model_name">Datsun 710</td>
<td class="gt_row gt_right" headers="mpg">22.8</td>
<td class="gt_row gt_right" headers="cyl">4</td>
<td class="gt_row gt_right" headers="disp">108.0</td>
<td class="gt_row gt_right" headers="hp">93</td>
<td class="gt_row gt_right" headers="drat">3.85</td>
<td class="gt_row gt_right" headers="wt">2.320</td>
<td class="gt_row gt_right" headers="qsec">18.61</td>
<td class="gt_row gt_right" headers="vs">1</td>
<td class="gt_row gt_right" headers="am">1</td>
<td class="gt_row gt_right" headers="gear">4</td>
<td class="gt_row gt_right" headers="carb">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="model_name">Hornet 4 Drive</td>
<td class="gt_row gt_right" headers="mpg">21.4</td>
<td class="gt_row gt_right" headers="cyl">6</td>
<td class="gt_row gt_right" headers="disp">258.0</td>
<td class="gt_row gt_right" headers="hp">110</td>
<td class="gt_row gt_right" headers="drat">3.08</td>
<td class="gt_row gt_right" headers="wt">3.215</td>
<td class="gt_row gt_right" headers="qsec">19.44</td>
<td class="gt_row gt_right" headers="vs">1</td>
<td class="gt_row gt_right" headers="am">0</td>
<td class="gt_row gt_right" headers="gear">3</td>
<td class="gt_row gt_right" headers="carb">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="model_name">Hornet Sportabout</td>
<td class="gt_row gt_right" headers="mpg">18.7</td>
<td class="gt_row gt_right" headers="cyl">8</td>
<td class="gt_row gt_right" headers="disp">360.0</td>
<td class="gt_row gt_right" headers="hp">175</td>
<td class="gt_row gt_right" headers="drat">3.15</td>
<td class="gt_row gt_right" headers="wt">3.440</td>
<td class="gt_row gt_right" headers="qsec">17.02</td>
<td class="gt_row gt_right" headers="vs">0</td>
<td class="gt_row gt_right" headers="am">0</td>
<td class="gt_row gt_right" headers="gear">3</td>
<td class="gt_row gt_right" headers="carb">2</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="model_name">Valiant</td>
<td class="gt_row gt_right" headers="mpg">18.1</td>
<td class="gt_row gt_right" headers="cyl">6</td>
<td class="gt_row gt_right" headers="disp">225.0</td>
<td class="gt_row gt_right" headers="hp">105</td>
<td class="gt_row gt_right" headers="drat">2.76</td>
<td class="gt_row gt_right" headers="wt">3.460</td>
<td class="gt_row gt_right" headers="qsec">20.22</td>
<td class="gt_row gt_right" headers="vs">1</td>
<td class="gt_row gt_right" headers="am">0</td>
<td class="gt_row gt_right" headers="gear">3</td>
<td class="gt_row gt_right" headers="carb">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="model_name">Duster 360</td>
<td class="gt_row gt_right" headers="mpg">14.3</td>
<td class="gt_row gt_right" headers="cyl">8</td>
<td class="gt_row gt_right" headers="disp">360.0</td>
<td class="gt_row gt_right" headers="hp">245</td>
<td class="gt_row gt_right" headers="drat">3.21</td>
<td class="gt_row gt_right" headers="wt">3.570</td>
<td class="gt_row gt_right" headers="qsec">15.84</td>
<td class="gt_row gt_right" headers="vs">0</td>
<td class="gt_row gt_right" headers="am">0</td>
<td class="gt_row gt_right" headers="gear">3</td>
<td class="gt_row gt_right" headers="carb">4</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="model_name">Merc 240D</td>
<td class="gt_row gt_right" headers="mpg">24.4</td>
<td class="gt_row gt_right" headers="cyl">4</td>
<td class="gt_row gt_right" headers="disp">146.7</td>
<td class="gt_row gt_right" headers="hp">62</td>
<td class="gt_row gt_right" headers="drat">3.69</td>
<td class="gt_row gt_right" headers="wt">3.190</td>
<td class="gt_row gt_right" headers="qsec">20.00</td>
<td class="gt_row gt_right" headers="vs">1</td>
<td class="gt_row gt_right" headers="am">0</td>
<td class="gt_row gt_right" headers="gear">4</td>
<td class="gt_row gt_right" headers="carb">2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="model_name">Merc 230</td>
<td class="gt_row gt_right" headers="mpg">22.8</td>
<td class="gt_row gt_right" headers="cyl">4</td>
<td class="gt_row gt_right" headers="disp">140.8</td>
<td class="gt_row gt_right" headers="hp">95</td>
<td class="gt_row gt_right" headers="drat">3.92</td>
<td class="gt_row gt_right" headers="wt">3.150</td>
<td class="gt_row gt_right" headers="qsec">22.90</td>
<td class="gt_row gt_right" headers="vs">1</td>
<td class="gt_row gt_right" headers="am">0</td>
<td class="gt_row gt_right" headers="gear">4</td>
<td class="gt_row gt_right" headers="carb">2</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="model_name">Merc 280</td>
<td class="gt_row gt_right" headers="mpg">19.2</td>
<td class="gt_row gt_right" headers="cyl">6</td>
<td class="gt_row gt_right" headers="disp">167.6</td>
<td class="gt_row gt_right" headers="hp">123</td>
<td class="gt_row gt_right" headers="drat">3.92</td>
<td class="gt_row gt_right" headers="wt">3.440</td>
<td class="gt_row gt_right" headers="qsec">18.30</td>
<td class="gt_row gt_right" headers="vs">1</td>
<td class="gt_row gt_right" headers="am">0</td>
<td class="gt_row gt_right" headers="gear">4</td>
<td class="gt_row gt_right" headers="carb">4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="tabset-22-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the great_tables library to create a formatted table.</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> great_tables <span class="im">import</span> GT</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>GT(mtcars_pd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="jtfqhqlthb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>
#jtfqhqlthb table {
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
        }

#jtfqhqlthb thead, tbody, tfoot, tr, td, th { border-style: none; }
 tr { background-color: transparent; }
#jtfqhqlthb p { margin: 0; padding: 0; }
 #jtfqhqlthb .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; }
 #jtfqhqlthb .gt_caption { padding-top: 4px; padding-bottom: 4px; }
 #jtfqhqlthb .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; }
 #jtfqhqlthb .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; }
 #jtfqhqlthb .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #jtfqhqlthb .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }
 #jtfqhqlthb .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #jtfqhqlthb .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; }
 #jtfqhqlthb .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; }
 #jtfqhqlthb .gt_column_spanner_outer:first-child { padding-left: 0; }
 #jtfqhqlthb .gt_column_spanner_outer:last-child { padding-right: 0; }
 #jtfqhqlthb .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; }
 #jtfqhqlthb .gt_spanner_row { border-bottom-style: hidden; }
 #jtfqhqlthb .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; }
 #jtfqhqlthb .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; }
 #jtfqhqlthb .gt_from_md> :first-child { margin-top: 0; }
 #jtfqhqlthb .gt_from_md> :last-child { margin-bottom: 0; }
 #jtfqhqlthb .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; }
 #jtfqhqlthb .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; }
 #jtfqhqlthb .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; }
 #jtfqhqlthb .gt_row_group_first td { border-top-width: 2px; }
 #jtfqhqlthb .gt_row_group_first th { border-top-width: 2px; }
 #jtfqhqlthb .gt_striped { background-color: rgba(128,128,128,0.05); }
 #jtfqhqlthb .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }
 #jtfqhqlthb .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; }
 #jtfqhqlthb .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; text-align: left; }
 #jtfqhqlthb .gt_left { text-align: left; }
 #jtfqhqlthb .gt_center { text-align: center; }
 #jtfqhqlthb .gt_right { text-align: right; font-variant-numeric: tabular-nums; }
 #jtfqhqlthb .gt_font_normal { font-weight: normal; }
 #jtfqhqlthb .gt_font_bold { font-weight: bold; }
 #jtfqhqlthb .gt_font_italic { font-style: italic; }
 #jtfqhqlthb .gt_super { font-size: 65%; }
 #jtfqhqlthb .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; }
 #jtfqhqlthb .gt_asterisk { font-size: 100%; vertical-align: 0; }
 
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="model_name" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">model_name</th>
<th id="mpg" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">mpg</th>
<th id="cyl" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">cyl</th>
<th id="disp" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">disp</th>
<th id="hp" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">hp</th>
<th id="drat" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">drat</th>
<th id="wt" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">wt</th>
<th id="qsec" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">qsec</th>
<th id="vs" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">vs</th>
<th id="am" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">am</th>
<th id="gear" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">gear</th>
<th id="carb" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">carb</th>
<th id="new_mpg" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">new_mpg</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left">Mazda RX4</td>
<td class="gt_row gt_right">21.0</td>
<td class="gt_row gt_right">6.0</td>
<td class="gt_row gt_right">160.0</td>
<td class="gt_row gt_right">110.0</td>
<td class="gt_row gt_right">3.9</td>
<td class="gt_row gt_right">2.62</td>
<td class="gt_row gt_right">16.46</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">22.0</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Mazda RX4 Wag</td>
<td class="gt_row gt_right">999.0</td>
<td class="gt_row gt_right">6.0</td>
<td class="gt_row gt_right">160.0</td>
<td class="gt_row gt_right">110.0</td>
<td class="gt_row gt_right">3.9</td>
<td class="gt_row gt_right">2.875</td>
<td class="gt_row gt_right">17.02</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">22.0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">Datsun 710</td>
<td class="gt_row gt_right">22.8</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">108.0</td>
<td class="gt_row gt_right">93.0</td>
<td class="gt_row gt_right">3.85</td>
<td class="gt_row gt_right">2.32</td>
<td class="gt_row gt_right">18.61</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">23.8</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Hornet 4 Drive</td>
<td class="gt_row gt_right">21.4</td>
<td class="gt_row gt_right">6.0</td>
<td class="gt_row gt_right">258.0</td>
<td class="gt_row gt_right">110.0</td>
<td class="gt_row gt_right">3.08</td>
<td class="gt_row gt_right">3.215</td>
<td class="gt_row gt_right">19.44</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">3.0</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">22.4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">Hornet Sportabout</td>
<td class="gt_row gt_right">18.7</td>
<td class="gt_row gt_right">8.0</td>
<td class="gt_row gt_right">360.0</td>
<td class="gt_row gt_right">175.0</td>
<td class="gt_row gt_right">3.15</td>
<td class="gt_row gt_right">3.44</td>
<td class="gt_row gt_right">17.02</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">3.0</td>
<td class="gt_row gt_right">2.0</td>
<td class="gt_row gt_right">19.7</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Valiant</td>
<td class="gt_row gt_right">18.1</td>
<td class="gt_row gt_right">6.0</td>
<td class="gt_row gt_right">225.0</td>
<td class="gt_row gt_right">105.0</td>
<td class="gt_row gt_right">2.76</td>
<td class="gt_row gt_right">3.46</td>
<td class="gt_row gt_right">20.22</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">3.0</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">19.1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">Duster 360</td>
<td class="gt_row gt_right">14.3</td>
<td class="gt_row gt_right">8.0</td>
<td class="gt_row gt_right">360.0</td>
<td class="gt_row gt_right">245.0</td>
<td class="gt_row gt_right">3.21</td>
<td class="gt_row gt_right">3.57</td>
<td class="gt_row gt_right">15.84</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">3.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">15.3</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Merc 240D</td>
<td class="gt_row gt_right">24.4</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">146.7</td>
<td class="gt_row gt_right">62.0</td>
<td class="gt_row gt_right">3.69</td>
<td class="gt_row gt_right">3.19</td>
<td class="gt_row gt_right">20.0</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">2.0</td>
<td class="gt_row gt_right">25.4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">Merc 230</td>
<td class="gt_row gt_right">22.8</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">140.8</td>
<td class="gt_row gt_right">95.0</td>
<td class="gt_row gt_right">3.92</td>
<td class="gt_row gt_right">3.15</td>
<td class="gt_row gt_right">22.9</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">2.0</td>
<td class="gt_row gt_right">23.8</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Merc 280</td>
<td class="gt_row gt_right">19.2</td>
<td class="gt_row gt_right">6.0</td>
<td class="gt_row gt_right">167.6</td>
<td class="gt_row gt_right">123.0</td>
<td class="gt_row gt_right">3.92</td>
<td class="gt_row gt_right">3.44</td>
<td class="gt_row gt_right">18.3</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">20.2</td>
</tr>
</tbody>
</table>


</div>
        
</div>
</div>
</div>
<div id="tabset-22-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the great_tables library to create a formatted table.</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> great_tables <span class="im">import</span> GT</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>GT(mtcars_pl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="xbeutneqpe" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>
#xbeutneqpe table {
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
        }

#xbeutneqpe thead, tbody, tfoot, tr, td, th { border-style: none; }
 tr { background-color: transparent; }
#xbeutneqpe p { margin: 0; padding: 0; }
 #xbeutneqpe .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; }
 #xbeutneqpe .gt_caption { padding-top: 4px; padding-bottom: 4px; }
 #xbeutneqpe .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; }
 #xbeutneqpe .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; }
 #xbeutneqpe .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #xbeutneqpe .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }
 #xbeutneqpe .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #xbeutneqpe .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; }
 #xbeutneqpe .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; }
 #xbeutneqpe .gt_column_spanner_outer:first-child { padding-left: 0; }
 #xbeutneqpe .gt_column_spanner_outer:last-child { padding-right: 0; }
 #xbeutneqpe .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; }
 #xbeutneqpe .gt_spanner_row { border-bottom-style: hidden; }
 #xbeutneqpe .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; }
 #xbeutneqpe .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; }
 #xbeutneqpe .gt_from_md> :first-child { margin-top: 0; }
 #xbeutneqpe .gt_from_md> :last-child { margin-bottom: 0; }
 #xbeutneqpe .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; }
 #xbeutneqpe .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; }
 #xbeutneqpe .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; }
 #xbeutneqpe .gt_row_group_first td { border-top-width: 2px; }
 #xbeutneqpe .gt_row_group_first th { border-top-width: 2px; }
 #xbeutneqpe .gt_striped { background-color: rgba(128,128,128,0.05); }
 #xbeutneqpe .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }
 #xbeutneqpe .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; }
 #xbeutneqpe .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; text-align: left; }
 #xbeutneqpe .gt_left { text-align: left; }
 #xbeutneqpe .gt_center { text-align: center; }
 #xbeutneqpe .gt_right { text-align: right; font-variant-numeric: tabular-nums; }
 #xbeutneqpe .gt_font_normal { font-weight: normal; }
 #xbeutneqpe .gt_font_bold { font-weight: bold; }
 #xbeutneqpe .gt_font_italic { font-style: italic; }
 #xbeutneqpe .gt_super { font-size: 65%; }
 #xbeutneqpe .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; }
 #xbeutneqpe .gt_asterisk { font-size: 100%; vertical-align: 0; }
 
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="model_name" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">model_name</th>
<th id="mpg" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">mpg</th>
<th id="cyl" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">cyl</th>
<th id="disp" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">disp</th>
<th id="hp" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">hp</th>
<th id="drat" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">drat</th>
<th id="wt" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">wt</th>
<th id="qsec" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">qsec</th>
<th id="vs" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">vs</th>
<th id="am" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">am</th>
<th id="gear" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">gear</th>
<th id="carb" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">carb</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left">Mazda RX4</td>
<td class="gt_row gt_right">21.0</td>
<td class="gt_row gt_right">6.0</td>
<td class="gt_row gt_right">160.0</td>
<td class="gt_row gt_right">110.0</td>
<td class="gt_row gt_right">3.9</td>
<td class="gt_row gt_right">2.62</td>
<td class="gt_row gt_right">16.46</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">4.0</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Mazda RX4 Wag</td>
<td class="gt_row gt_right">21.0</td>
<td class="gt_row gt_right">6.0</td>
<td class="gt_row gt_right">160.0</td>
<td class="gt_row gt_right">110.0</td>
<td class="gt_row gt_right">3.9</td>
<td class="gt_row gt_right">2.875</td>
<td class="gt_row gt_right">17.02</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">4.0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">Datsun 710</td>
<td class="gt_row gt_right">22.8</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">108.0</td>
<td class="gt_row gt_right">93.0</td>
<td class="gt_row gt_right">3.85</td>
<td class="gt_row gt_right">2.32</td>
<td class="gt_row gt_right">18.61</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">1.0</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Hornet 4 Drive</td>
<td class="gt_row gt_right">21.4</td>
<td class="gt_row gt_right">6.0</td>
<td class="gt_row gt_right">258.0</td>
<td class="gt_row gt_right">110.0</td>
<td class="gt_row gt_right">3.08</td>
<td class="gt_row gt_right">3.215</td>
<td class="gt_row gt_right">19.44</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">3.0</td>
<td class="gt_row gt_right">1.0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">Hornet Sportabout</td>
<td class="gt_row gt_right">18.7</td>
<td class="gt_row gt_right">8.0</td>
<td class="gt_row gt_right">360.0</td>
<td class="gt_row gt_right">175.0</td>
<td class="gt_row gt_right">3.15</td>
<td class="gt_row gt_right">3.44</td>
<td class="gt_row gt_right">17.02</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">3.0</td>
<td class="gt_row gt_right">2.0</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Valiant</td>
<td class="gt_row gt_right">18.1</td>
<td class="gt_row gt_right">6.0</td>
<td class="gt_row gt_right">225.0</td>
<td class="gt_row gt_right">105.0</td>
<td class="gt_row gt_right">2.76</td>
<td class="gt_row gt_right">3.46</td>
<td class="gt_row gt_right">20.22</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">3.0</td>
<td class="gt_row gt_right">1.0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">Duster 360</td>
<td class="gt_row gt_right">14.3</td>
<td class="gt_row gt_right">8.0</td>
<td class="gt_row gt_right">360.0</td>
<td class="gt_row gt_right">245.0</td>
<td class="gt_row gt_right">3.21</td>
<td class="gt_row gt_right">3.57</td>
<td class="gt_row gt_right">15.84</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">3.0</td>
<td class="gt_row gt_right">4.0</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Merc 240D</td>
<td class="gt_row gt_right">24.4</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">146.7</td>
<td class="gt_row gt_right">62.0</td>
<td class="gt_row gt_right">3.69</td>
<td class="gt_row gt_right">3.19</td>
<td class="gt_row gt_right">20.0</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">2.0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left">Merc 230</td>
<td class="gt_row gt_right">22.8</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">140.8</td>
<td class="gt_row gt_right">95.0</td>
<td class="gt_row gt_right">3.92</td>
<td class="gt_row gt_right">3.15</td>
<td class="gt_row gt_right">22.9</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">2.0</td>
</tr>
<tr class="even">
<td class="gt_row gt_left">Merc 280</td>
<td class="gt_row gt_right">19.2</td>
<td class="gt_row gt_right">6.0</td>
<td class="gt_row gt_right">167.6</td>
<td class="gt_row gt_right">123.0</td>
<td class="gt_row gt_right">3.92</td>
<td class="gt_row gt_right">3.44</td>
<td class="gt_row gt_right">18.3</td>
<td class="gt_row gt_right">1.0</td>
<td class="gt_row gt_right">0.0</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">4.0</td>
</tr>
</tbody>
</table>


</div>
        
</div>
</div>
</div>
</div>
</div>
</section>
<section id="reference" class="level1" data-number="22">
<h1 data-number="22"><span class="header-section-number">22</span> Reference:</h1>
<ul>
<li><a href="https://duckdb.org/docs/stable/clients/r.html">DuckDB R Client Documentation</a></li>
<li><a href="https://duckdb.org/docs/stable/sql/statements">DuckDB SQL Statements</a></li>
</ul>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark_dimmed">
<script>
function loadGiscusWhenReady() {
  // Function to get the theme based on body class
  const getTheme = () => {
    const baseTheme = document.getElementById('giscus-base-theme').value;
    const altTheme = document.getElementById('giscus-alt-theme').value;
    return document.body.classList.contains('quarto-dark') ? altTheme : baseTheme;
  };
  // Create the Giscus script and add it to the desired location
  const loadGiscus = () => {
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.async = true;
    script.dataset.repo = "JCfly3000/into_sql";
    script.dataset.repoId = "R_kgDOOC5J8A";
    script.dataset.category = "General";
    script.dataset.categoryId = "DIC_kwDOOC5J8M4Cnyr2";
    script.dataset.mapping = "title";
    script.dataset.reactionsEnabled = "1";
    script.dataset.emitMetadata = "0";
    script.dataset.inputPosition = "bottom";
    script.dataset.theme = getTheme();
    script.dataset.lang = "en";
    script.crossOrigin = "anonymous";
    // Append the script to the desired div instead of at the end of the body
    document.getElementById("quarto-content").appendChild(script);
  };
  // MutationObserver to detect when the 'quarto-light' or 'quarto-dark' class is added to the body
  const observer = new MutationObserver((mutations) => {
    for (const mutation of mutations) {
      if (mutation.type === "attributes" && mutation.attributeName === "class") {
        if (document.body.classList.contains('quarto-light') || document.body.classList.contains('quarto-dark')) {
          loadGiscus();
          observer.disconnect(); // Stop observing once Giscus is loaded
          break;
        }
      }
    }
  });
  // Start observing the body for class attribute changes
  observer.observe(document.body, {
    attributes: true,
    attributeFilter: ["class"],
  });
}
loadGiscusWhenReady();
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb162" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "SQL handbook"</span></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Tony Duan"</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a><span class="co">  error: false</span></span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: right</span></span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb162-14"><a href="#cb162-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-block-bg: true</span></span>
<span id="cb162-15"><a href="#cb162-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-block-border-left: "#31BAE9"</span></span>
<span id="cb162-16"><a href="#cb162-16" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb162-17"><a href="#cb162-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-18"><a href="#cb162-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-19"><a href="#cb162-19" aria-hidden="true" tabindex="-1"></a>This document provides a comprehensive guide to performing common data manipulation tasks using SQL, R, and Python. It serves as a reference for understanding how to achieve similar outcomes across these three popular data analysis tools.</span>
<span id="cb162-20"><a href="#cb162-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-21"><a href="#cb162-21" aria-hidden="true" tabindex="-1"></a><span class="fu"># Setup and Configuration</span></span>
<span id="cb162-22"><a href="#cb162-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-25"><a href="#cb162-25" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb162-26"><a href="#cb162-26" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb162-27"><a href="#cb162-27" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb162-28"><a href="#cb162-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb162-29"><a href="#cb162-29" aria-hidden="true" tabindex="-1"></a><span class="fu">py_require</span>(<span class="fu">c</span>(<span class="st">"pandas"</span>,<span class="st">"Great-Tables"</span>,<span class="st">"polars"</span>,<span class="st">"pyarrow"</span>))</span>
<span id="cb162-30"><a href="#cb162-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-31"><a href="#cb162-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries for database interaction, data manipulation, and connections.</span></span>
<span id="cb162-32"><a href="#cb162-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DBI)</span>
<span id="cb162-33"><a href="#cb162-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb162-34"><a href="#cb162-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSQLite)</span>
<span id="cb162-35"><a href="#cb162-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(connections)</span>
<span id="cb162-36"><a href="#cb162-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(duckdb)</span>
<span id="cb162-37"><a href="#cb162-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-38"><a href="#cb162-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the R dataframes.</span></span>
<span id="cb162-39"><a href="#cb162-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the existing mtcars dataset if it exists.</span></span>
<span id="cb162-40"><a href="#cb162-40" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(mtcars)</span>
<span id="cb162-41"><a href="#cb162-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the mtcars dataframe from the base R dataset, adding the row names as a new column.</span></span>
<span id="cb162-42"><a href="#cb162-42" aria-hidden="true" tabindex="-1"></a>mtcars <span class="ot">=</span> <span class="fu">cbind</span>(<span class="at">model_name =</span> <span class="fu">rownames</span>(mtcars), mtcars) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb162-43"><a href="#cb162-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the iris dataframe from the base R dataset.</span></span>
<span id="cb162-44"><a href="#cb162-44" aria-hidden="true" tabindex="-1"></a>iris <span class="ot">=</span> iris <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb162-45"><a href="#cb162-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-46"><a href="#cb162-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the database file if it already exists to start with a clean slate.</span></span>
<span id="cb162-47"><a href="#cb162-47" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">"my-db.duckdb"</span>)) {</span>
<span id="cb162-48"><a href="#cb162-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">file.remove</span>(<span class="st">"my-db.duckdb"</span>)</span>
<span id="cb162-49"><a href="#cb162-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb162-50"><a href="#cb162-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Establish a connection to the DuckDB database.</span></span>
<span id="cb162-51"><a href="#cb162-51" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(<span class="fu">duckdb</span>(), <span class="at">dbdir =</span> <span class="st">"my-db.duckdb"</span>, <span class="at">read_only =</span> <span class="cn">FALSE</span>)</span>
<span id="cb162-52"><a href="#cb162-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Write the iris and mtcars dataframes to the database as tables.</span></span>
<span id="cb162-53"><a href="#cb162-53" aria-hidden="true" tabindex="-1"></a><span class="fu">dbWriteTable</span>(con, <span class="st">"iris_table"</span>, iris, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span>
<span id="cb162-54"><a href="#cb162-54" aria-hidden="true" tabindex="-1"></a><span class="fu">dbWriteTable</span>(con, <span class="st">"mtcars_table"</span>, mtcars, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span>
<span id="cb162-55"><a href="#cb162-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-56"><a href="#cb162-56" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-57"><a href="#cb162-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-58"><a href="#cb162-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-61"><a href="#cb162-61" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-62"><a href="#cb162-62" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb162-63"><a href="#cb162-63" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb162-64"><a href="#cb162-64" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb162-65"><a href="#cb162-65" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb162-66"><a href="#cb162-66" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb162-67"><a href="#cb162-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-68"><a href="#cb162-68" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> platform <span class="im">import</span> python_version</span>
<span id="cb162-69"><a href="#cb162-69" aria-hidden="true" tabindex="-1"></a><span class="co">#print(python_version())</span></span>
<span id="cb162-70"><a href="#cb162-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-71"><a href="#cb162-71" aria-hidden="true" tabindex="-1"></a>cities_pd <span class="op">=</span> pd.DataFrame({</span>
<span id="cb162-72"><a href="#cb162-72" aria-hidden="true" tabindex="-1"></a>    <span class="st">'country'</span>: [<span class="st">'NL'</span>, <span class="st">'NL'</span>, <span class="st">'NL'</span>, <span class="st">'US'</span>, <span class="st">'US'</span>, <span class="st">'US'</span>, <span class="st">'US'</span>, <span class="st">'US'</span>, <span class="st">'US'</span>],</span>
<span id="cb162-73"><a href="#cb162-73" aria-hidden="true" tabindex="-1"></a>    <span class="st">'name'</span>: [<span class="st">'Amsterdam'</span>, <span class="st">'Amsterdam'</span>, <span class="st">'Amsterdam'</span>, <span class="st">'Seattle'</span>, <span class="st">'Seattle'</span>, <span class="st">'Seattle'</span>, <span class="st">'New York City'</span>, <span class="st">'New York City'</span>, <span class="st">'New York City'</span>],</span>
<span id="cb162-74"><a href="#cb162-74" aria-hidden="true" tabindex="-1"></a>    <span class="st">'year'</span>: [<span class="dv">2000</span>, <span class="dv">2010</span>, <span class="dv">2020</span>, <span class="dv">2000</span>, <span class="dv">2010</span>, <span class="dv">2020</span>, <span class="dv">2000</span>, <span class="dv">2010</span>, <span class="dv">2020</span>],</span>
<span id="cb162-75"><a href="#cb162-75" aria-hidden="true" tabindex="-1"></a>    <span class="st">'population'</span>: [<span class="dv">1005</span>, <span class="dv">1065</span>, <span class="dv">1158</span>, <span class="dv">564</span>, <span class="dv">608</span>, <span class="dv">738</span>, <span class="dv">8015</span>, <span class="dv">8175</span>, <span class="dv">8772</span>]</span>
<span id="cb162-76"><a href="#cb162-76" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb162-77"><a href="#cb162-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-78"><a href="#cb162-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the R dataframes available in the Python environment.</span></span>
<span id="cb162-79"><a href="#cb162-79" aria-hidden="true" tabindex="-1"></a>mtcars_pd <span class="op">=</span> r.mtcars</span>
<span id="cb162-80"><a href="#cb162-80" aria-hidden="true" tabindex="-1"></a>iris_pd <span class="op">=</span> r.iris</span>
<span id="cb162-81"><a href="#cb162-81" aria-hidden="true" tabindex="-1"></a>mtcars_pl <span class="op">=</span> pl.from_pandas(mtcars_pd)</span>
<span id="cb162-82"><a href="#cb162-82" aria-hidden="true" tabindex="-1"></a>iris_pl <span class="op">=</span> pl.from_pandas(iris_pd)</span>
<span id="cb162-83"><a href="#cb162-83" aria-hidden="true" tabindex="-1"></a>cities_pl<span class="op">=</span>pl.from_pandas(cities_pd)</span>
<span id="cb162-84"><a href="#cb162-84" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-85"><a href="#cb162-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-86"><a href="#cb162-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-87"><a href="#cb162-87" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>There are tables <span class="in">`iris_table`</span> and <span class="in">`mtcars_table`</span> in the DuckDB database <span class="in">`my-db.duckdb`</span>.</span>
<span id="cb162-88"><a href="#cb162-88" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>There are dataframes <span class="in">`iris`</span> and <span class="in">`mtcars`</span> in the R environment.</span>
<span id="cb162-89"><a href="#cb162-89" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>There are dataframes <span class="in">`iris`</span> and <span class="in">`mtcars`</span> in the Python environment.</span>
<span id="cb162-90"><a href="#cb162-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-91"><a href="#cb162-91" aria-hidden="true" tabindex="-1"></a><span class="fu"># Show All Tables</span></span>
<span id="cb162-92"><a href="#cb162-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-93"><a href="#cb162-93" aria-hidden="true" tabindex="-1"></a>This section demonstrates how to list all available tables or dataframes in each environment.</span>
<span id="cb162-94"><a href="#cb162-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-95"><a href="#cb162-95" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb162-96"><a href="#cb162-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-97"><a href="#cb162-97" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb162-98"><a href="#cb162-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-101"><a href="#cb162-101" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-102"><a href="#cb162-102" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-103"><a href="#cb162-103" aria-hidden="true" tabindex="-1"></a><span class="co">-- Show all tables in the connected database.</span></span>
<span id="cb162-104"><a href="#cb162-104" aria-hidden="true" tabindex="-1"></a><span class="kw">SHOW</span> <span class="kw">ALL</span> <span class="kw">TABLES</span>;</span>
<span id="cb162-105"><a href="#cb162-105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-106"><a href="#cb162-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-107"><a href="#cb162-107" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb162-108"><a href="#cb162-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-111"><a href="#cb162-111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb162-112"><a href="#cb162-112" aria-hidden="true" tabindex="-1"></a><span class="co"># List all dataframes in the current R environment.</span></span>
<span id="cb162-113"><a href="#cb162-113" aria-hidden="true" tabindex="-1"></a>dflist <span class="ot">&lt;-</span> <span class="fu">Filter</span>(is.data.frame, <span class="fu">as.list</span>(.GlobalEnv))</span>
<span id="cb162-114"><a href="#cb162-114" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dflist)</span>
<span id="cb162-115"><a href="#cb162-115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-116"><a href="#cb162-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-117"><a href="#cb162-117" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb162-118"><a href="#cb162-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-121"><a href="#cb162-121" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-122"><a href="#cb162-122" aria-hidden="true" tabindex="-1"></a><span class="co"># List all pandas dataframes in the current Python environment.</span></span>
<span id="cb162-123"><a href="#cb162-123" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb162-124"><a href="#cb162-124" aria-hidden="true" tabindex="-1"></a>alldfs <span class="op">=</span> [var <span class="cf">for</span> var <span class="kw">in</span> <span class="bu">dir</span>() <span class="cf">if</span> <span class="bu">isinstance</span>(<span class="bu">eval</span>(var), pd.core.frame.DataFrame)]</span>
<span id="cb162-125"><a href="#cb162-125" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alldfs)</span>
<span id="cb162-126"><a href="#cb162-126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-127"><a href="#cb162-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-128"><a href="#cb162-128" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb162-129"><a href="#cb162-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-132"><a href="#cb162-132" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-133"><a href="#cb162-133" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb162-134"><a href="#cb162-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-135"><a href="#cb162-135" aria-hidden="true" tabindex="-1"></a>alldfs <span class="op">=</span> [name <span class="cf">for</span> name, val <span class="kw">in</span> <span class="bu">globals</span>().items() <span class="cf">if</span> <span class="bu">isinstance</span>(val, pl.DataFrame)]</span>
<span id="cb162-136"><a href="#cb162-136" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alldfs)</span>
<span id="cb162-137"><a href="#cb162-137" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-138"><a href="#cb162-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-139"><a href="#cb162-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-140"><a href="#cb162-140" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb162-141"><a href="#cb162-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-142"><a href="#cb162-142" aria-hidden="true" tabindex="-1"></a><span class="fu"># Describe a Table</span></span>
<span id="cb162-143"><a href="#cb162-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-144"><a href="#cb162-144" aria-hidden="true" tabindex="-1"></a>This section shows how to get a summary of a table's structure and statistics.</span>
<span id="cb162-145"><a href="#cb162-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-146"><a href="#cb162-146" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb162-147"><a href="#cb162-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-148"><a href="#cb162-148" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb162-149"><a href="#cb162-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-152"><a href="#cb162-152" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-153"><a href="#cb162-153" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-154"><a href="#cb162-154" aria-hidden="true" tabindex="-1"></a><span class="co">-- Describe the columns and data types of the mtcars_table.</span></span>
<span id="cb162-155"><a href="#cb162-155" aria-hidden="true" tabindex="-1"></a><span class="kw">DESCRIBE</span> mtcars_table;</span>
<span id="cb162-156"><a href="#cb162-156" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-157"><a href="#cb162-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-158"><a href="#cb162-158" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb162-159"><a href="#cb162-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-162"><a href="#cb162-162" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb162-163"><a href="#cb162-163" aria-hidden="true" tabindex="-1"></a><span class="co"># Provide a detailed summary of the mtcars dataframe.</span></span>
<span id="cb162-164"><a href="#cb162-164" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(mtcars)</span>
<span id="cb162-165"><a href="#cb162-165" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-166"><a href="#cb162-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-167"><a href="#cb162-167" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb162-168"><a href="#cb162-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-171"><a href="#cb162-171" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-172"><a href="#cb162-172" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate descriptive statistics for the mtcars dataframe.</span></span>
<span id="cb162-173"><a href="#cb162-173" aria-hidden="true" tabindex="-1"></a>mtcars_pd.describe(include<span class="op">=</span><span class="st">'all'</span>)</span>
<span id="cb162-174"><a href="#cb162-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-175"><a href="#cb162-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-176"><a href="#cb162-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-177"><a href="#cb162-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-178"><a href="#cb162-178" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb162-179"><a href="#cb162-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-182"><a href="#cb162-182" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-183"><a href="#cb162-183" aria-hidden="true" tabindex="-1"></a>mtcars_pl.describe()</span>
<span id="cb162-184"><a href="#cb162-184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-185"><a href="#cb162-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-186"><a href="#cb162-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-187"><a href="#cb162-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-188"><a href="#cb162-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-189"><a href="#cb162-189" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb162-190"><a href="#cb162-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-191"><a href="#cb162-191" aria-hidden="true" tabindex="-1"></a><span class="fu"># Show Column Names</span></span>
<span id="cb162-192"><a href="#cb162-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-193"><a href="#cb162-193" aria-hidden="true" tabindex="-1"></a>This section demonstrates how to retrieve the column names of a table.</span>
<span id="cb162-194"><a href="#cb162-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-195"><a href="#cb162-195" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb162-196"><a href="#cb162-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-197"><a href="#cb162-197" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb162-198"><a href="#cb162-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-201"><a href="#cb162-201" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-202"><a href="#cb162-202" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-203"><a href="#cb162-203" aria-hidden="true" tabindex="-1"></a><span class="co">-- Show information about the columns in mtcars_table.</span></span>
<span id="cb162-204"><a href="#cb162-204" aria-hidden="true" tabindex="-1"></a>PRAGMA table_info(mtcars_table);</span>
<span id="cb162-205"><a href="#cb162-205" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-206"><a href="#cb162-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-207"><a href="#cb162-207" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb162-208"><a href="#cb162-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-211"><a href="#cb162-211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb162-212"><a href="#cb162-212" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the names of the columns in the mtcars dataframe.</span></span>
<span id="cb162-213"><a href="#cb162-213" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mtcars)</span>
<span id="cb162-214"><a href="#cb162-214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-215"><a href="#cb162-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-216"><a href="#cb162-216" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb162-217"><a href="#cb162-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-220"><a href="#cb162-220" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-221"><a href="#cb162-221" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a list of column names from the mtcars dataframe.</span></span>
<span id="cb162-222"><a href="#cb162-222" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb162-223"><a href="#cb162-223" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(mtcars_pd.columns.values)</span>
<span id="cb162-224"><a href="#cb162-224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-225"><a href="#cb162-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-226"><a href="#cb162-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-227"><a href="#cb162-227" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb162-228"><a href="#cb162-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-231"><a href="#cb162-231" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-232"><a href="#cb162-232" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a list of column names from the mtcars dataframe.</span></span>
<span id="cb162-233"><a href="#cb162-233" aria-hidden="true" tabindex="-1"></a>mtcars_pl.columns</span>
<span id="cb162-234"><a href="#cb162-234" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-235"><a href="#cb162-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-236"><a href="#cb162-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-237"><a href="#cb162-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-238"><a href="#cb162-238" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb162-239"><a href="#cb162-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-240"><a href="#cb162-240" aria-hidden="true" tabindex="-1"></a><span class="fu"># Select</span></span>
<span id="cb162-241"><a href="#cb162-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-242"><a href="#cb162-242" aria-hidden="true" tabindex="-1"></a><span class="fu">## Select Top 6 and Rename</span></span>
<span id="cb162-243"><a href="#cb162-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-244"><a href="#cb162-244" aria-hidden="true" tabindex="-1"></a>This section shows how to select a subset of columns, rename them, and limit the number of rows returned.</span>
<span id="cb162-245"><a href="#cb162-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-246"><a href="#cb162-246" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb162-247"><a href="#cb162-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-248"><a href="#cb162-248" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb162-249"><a href="#cb162-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-252"><a href="#cb162-252" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-253"><a href="#cb162-253" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-254"><a href="#cb162-254" aria-hidden="true" tabindex="-1"></a><span class="co">-- Select and rename columns, limiting the result to the top 6 rows.</span></span>
<span id="cb162-255"><a href="#cb162-255" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name <span class="kw">as</span> model, mpg, cyl <span class="kw">FROM</span> mtcars_table <span class="kw">LIMIT</span> <span class="dv">6</span>;</span>
<span id="cb162-256"><a href="#cb162-256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-257"><a href="#cb162-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-258"><a href="#cb162-258" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb162-259"><a href="#cb162-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-262"><a href="#cb162-262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb162-263"><a href="#cb162-263" aria-hidden="true" tabindex="-1"></a><span class="co"># Select and rename columns from the first 6 rows of the mtcars dataframe.</span></span>
<span id="cb162-264"><a href="#cb162-264" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars, <span class="dv">6</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="at">model =</span> model_name, mpg, cyl)</span>
<span id="cb162-265"><a href="#cb162-265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-266"><a href="#cb162-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-267"><a href="#cb162-267" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb162-268"><a href="#cb162-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-271"><a href="#cb162-271" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-272"><a href="#cb162-272" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename a column in the mtcars dataframe.</span></span>
<span id="cb162-273"><a href="#cb162-273" aria-hidden="true" tabindex="-1"></a>mtcars_pd.rename(columns<span class="op">=</span>{<span class="st">'model_name'</span>: <span class="st">'model'</span>})</span>
<span id="cb162-274"><a href="#cb162-274" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-275"><a href="#cb162-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-276"><a href="#cb162-276" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb162-277"><a href="#cb162-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-280"><a href="#cb162-280" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-281"><a href="#cb162-281" aria-hidden="true" tabindex="-1"></a>mtcars_pl.select(pl.col(<span class="st">"model_name"</span>).alias(<span class="st">"model"</span>), pl.col(<span class="st">"mpg"</span>), pl.col(<span class="st">"cyl"</span>)).head(<span class="dv">6</span>)</span>
<span id="cb162-282"><a href="#cb162-282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-283"><a href="#cb162-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-284"><a href="#cb162-284" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb162-285"><a href="#cb162-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-286"><a href="#cb162-286" aria-hidden="true" tabindex="-1"></a><span class="fu">## Select Distinct</span></span>
<span id="cb162-287"><a href="#cb162-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-288"><a href="#cb162-288" aria-hidden="true" tabindex="-1"></a>This section demonstrates how to retrieve unique rows based on specified columns.</span>
<span id="cb162-289"><a href="#cb162-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-290"><a href="#cb162-290" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb162-291"><a href="#cb162-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-292"><a href="#cb162-292" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb162-293"><a href="#cb162-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-296"><a href="#cb162-296" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-297"><a href="#cb162-297" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-298"><a href="#cb162-298" aria-hidden="true" tabindex="-1"></a><span class="co">-- Select distinct combinations of mpg and cyl.</span></span>
<span id="cb162-299"><a href="#cb162-299" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span> mpg, cyl <span class="kw">FROM</span> mtcars_table;</span>
<span id="cb162-300"><a href="#cb162-300" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-301"><a href="#cb162-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-302"><a href="#cb162-302" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb162-303"><a href="#cb162-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-306"><a href="#cb162-306" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb162-307"><a href="#cb162-307" aria-hidden="true" tabindex="-1"></a><span class="co"># Get distinct rows based on mpg and cyl.</span></span>
<span id="cb162-308"><a href="#cb162-308" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">distinct</span>(mpg, cyl)</span>
<span id="cb162-309"><a href="#cb162-309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-310"><a href="#cb162-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-311"><a href="#cb162-311" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb162-312"><a href="#cb162-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-315"><a href="#cb162-315" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-316"><a href="#cb162-316" aria-hidden="true" tabindex="-1"></a><span class="co"># Select specific columns and drop duplicate rows.</span></span>
<span id="cb162-317"><a href="#cb162-317" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> mtcars_pd[[<span class="st">"mpg"</span>, <span class="st">"cyl"</span>]]</span>
<span id="cb162-318"><a href="#cb162-318" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.drop_duplicates())</span>
<span id="cb162-319"><a href="#cb162-319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-320"><a href="#cb162-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-321"><a href="#cb162-321" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb162-322"><a href="#cb162-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-325"><a href="#cb162-325" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-326"><a href="#cb162-326" aria-hidden="true" tabindex="-1"></a>mtcars_pl.select(pl.col(<span class="st">"mpg"</span>), pl.col(<span class="st">"cyl"</span>)).unique()</span>
<span id="cb162-327"><a href="#cb162-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-328"><a href="#cb162-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-329"><a href="#cb162-329" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb162-330"><a href="#cb162-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-331"><a href="#cb162-331" aria-hidden="true" tabindex="-1"></a><span class="fu"># Check Row and Column Number</span></span>
<span id="cb162-332"><a href="#cb162-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-333"><a href="#cb162-333" aria-hidden="true" tabindex="-1"></a>This section shows how to find the dimensions of a table.</span>
<span id="cb162-334"><a href="#cb162-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-335"><a href="#cb162-335" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb162-336"><a href="#cb162-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-337"><a href="#cb162-337" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb162-338"><a href="#cb162-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-341"><a href="#cb162-341" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-342"><a href="#cb162-342" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-343"><a href="#cb162-343" aria-hidden="true" tabindex="-1"></a><span class="co">-- Get the total number of rows.</span></span>
<span id="cb162-344"><a href="#cb162-344" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">AS</span> row_number <span class="kw">FROM</span> mtcars_table;</span>
<span id="cb162-345"><a href="#cb162-345" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-346"><a href="#cb162-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-349"><a href="#cb162-349" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-350"><a href="#cb162-350" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-351"><a href="#cb162-351" aria-hidden="true" tabindex="-1"></a><span class="co">-- Get the total number of columns.</span></span>
<span id="cb162-352"><a href="#cb162-352" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">AS</span> column_number <span class="kw">FROM</span> (<span class="kw">DESCRIBE</span> mtcars_table);</span>
<span id="cb162-353"><a href="#cb162-353" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-354"><a href="#cb162-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-355"><a href="#cb162-355" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb162-356"><a href="#cb162-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-359"><a href="#cb162-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb162-360"><a href="#cb162-360" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the number of rows.</span></span>
<span id="cb162-361"><a href="#cb162-361" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(mtcars)</span>
<span id="cb162-362"><a href="#cb162-362" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-363"><a href="#cb162-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-366"><a href="#cb162-366" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb162-367"><a href="#cb162-367" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the number of columns.</span></span>
<span id="cb162-368"><a href="#cb162-368" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(mtcars)</span>
<span id="cb162-369"><a href="#cb162-369" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-370"><a href="#cb162-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-371"><a href="#cb162-371" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb162-372"><a href="#cb162-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-375"><a href="#cb162-375" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-376"><a href="#cb162-376" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the number of rows.</span></span>
<span id="cb162-377"><a href="#cb162-377" aria-hidden="true" tabindex="-1"></a>mtcars_pd.shape[<span class="dv">0</span>]</span>
<span id="cb162-378"><a href="#cb162-378" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-379"><a href="#cb162-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-382"><a href="#cb162-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-383"><a href="#cb162-383" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the number of columns.</span></span>
<span id="cb162-384"><a href="#cb162-384" aria-hidden="true" tabindex="-1"></a>mtcars_pd.shape[<span class="dv">1</span>]</span>
<span id="cb162-385"><a href="#cb162-385" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-386"><a href="#cb162-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-387"><a href="#cb162-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-388"><a href="#cb162-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-389"><a href="#cb162-389" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb162-390"><a href="#cb162-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-393"><a href="#cb162-393" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-394"><a href="#cb162-394" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the number of rows.</span></span>
<span id="cb162-395"><a href="#cb162-395" aria-hidden="true" tabindex="-1"></a>mtcars_pl.shape[<span class="dv">0</span>]</span>
<span id="cb162-396"><a href="#cb162-396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-397"><a href="#cb162-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-400"><a href="#cb162-400" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-401"><a href="#cb162-401" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the number of columns.</span></span>
<span id="cb162-402"><a href="#cb162-402" aria-hidden="true" tabindex="-1"></a>mtcars_pl.shape[<span class="dv">1</span>]</span>
<span id="cb162-403"><a href="#cb162-403" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-404"><a href="#cb162-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-405"><a href="#cb162-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-406"><a href="#cb162-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-407"><a href="#cb162-407" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb162-408"><a href="#cb162-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-409"><a href="#cb162-409" aria-hidden="true" tabindex="-1"></a><span class="fu"># Create Column</span></span>
<span id="cb162-410"><a href="#cb162-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-411"><a href="#cb162-411" aria-hidden="true" tabindex="-1"></a>This section demonstrates how to add a new column to a table based on existing data.</span>
<span id="cb162-412"><a href="#cb162-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-413"><a href="#cb162-413" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb162-414"><a href="#cb162-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-415"><a href="#cb162-415" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb162-416"><a href="#cb162-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-419"><a href="#cb162-419" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-420"><a href="#cb162-420" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-421"><a href="#cb162-421" aria-hidden="true" tabindex="-1"></a><span class="co">-- Create a new column by performing a calculation on an existing column.</span></span>
<span id="cb162-422"><a href="#cb162-422" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span>, mpg <span class="op">+</span> <span class="dv">1</span> <span class="kw">AS</span> new_mpg <span class="kw">FROM</span> mtcars_table;</span>
<span id="cb162-423"><a href="#cb162-423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-424"><a href="#cb162-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-425"><a href="#cb162-425" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb162-426"><a href="#cb162-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-429"><a href="#cb162-429" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb162-430"><a href="#cb162-430" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new column to the dataframe.</span></span>
<span id="cb162-431"><a href="#cb162-431" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">new_mpg =</span> mpg <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb162-432"><a href="#cb162-432" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-433"><a href="#cb162-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-434"><a href="#cb162-434" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb162-435"><a href="#cb162-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-438"><a href="#cb162-438" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-439"><a href="#cb162-439" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column in the dataframe.</span></span>
<span id="cb162-440"><a href="#cb162-440" aria-hidden="true" tabindex="-1"></a>mtcars_pd[<span class="st">"new_mpg"</span>] <span class="op">=</span> mtcars_pd[<span class="st">"mpg"</span>] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb162-441"><a href="#cb162-441" aria-hidden="true" tabindex="-1"></a>mtcars_pd</span>
<span id="cb162-442"><a href="#cb162-442" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-443"><a href="#cb162-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-444"><a href="#cb162-444" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb162-445"><a href="#cb162-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-448"><a href="#cb162-448" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-449"><a href="#cb162-449" aria-hidden="true" tabindex="-1"></a>mtcars_pl.with_columns((pl.col(<span class="st">"mpg"</span>) <span class="op">+</span> <span class="dv">1</span>).alias(<span class="st">"new_mpg"</span>))</span>
<span id="cb162-450"><a href="#cb162-450" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-451"><a href="#cb162-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-452"><a href="#cb162-452" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb162-453"><a href="#cb162-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-454"><a href="#cb162-454" aria-hidden="true" tabindex="-1"></a><span class="fu"># Filter</span></span>
<span id="cb162-455"><a href="#cb162-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-456"><a href="#cb162-456" aria-hidden="true" tabindex="-1"></a>This section shows how to select rows that meet specific criteria.</span>
<span id="cb162-457"><a href="#cb162-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-458"><a href="#cb162-458" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb162-459"><a href="#cb162-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-460"><a href="#cb162-460" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb162-461"><a href="#cb162-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-464"><a href="#cb162-464" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-465"><a href="#cb162-465" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-466"><a href="#cb162-466" aria-hidden="true" tabindex="-1"></a><span class="co">-- Use the AND operator to filter rows based on multiple conditions.</span></span>
<span id="cb162-467"><a href="#cb162-467" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> mpg <span class="op">=</span> <span class="dv">21</span> <span class="kw">AND</span> cyl <span class="op">=</span> <span class="dv">6</span>;</span>
<span id="cb162-468"><a href="#cb162-468" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-469"><a href="#cb162-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-472"><a href="#cb162-472" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-473"><a href="#cb162-473" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-474"><a href="#cb162-474" aria-hidden="true" tabindex="-1"></a><span class="co">-- Use the OR operator to filter rows.</span></span>
<span id="cb162-475"><a href="#cb162-475" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> mpg <span class="op">=</span> <span class="dv">21</span> <span class="kw">OR</span> cyl <span class="op">=</span> <span class="dv">6</span>;</span>
<span id="cb162-476"><a href="#cb162-476" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-477"><a href="#cb162-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-478"><a href="#cb162-478" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb162-479"><a href="#cb162-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-482"><a href="#cb162-482" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb162-483"><a href="#cb162-483" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the &amp; operator for "and" filtering.</span></span>
<span id="cb162-484"><a href="#cb162-484" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(mpg <span class="sc">==</span> <span class="dv">21</span> <span class="sc">&amp;</span> cyl <span class="sc">==</span> <span class="dv">6</span>)</span>
<span id="cb162-485"><a href="#cb162-485" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-486"><a href="#cb162-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-489"><a href="#cb162-489" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb162-490"><a href="#cb162-490" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the | operator for "or" filtering.</span></span>
<span id="cb162-491"><a href="#cb162-491" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(mpg <span class="sc">==</span> <span class="dv">21</span> <span class="sc">|</span> cyl <span class="sc">==</span> <span class="dv">6</span>)</span>
<span id="cb162-492"><a href="#cb162-492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-493"><a href="#cb162-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-494"><a href="#cb162-494" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb162-495"><a href="#cb162-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-498"><a href="#cb162-498" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-499"><a href="#cb162-499" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the query method for "and" filtering.</span></span>
<span id="cb162-500"><a href="#cb162-500" aria-hidden="true" tabindex="-1"></a>mtcars_pd.query(<span class="st">'mpg == 21 and cyl == 6'</span>)</span>
<span id="cb162-501"><a href="#cb162-501" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-502"><a href="#cb162-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-505"><a href="#cb162-505" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-506"><a href="#cb162-506" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the query method for "or" filtering.</span></span>
<span id="cb162-507"><a href="#cb162-507" aria-hidden="true" tabindex="-1"></a>mtcars_pd.query(<span class="st">'mpg == 21 or cyl == 6'</span>)</span>
<span id="cb162-508"><a href="#cb162-508" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-509"><a href="#cb162-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-510"><a href="#cb162-510" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb162-511"><a href="#cb162-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-514"><a href="#cb162-514" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-515"><a href="#cb162-515" aria-hidden="true" tabindex="-1"></a><span class="co"># "and" filtering with polars</span></span>
<span id="cb162-516"><a href="#cb162-516" aria-hidden="true" tabindex="-1"></a>mtcars_pl.<span class="bu">filter</span>((pl.col(<span class="st">"mpg"</span>) <span class="op">==</span> <span class="dv">21</span>) <span class="op">&amp;</span> (pl.col(<span class="st">"cyl"</span>) <span class="op">==</span> <span class="dv">6</span>))</span>
<span id="cb162-517"><a href="#cb162-517" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-518"><a href="#cb162-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-521"><a href="#cb162-521" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-522"><a href="#cb162-522" aria-hidden="true" tabindex="-1"></a><span class="co"># "or" filtering with polars</span></span>
<span id="cb162-523"><a href="#cb162-523" aria-hidden="true" tabindex="-1"></a>mtcars_pl.<span class="bu">filter</span>((pl.col(<span class="st">"mpg"</span>) <span class="op">==</span> <span class="dv">21</span>) <span class="op">|</span> (pl.col(<span class="st">"cyl"</span>) <span class="op">==</span> <span class="dv">6</span>))</span>
<span id="cb162-524"><a href="#cb162-524" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-525"><a href="#cb162-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-526"><a href="#cb162-526" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb162-527"><a href="#cb162-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-528"><a href="#cb162-528" aria-hidden="true" tabindex="-1"></a><span class="fu"># Order</span></span>
<span id="cb162-529"><a href="#cb162-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-530"><a href="#cb162-530" aria-hidden="true" tabindex="-1"></a>This section demonstrates how to sort a table based on one or more columns.</span>
<span id="cb162-531"><a href="#cb162-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-532"><a href="#cb162-532" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb162-533"><a href="#cb162-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-534"><a href="#cb162-534" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb162-535"><a href="#cb162-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-538"><a href="#cb162-538" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-539"><a href="#cb162-539" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-540"><a href="#cb162-540" aria-hidden="true" tabindex="-1"></a><span class="co">-- Order the results by mpg in descending order and show the top 3.</span></span>
<span id="cb162-541"><a href="#cb162-541" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name <span class="kw">AS</span> model, mpg, cyl <span class="kw">FROM</span> mtcars_table <span class="kw">ORDER</span> <span class="kw">BY</span> mpg <span class="kw">DESC</span> <span class="kw">LIMIT</span> <span class="dv">3</span>;</span>
<span id="cb162-542"><a href="#cb162-542" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-543"><a href="#cb162-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-544"><a href="#cb162-544" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb162-545"><a href="#cb162-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-548"><a href="#cb162-548" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb162-549"><a href="#cb162-549" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange the dataframe by mpg in descending order.</span></span>
<span id="cb162-550"><a href="#cb162-550" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="at">model =</span> model_name, mpg, cyl) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(mpg)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">3</span>)</span>
<span id="cb162-551"><a href="#cb162-551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-552"><a href="#cb162-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-553"><a href="#cb162-553" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb162-554"><a href="#cb162-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-557"><a href="#cb162-557" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-558"><a href="#cb162-558" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort the dataframe by mpg in descending order.</span></span>
<span id="cb162-559"><a href="#cb162-559" aria-hidden="true" tabindex="-1"></a>mtcars_pd[[<span class="st">"model_name"</span>, <span class="st">"mpg"</span>, <span class="st">"cyl"</span>]].sort_values(by<span class="op">=</span><span class="st">'mpg'</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">3</span>)</span>
<span id="cb162-560"><a href="#cb162-560" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-561"><a href="#cb162-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-562"><a href="#cb162-562" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb162-563"><a href="#cb162-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-566"><a href="#cb162-566" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-567"><a href="#cb162-567" aria-hidden="true" tabindex="-1"></a>mtcars_pl.select(<span class="st">"model_name"</span>, <span class="st">"mpg"</span>, <span class="st">"cyl"</span>).sort(<span class="st">"mpg"</span>, descending<span class="op">=</span><span class="va">True</span>).head(<span class="dv">3</span>)</span>
<span id="cb162-568"><a href="#cb162-568" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-569"><a href="#cb162-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-570"><a href="#cb162-570" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb162-571"><a href="#cb162-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-572"><a href="#cb162-572" aria-hidden="true" tabindex="-1"></a><span class="fu"># Group By</span></span>
<span id="cb162-573"><a href="#cb162-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-574"><a href="#cb162-574" aria-hidden="true" tabindex="-1"></a>This section shows how to group rows and perform aggregate calculations.</span>
<span id="cb162-575"><a href="#cb162-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-576"><a href="#cb162-576" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb162-577"><a href="#cb162-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-578"><a href="#cb162-578" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb162-579"><a href="#cb162-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-582"><a href="#cb162-582" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-583"><a href="#cb162-583" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-584"><a href="#cb162-584" aria-hidden="true" tabindex="-1"></a><span class="co">-- Group by model_name and calculate the sum of mpg and the mean of cyl.</span></span>
<span id="cb162-585"><a href="#cb162-585" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, <span class="fu">sum</span>(mpg) <span class="kw">AS</span> total_mpg, mean(cyl) <span class="kw">AS</span> cyl_mean <span class="kw">FROM</span> mtcars_table</span>
<span id="cb162-586"><a href="#cb162-586" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> <span class="dv">1</span> <span class="kw">LIMIT</span> <span class="dv">5</span>;</span>
<span id="cb162-587"><a href="#cb162-587" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-588"><a href="#cb162-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-589"><a href="#cb162-589" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb162-590"><a href="#cb162-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-593"><a href="#cb162-593" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb162-594"><a href="#cb162-594" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by model_name and summarize the data.</span></span>
<span id="cb162-595"><a href="#cb162-595" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">group_by</span>(model_name) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="at">total_mpg =</span> <span class="fu">sum</span>(mpg), <span class="at">cyl_mean =</span> <span class="fu">mean</span>(cyl)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>)</span>
<span id="cb162-596"><a href="#cb162-596" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-597"><a href="#cb162-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-598"><a href="#cb162-598" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb162-599"><a href="#cb162-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-602"><a href="#cb162-602" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-603"><a href="#cb162-603" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by model_name and aggregate the data.</span></span>
<span id="cb162-604"><a href="#cb162-604" aria-hidden="true" tabindex="-1"></a>mtcars_pd.groupby(<span class="st">'model_name'</span>).agg({<span class="st">'mpg'</span>: <span class="st">'sum'</span>, <span class="st">'cyl'</span>: <span class="st">'mean'</span>}).head(<span class="dv">5</span>)</span>
<span id="cb162-605"><a href="#cb162-605" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-606"><a href="#cb162-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-607"><a href="#cb162-607" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb162-608"><a href="#cb162-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-611"><a href="#cb162-611" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-612"><a href="#cb162-612" aria-hidden="true" tabindex="-1"></a>mtcars_pl.group_by(<span class="st">"model_name"</span>).agg([</span>
<span id="cb162-613"><a href="#cb162-613" aria-hidden="true" tabindex="-1"></a>    pl.<span class="bu">sum</span>(<span class="st">"mpg"</span>).alias(<span class="st">"total_mpg"</span>),</span>
<span id="cb162-614"><a href="#cb162-614" aria-hidden="true" tabindex="-1"></a>    pl.mean(<span class="st">"cyl"</span>).alias(<span class="st">"cyl_mean"</span>)</span>
<span id="cb162-615"><a href="#cb162-615" aria-hidden="true" tabindex="-1"></a>]).head(<span class="dv">5</span>)</span>
<span id="cb162-616"><a href="#cb162-616" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-617"><a href="#cb162-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-618"><a href="#cb162-618" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb162-619"><a href="#cb162-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-620"><a href="#cb162-620" aria-hidden="true" tabindex="-1"></a><span class="fu"># Create Table</span></span>
<span id="cb162-621"><a href="#cb162-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-622"><a href="#cb162-622" aria-hidden="true" tabindex="-1"></a><span class="fu">## CREATE OR REPLACE</span></span>
<span id="cb162-623"><a href="#cb162-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-624"><a href="#cb162-624" aria-hidden="true" tabindex="-1"></a>This command creates a new table or overwrites an existing one.</span>
<span id="cb162-625"><a href="#cb162-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-628"><a href="#cb162-628" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-629"><a href="#cb162-629" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-630"><a href="#cb162-630" aria-hidden="true" tabindex="-1"></a><span class="co">-- Create a temporary table, replacing it if it already exists.</span></span>
<span id="cb162-631"><a href="#cb162-631" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">OR</span> <span class="kw">REPLACE</span> TEMP <span class="kw">TABLE</span> mtcars_table_group <span class="kw">AS</span></span>
<span id="cb162-632"><a href="#cb162-632" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, <span class="fu">sum</span>(mpg) <span class="kw">AS</span> total_mpg, mean(cyl) <span class="kw">AS</span> cyl_mean <span class="kw">FROM</span> mtcars_table</span>
<span id="cb162-633"><a href="#cb162-633" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> <span class="dv">1</span>;</span>
<span id="cb162-634"><a href="#cb162-634" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-635"><a href="#cb162-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-636"><a href="#cb162-636" aria-hidden="true" tabindex="-1"></a><span class="fu">## CREATE TABLE IF NOT EXISTS</span></span>
<span id="cb162-637"><a href="#cb162-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-638"><a href="#cb162-638" aria-hidden="true" tabindex="-1"></a>This command creates a table only if it does not already exist.</span>
<span id="cb162-639"><a href="#cb162-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-642"><a href="#cb162-642" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-643"><a href="#cb162-643" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-644"><a href="#cb162-644" aria-hidden="true" tabindex="-1"></a><span class="co">-- Create a new table only if it does not already exist.</span></span>
<span id="cb162-645"><a href="#cb162-645" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">NOT</span> <span class="kw">EXISTS</span> new_mtcars_table_group <span class="kw">AS</span></span>
<span id="cb162-646"><a href="#cb162-646" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, <span class="fu">sum</span>(mpg) <span class="kw">AS</span> total_mpg, mean(cyl) <span class="kw">AS</span> cyl_mean <span class="kw">FROM</span> mtcars_table</span>
<span id="cb162-647"><a href="#cb162-647" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> <span class="dv">1</span>;</span>
<span id="cb162-648"><a href="#cb162-648" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-649"><a href="#cb162-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-650"><a href="#cb162-650" aria-hidden="true" tabindex="-1"></a><span class="fu"># Unique</span></span>
<span id="cb162-651"><a href="#cb162-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-652"><a href="#cb162-652" aria-hidden="true" tabindex="-1"></a><span class="fu">## Check Unique</span></span>
<span id="cb162-653"><a href="#cb162-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-654"><a href="#cb162-654" aria-hidden="true" tabindex="-1"></a>This section demonstrates how to verify the uniqueness of values in a column.</span>
<span id="cb162-655"><a href="#cb162-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-656"><a href="#cb162-656" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb162-657"><a href="#cb162-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-658"><a href="#cb162-658" aria-hidden="true" tabindex="-1"></a><span class="fu">### SQL</span></span>
<span id="cb162-659"><a href="#cb162-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-662"><a href="#cb162-662" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-663"><a href="#cb162-663" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-664"><a href="#cb162-664" aria-hidden="true" tabindex="-1"></a><span class="co">-- Count the total number of rows and the number of distinct model names.</span></span>
<span id="cb162-665"><a href="#cb162-665" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>), <span class="fu">count</span>(<span class="kw">DISTINCT</span> model_name) <span class="kw">FROM</span> mtcars_table;</span>
<span id="cb162-666"><a href="#cb162-666" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-667"><a href="#cb162-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-668"><a href="#cb162-668" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python pandas</span></span>
<span id="cb162-669"><a href="#cb162-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-672"><a href="#cb162-672" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-673"><a href="#cb162-673" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the total number of rows and the number of distinct model names.</span></span>
<span id="cb162-674"><a href="#cb162-674" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(mtcars_pd), mtcars_pd.model_name.nunique())</span>
<span id="cb162-675"><a href="#cb162-675" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-676"><a href="#cb162-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-677"><a href="#cb162-677" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python Polars</span></span>
<span id="cb162-678"><a href="#cb162-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-681"><a href="#cb162-681" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-682"><a href="#cb162-682" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the total number of rows and the number of distinct model names.</span></span>
<span id="cb162-683"><a href="#cb162-683" aria-hidden="true" tabindex="-1"></a>mtcars_pl.select(pl.count(), pl.col(<span class="st">"model_name"</span>).n_unique())</span>
<span id="cb162-684"><a href="#cb162-684" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-685"><a href="#cb162-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-686"><a href="#cb162-686" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb162-687"><a href="#cb162-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-688"><a href="#cb162-688" aria-hidden="true" tabindex="-1"></a><span class="fu">## Get Duplicate and Non-Duplicate Data</span></span>
<span id="cb162-689"><a href="#cb162-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-690"><a href="#cb162-690" aria-hidden="true" tabindex="-1"></a>This section demonstrates how to get duplicate and non-duplicate data based on a single column.</span>
<span id="cb162-691"><a href="#cb162-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-692"><a href="#cb162-692" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb162-693"><a href="#cb162-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-694"><a href="#cb162-694" aria-hidden="true" tabindex="-1"></a><span class="fu">### SQL</span></span>
<span id="cb162-695"><a href="#cb162-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-696"><a href="#cb162-696" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Show all Duplicate</span></span>
<span id="cb162-697"><a href="#cb162-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-700"><a href="#cb162-700" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-701"><a href="#cb162-701" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-702"><a href="#cb162-702" aria-hidden="true" tabindex="-1"></a><span class="co">-- Get duplicate rows based on the mpg column.</span></span>
<span id="cb162-703"><a href="#cb162-703" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> mpg <span class="kw">IN</span> (<span class="kw">SELECT</span> mpg <span class="kw">FROM</span> mtcars_table <span class="kw">GROUP</span> <span class="kw">BY</span> mpg <span class="kw">HAVING</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="op">&gt;</span> <span class="dv">1</span>);</span>
<span id="cb162-704"><a href="#cb162-704" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-705"><a href="#cb162-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-706"><a href="#cb162-706" aria-hidden="true" tabindex="-1"></a>keep non Duplicate</span>
<span id="cb162-707"><a href="#cb162-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-710"><a href="#cb162-710" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-711"><a href="#cb162-711" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-712"><a href="#cb162-712" aria-hidden="true" tabindex="-1"></a><span class="co">-- Get non-duplicate rows based on the mpg column.</span></span>
<span id="cb162-713"><a href="#cb162-713" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> mpg <span class="kw">IN</span> (<span class="kw">SELECT</span> mpg <span class="kw">FROM</span> mtcars_table <span class="kw">GROUP</span> <span class="kw">BY</span> mpg <span class="kw">HAVING</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="op">=</span> <span class="dv">1</span>);</span>
<span id="cb162-714"><a href="#cb162-714" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-715"><a href="#cb162-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-716"><a href="#cb162-716" aria-hidden="true" tabindex="-1"></a><span class="fu">### R</span></span>
<span id="cb162-717"><a href="#cb162-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-718"><a href="#cb162-718" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Show all Duplicate</span></span>
<span id="cb162-719"><a href="#cb162-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-720"><a href="#cb162-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-723"><a href="#cb162-723" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb162-724"><a href="#cb162-724" aria-hidden="true" tabindex="-1"></a><span class="co"># Get duplicate rows based on the mpg column.</span></span>
<span id="cb162-725"><a href="#cb162-725" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">duplicated</span>(mpg) <span class="sc">|</span> <span class="fu">duplicated</span>(mpg, <span class="at">fromLast =</span> <span class="cn">TRUE</span>))</span>
<span id="cb162-726"><a href="#cb162-726" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-727"><a href="#cb162-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-728"><a href="#cb162-728" aria-hidden="true" tabindex="-1"></a><span class="fu">#### keep non Duplicate</span></span>
<span id="cb162-729"><a href="#cb162-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-730"><a href="#cb162-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-733"><a href="#cb162-733" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb162-734"><a href="#cb162-734" aria-hidden="true" tabindex="-1"></a><span class="co"># Get non-duplicate rows based on the mpg column.</span></span>
<span id="cb162-735"><a href="#cb162-735" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">duplicated</span>(mpg) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">duplicated</span>(mpg, <span class="at">fromLast =</span> <span class="cn">TRUE</span>))</span>
<span id="cb162-736"><a href="#cb162-736" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-737"><a href="#cb162-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-738"><a href="#cb162-738" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python pandas</span></span>
<span id="cb162-739"><a href="#cb162-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-740"><a href="#cb162-740" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Show all Duplicate</span></span>
<span id="cb162-741"><a href="#cb162-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-742"><a href="#cb162-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-745"><a href="#cb162-745" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-746"><a href="#cb162-746" aria-hidden="true" tabindex="-1"></a><span class="co"># Get duplicate rows based on the mpg column.</span></span>
<span id="cb162-747"><a href="#cb162-747" aria-hidden="true" tabindex="-1"></a>mtcars_pd[mtcars_pd.duplicated(subset<span class="op">=</span>[<span class="st">'mpg'</span>], keep<span class="op">=</span><span class="va">False</span>)]</span>
<span id="cb162-748"><a href="#cb162-748" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-749"><a href="#cb162-749" aria-hidden="true" tabindex="-1"></a><span class="fu">#### keep non Duplicate</span></span>
<span id="cb162-750"><a href="#cb162-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-753"><a href="#cb162-753" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-754"><a href="#cb162-754" aria-hidden="true" tabindex="-1"></a><span class="co"># Get non-duplicate rows based on the mpg column.</span></span>
<span id="cb162-755"><a href="#cb162-755" aria-hidden="true" tabindex="-1"></a>mtcars_pd[<span class="op">~</span>mtcars_pd.duplicated(subset<span class="op">=</span>[<span class="st">'mpg'</span>], keep<span class="op">=</span><span class="va">False</span>)]</span>
<span id="cb162-756"><a href="#cb162-756" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-757"><a href="#cb162-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-758"><a href="#cb162-758" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python Polars</span></span>
<span id="cb162-759"><a href="#cb162-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-762"><a href="#cb162-762" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-763"><a href="#cb162-763" aria-hidden="true" tabindex="-1"></a><span class="co"># Get duplicate rows based on the mpg column.</span></span>
<span id="cb162-764"><a href="#cb162-764" aria-hidden="true" tabindex="-1"></a>mtcars_pl.<span class="bu">filter</span>(pl.col(<span class="st">"mpg"</span>).is_duplicated())</span>
<span id="cb162-765"><a href="#cb162-765" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-766"><a href="#cb162-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-767"><a href="#cb162-767" aria-hidden="true" tabindex="-1"></a><span class="fu">#### keep non Duplicate</span></span>
<span id="cb162-768"><a href="#cb162-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-771"><a href="#cb162-771" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-772"><a href="#cb162-772" aria-hidden="true" tabindex="-1"></a><span class="co"># Get non-duplicate rows based on the mpg column.</span></span>
<span id="cb162-773"><a href="#cb162-773" aria-hidden="true" tabindex="-1"></a>mtcars_pl.<span class="bu">filter</span>(pl.col(<span class="st">"mpg"</span>).is_unique())</span>
<span id="cb162-774"><a href="#cb162-774" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-775"><a href="#cb162-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-776"><a href="#cb162-776" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb162-777"><a href="#cb162-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-778"><a href="#cb162-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-779"><a href="#cb162-779" aria-hidden="true" tabindex="-1"></a><span class="fu"># Join</span></span>
<span id="cb162-780"><a href="#cb162-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-783"><a href="#cb162-783" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-784"><a href="#cb162-784" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-785"><a href="#cb162-785" aria-hidden="true" tabindex="-1"></a><span class="co">-- Select all data from the newly created temporary table.</span></span>
<span id="cb162-786"><a href="#cb162-786" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table_group t1;</span>
<span id="cb162-787"><a href="#cb162-787" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-788"><a href="#cb162-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-789"><a href="#cb162-789" aria-hidden="true" tabindex="-1"></a><span class="fu">## Left Join</span></span>
<span id="cb162-790"><a href="#cb162-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-791"><a href="#cb162-791" aria-hidden="true" tabindex="-1"></a>This section shows how to perform a left join to combine data from two tables.</span>
<span id="cb162-792"><a href="#cb162-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-793"><a href="#cb162-793" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb162-794"><a href="#cb162-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-795"><a href="#cb162-795" aria-hidden="true" tabindex="-1"></a><span class="fu"># SQL</span></span>
<span id="cb162-796"><a href="#cb162-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-799"><a href="#cb162-799" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-800"><a href="#cb162-800" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-801"><a href="#cb162-801" aria-hidden="true" tabindex="-1"></a><span class="co">-- Perform a left join between mtcars_table and mtcars_table_group.</span></span>
<span id="cb162-802"><a href="#cb162-802" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t1<span class="ch">.</span>model_name, t1<span class="ch">.</span>mpg, t1<span class="ch">.</span>cyl, t2<span class="ch">.</span><span class="op">*</span> <span class="kw">FROM</span> mtcars_table t1</span>
<span id="cb162-803"><a href="#cb162-803" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> mtcars_table_group t2 <span class="kw">ON</span> t1<span class="ch">.</span>model_name <span class="op">=</span> t2<span class="ch">.</span>model_name</span>
<span id="cb162-804"><a href="#cb162-804" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">5</span>;</span>
<span id="cb162-805"><a href="#cb162-805" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-806"><a href="#cb162-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-807"><a href="#cb162-807" aria-hidden="true" tabindex="-1"></a><span class="fu"># R</span></span>
<span id="cb162-808"><a href="#cb162-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-811"><a href="#cb162-811" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb162-812"><a href="#cb162-812" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a left join on the mtcars dataframe with itself.</span></span>
<span id="cb162-813"><a href="#cb162-813" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">left_join</span>(mtcars, <span class="at">by =</span> <span class="fu">join_by</span>(model_name <span class="sc">==</span> model_name)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>)</span>
<span id="cb162-814"><a href="#cb162-814" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-815"><a href="#cb162-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-816"><a href="#cb162-816" aria-hidden="true" tabindex="-1"></a><span class="fu"># Python pandas</span></span>
<span id="cb162-817"><a href="#cb162-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-820"><a href="#cb162-820" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-821"><a href="#cb162-821" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a left join using pandas.</span></span>
<span id="cb162-822"><a href="#cb162-822" aria-hidden="true" tabindex="-1"></a>pd.merge(mtcars_pd, mtcars_pd, left_on<span class="op">=</span><span class="st">'model_name'</span>, right_on<span class="op">=</span><span class="st">'model_name'</span>, how<span class="op">=</span><span class="st">'left'</span>).head(<span class="dv">5</span>)</span>
<span id="cb162-823"><a href="#cb162-823" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-824"><a href="#cb162-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-825"><a href="#cb162-825" aria-hidden="true" tabindex="-1"></a><span class="fu"># Python Polars</span></span>
<span id="cb162-826"><a href="#cb162-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-829"><a href="#cb162-829" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-830"><a href="#cb162-830" aria-hidden="true" tabindex="-1"></a>mtcars_pl.join(mtcars_pl, on<span class="op">=</span><span class="st">"model_name"</span>, how<span class="op">=</span><span class="st">"left"</span>).head(<span class="dv">5</span>)</span>
<span id="cb162-831"><a href="#cb162-831" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-832"><a href="#cb162-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-833"><a href="#cb162-833" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb162-834"><a href="#cb162-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-835"><a href="#cb162-835" aria-hidden="true" tabindex="-1"></a><span class="fu">## Inner Join</span></span>
<span id="cb162-836"><a href="#cb162-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-837"><a href="#cb162-837" aria-hidden="true" tabindex="-1"></a>This section demonstrates how to perform an inner join.</span>
<span id="cb162-838"><a href="#cb162-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-839"><a href="#cb162-839" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb162-840"><a href="#cb162-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-841"><a href="#cb162-841" aria-hidden="true" tabindex="-1"></a><span class="fu"># SQL</span></span>
<span id="cb162-842"><a href="#cb162-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-845"><a href="#cb162-845" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-846"><a href="#cb162-846" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-847"><a href="#cb162-847" aria-hidden="true" tabindex="-1"></a><span class="co">-- Perform an inner join with a subquery.</span></span>
<span id="cb162-848"><a href="#cb162-848" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t1<span class="ch">.</span>model_name, t1<span class="ch">.</span>mpg, t1<span class="ch">.</span>cyl, t2<span class="ch">.</span><span class="op">*</span> <span class="kw">FROM</span> mtcars_table t1</span>
<span id="cb162-849"><a href="#cb162-849" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> (<span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table_group <span class="kw">LIMIT</span> <span class="dv">5</span>) t2 <span class="kw">ON</span> t1<span class="ch">.</span>model_name <span class="op">=</span> t2<span class="ch">.</span>model_name;</span>
<span id="cb162-850"><a href="#cb162-850" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-851"><a href="#cb162-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-852"><a href="#cb162-852" aria-hidden="true" tabindex="-1"></a><span class="fu"># R</span></span>
<span id="cb162-853"><a href="#cb162-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-856"><a href="#cb162-856" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb162-857"><a href="#cb162-857" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform an inner join.</span></span>
<span id="cb162-858"><a href="#cb162-858" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">inner_join</span>(mtcars, <span class="at">by =</span> <span class="fu">join_by</span>(model_name <span class="sc">==</span> model_name)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>)</span>
<span id="cb162-859"><a href="#cb162-859" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-860"><a href="#cb162-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-861"><a href="#cb162-861" aria-hidden="true" tabindex="-1"></a><span class="fu"># Python pandas</span></span>
<span id="cb162-862"><a href="#cb162-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-865"><a href="#cb162-865" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-866"><a href="#cb162-866" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform an inner join with pandas.</span></span>
<span id="cb162-867"><a href="#cb162-867" aria-hidden="true" tabindex="-1"></a>pd.merge(mtcars_pd, mtcars_pd, left_on<span class="op">=</span><span class="st">'model_name'</span>, right_on<span class="op">=</span><span class="st">'model_name'</span>, how<span class="op">=</span><span class="st">'inner'</span>).head(<span class="dv">5</span>)</span>
<span id="cb162-868"><a href="#cb162-868" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-869"><a href="#cb162-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-870"><a href="#cb162-870" aria-hidden="true" tabindex="-1"></a><span class="fu"># Python Polars</span></span>
<span id="cb162-871"><a href="#cb162-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-874"><a href="#cb162-874" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-875"><a href="#cb162-875" aria-hidden="true" tabindex="-1"></a>mtcars_pl.join(mtcars_pl, on<span class="op">=</span><span class="st">"model_name"</span>, how<span class="op">=</span><span class="st">"inner"</span>).head(<span class="dv">5</span>)</span>
<span id="cb162-876"><a href="#cb162-876" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-877"><a href="#cb162-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-878"><a href="#cb162-878" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb162-879"><a href="#cb162-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-880"><a href="#cb162-880" aria-hidden="true" tabindex="-1"></a><span class="fu"># Append Rows</span></span>
<span id="cb162-881"><a href="#cb162-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-882"><a href="#cb162-882" aria-hidden="true" tabindex="-1"></a><span class="fu">## Append Without Duplicate Elimination (`union all`)</span></span>
<span id="cb162-883"><a href="#cb162-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-884"><a href="#cb162-884" aria-hidden="true" tabindex="-1"></a>This section shows how to combine rows from two tables, keeping all duplicates.</span>
<span id="cb162-885"><a href="#cb162-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-886"><a href="#cb162-886" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb162-887"><a href="#cb162-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-888"><a href="#cb162-888" aria-hidden="true" tabindex="-1"></a><span class="fu">### SQL</span></span>
<span id="cb162-889"><a href="#cb162-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-892"><a href="#cb162-892" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-893"><a href="#cb162-893" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-894"><a href="#cb162-894" aria-hidden="true" tabindex="-1"></a><span class="co">-- Count the rows in the original table.</span></span>
<span id="cb162-895"><a href="#cb162-895" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">FROM</span> mtcars_table;</span>
<span id="cb162-896"><a href="#cb162-896" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-897"><a href="#cb162-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-900"><a href="#cb162-900" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-901"><a href="#cb162-901" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-902"><a href="#cb162-902" aria-hidden="true" tabindex="-1"></a><span class="co">-- Create a new table by appending mtcars_table to itself, including duplicates.</span></span>
<span id="cb162-903"><a href="#cb162-903" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> TEMP <span class="kw">TABLE</span> double_mtcars_table <span class="kw">AS</span></span>
<span id="cb162-904"><a href="#cb162-904" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table</span>
<span id="cb162-905"><a href="#cb162-905" aria-hidden="true" tabindex="-1"></a><span class="kw">UNION</span> <span class="kw">ALL</span></span>
<span id="cb162-906"><a href="#cb162-906" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table;</span>
<span id="cb162-907"><a href="#cb162-907" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-908"><a href="#cb162-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-911"><a href="#cb162-911" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-912"><a href="#cb162-912" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-913"><a href="#cb162-913" aria-hidden="true" tabindex="-1"></a><span class="co">-- Count the rows in the new table.</span></span>
<span id="cb162-914"><a href="#cb162-914" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">FROM</span> double_mtcars_table;</span>
<span id="cb162-915"><a href="#cb162-915" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-916"><a href="#cb162-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-917"><a href="#cb162-917" aria-hidden="true" tabindex="-1"></a><span class="fu">### R</span></span>
<span id="cb162-918"><a href="#cb162-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-921"><a href="#cb162-921" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb162-922"><a href="#cb162-922" aria-hidden="true" tabindex="-1"></a><span class="co"># Append rows using bind_rows.</span></span>
<span id="cb162-923"><a href="#cb162-923" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>(mtcars)</span>
<span id="cb162-924"><a href="#cb162-924" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-925"><a href="#cb162-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-926"><a href="#cb162-926" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python pandas</span></span>
<span id="cb162-927"><a href="#cb162-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-930"><a href="#cb162-930" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-931"><a href="#cb162-931" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate dataframes, keeping all rows.</span></span>
<span id="cb162-932"><a href="#cb162-932" aria-hidden="true" tabindex="-1"></a>pd.concat([mtcars_pd, mtcars_pd], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb162-933"><a href="#cb162-933" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-934"><a href="#cb162-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-935"><a href="#cb162-935" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb162-936"><a href="#cb162-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-937"><a href="#cb162-937" aria-hidden="true" tabindex="-1"></a><span class="fu">## Append With Duplicate Elimination (`union`)</span></span>
<span id="cb162-938"><a href="#cb162-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-939"><a href="#cb162-939" aria-hidden="true" tabindex="-1"></a>This section demonstrates how to combine rows while removing duplicate entries.</span>
<span id="cb162-940"><a href="#cb162-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-941"><a href="#cb162-941" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb162-942"><a href="#cb162-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-943"><a href="#cb162-943" aria-hidden="true" tabindex="-1"></a><span class="fu">### SQL</span></span>
<span id="cb162-944"><a href="#cb162-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-947"><a href="#cb162-947" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-948"><a href="#cb162-948" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-949"><a href="#cb162-949" aria-hidden="true" tabindex="-1"></a><span class="co">-- Create a table, removing duplicate rows.</span></span>
<span id="cb162-950"><a href="#cb162-950" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">OR</span> <span class="kw">REPLACE</span> TEMP <span class="kw">TABLE</span> double_mtcars_table <span class="kw">AS</span></span>
<span id="cb162-951"><a href="#cb162-951" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table</span>
<span id="cb162-952"><a href="#cb162-952" aria-hidden="true" tabindex="-1"></a><span class="kw">UNION</span></span>
<span id="cb162-953"><a href="#cb162-953" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table;</span>
<span id="cb162-954"><a href="#cb162-954" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-955"><a href="#cb162-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-958"><a href="#cb162-958" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-959"><a href="#cb162-959" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-960"><a href="#cb162-960" aria-hidden="true" tabindex="-1"></a><span class="co">-- Count the rows in the new table.</span></span>
<span id="cb162-961"><a href="#cb162-961" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">FROM</span> double_mtcars_table;</span>
<span id="cb162-962"><a href="#cb162-962" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-963"><a href="#cb162-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-966"><a href="#cb162-966" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-967"><a href="#cb162-967" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-968"><a href="#cb162-968" aria-hidden="true" tabindex="-1"></a><span class="co">-- Verify the count of distinct rows.</span></span>
<span id="cb162-969"><a href="#cb162-969" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">FROM</span> (</span>
<span id="cb162-970"><a href="#cb162-970" aria-hidden="true" tabindex="-1"></a>  <span class="kw">SELECT</span> <span class="kw">DISTINCT</span> <span class="op">*</span> <span class="kw">FROM</span> double_mtcars_table</span>
<span id="cb162-971"><a href="#cb162-971" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb162-972"><a href="#cb162-972" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-973"><a href="#cb162-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-974"><a href="#cb162-974" aria-hidden="true" tabindex="-1"></a><span class="fu">### R</span></span>
<span id="cb162-975"><a href="#cb162-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-978"><a href="#cb162-978" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb162-979"><a href="#cb162-979" aria-hidden="true" tabindex="-1"></a><span class="co"># Append rows and then remove duplicates.</span></span>
<span id="cb162-980"><a href="#cb162-980" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>(mtcars) <span class="sc">|&gt;</span> <span class="fu">distinct</span>()</span>
<span id="cb162-981"><a href="#cb162-981" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-982"><a href="#cb162-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-983"><a href="#cb162-983" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python pandas</span></span>
<span id="cb162-984"><a href="#cb162-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-987"><a href="#cb162-987" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-988"><a href="#cb162-988" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate dataframes and then drop duplicates.</span></span>
<span id="cb162-989"><a href="#cb162-989" aria-hidden="true" tabindex="-1"></a>pd.concat([mtcars_pd, mtcars_pd], ignore_index<span class="op">=</span><span class="va">True</span>).drop_duplicates()</span>
<span id="cb162-990"><a href="#cb162-990" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-991"><a href="#cb162-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-992"><a href="#cb162-992" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb162-993"><a href="#cb162-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-994"><a href="#cb162-994" aria-hidden="true" tabindex="-1"></a><span class="fu"># Delete Rows</span></span>
<span id="cb162-995"><a href="#cb162-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-996"><a href="#cb162-996" aria-hidden="true" tabindex="-1"></a>This section shows how to remove rows from a table based on a condition.</span>
<span id="cb162-997"><a href="#cb162-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-998"><a href="#cb162-998" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb162-999"><a href="#cb162-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1000"><a href="#cb162-1000" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb162-1001"><a href="#cb162-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1004"><a href="#cb162-1004" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-1005"><a href="#cb162-1005" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-1006"><a href="#cb162-1006" aria-hidden="true" tabindex="-1"></a><span class="co">-- Delete a specific row from the table.</span></span>
<span id="cb162-1007"><a href="#cb162-1007" aria-hidden="true" tabindex="-1"></a><span class="kw">DELETE</span> <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> model_name <span class="op">=</span> <span class="st">'Mazda RX4'</span>;</span>
<span id="cb162-1008"><a href="#cb162-1008" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1009"><a href="#cb162-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1012"><a href="#cb162-1012" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-1013"><a href="#cb162-1013" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-1014"><a href="#cb162-1014" aria-hidden="true" tabindex="-1"></a><span class="co">-- Verify the row count after deletion.</span></span>
<span id="cb162-1015"><a href="#cb162-1015" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">FROM</span> mtcars_table;</span>
<span id="cb162-1016"><a href="#cb162-1016" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1017"><a href="#cb162-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1018"><a href="#cb162-1018" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb162-1019"><a href="#cb162-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1022"><a href="#cb162-1022" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb162-1023"><a href="#cb162-1023" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out the specified row.</span></span>
<span id="cb162-1024"><a href="#cb162-1024" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(model_name <span class="sc">!=</span> <span class="st">'Mazda RX4'</span>)</span>
<span id="cb162-1025"><a href="#cb162-1025" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1026"><a href="#cb162-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1027"><a href="#cb162-1027" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb162-1028"><a href="#cb162-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1031"><a href="#cb162-1031" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-1032"><a href="#cb162-1032" aria-hidden="true" tabindex="-1"></a><span class="co"># Select all rows except the one specified.</span></span>
<span id="cb162-1033"><a href="#cb162-1033" aria-hidden="true" tabindex="-1"></a>mtcars_pd[mtcars_pd[<span class="st">'model_name'</span>] <span class="op">!=</span> <span class="st">'Mazda RX4'</span>]</span>
<span id="cb162-1034"><a href="#cb162-1034" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1035"><a href="#cb162-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1036"><a href="#cb162-1036" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb162-1037"><a href="#cb162-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1040"><a href="#cb162-1040" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-1041"><a href="#cb162-1041" aria-hidden="true" tabindex="-1"></a>mtcars_pl.<span class="bu">filter</span>(pl.col(<span class="st">"model_name"</span>) <span class="op">!=</span> <span class="st">'Mazda RX4'</span>)</span>
<span id="cb162-1042"><a href="#cb162-1042" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1043"><a href="#cb162-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1044"><a href="#cb162-1044" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb162-1045"><a href="#cb162-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1046"><a href="#cb162-1046" aria-hidden="true" tabindex="-1"></a><span class="fu"># Update Rows</span></span>
<span id="cb162-1047"><a href="#cb162-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1048"><a href="#cb162-1048" aria-hidden="true" tabindex="-1"></a>This section demonstrates how to modify existing data in a table.</span>
<span id="cb162-1049"><a href="#cb162-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1050"><a href="#cb162-1050" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb162-1051"><a href="#cb162-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1052"><a href="#cb162-1052" aria-hidden="true" tabindex="-1"></a><span class="fu">## SQL</span></span>
<span id="cb162-1053"><a href="#cb162-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1056"><a href="#cb162-1056" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-1057"><a href="#cb162-1057" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-1058"><a href="#cb162-1058" aria-hidden="true" tabindex="-1"></a><span class="co">-- Select the row to be updated.</span></span>
<span id="cb162-1059"><a href="#cb162-1059" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, mpg <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> model_name <span class="op">=</span> <span class="st">'Mazda RX4 Wag'</span>;</span>
<span id="cb162-1060"><a href="#cb162-1060" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1061"><a href="#cb162-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1064"><a href="#cb162-1064" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-1065"><a href="#cb162-1065" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-1066"><a href="#cb162-1066" aria-hidden="true" tabindex="-1"></a><span class="co">-- Update the value of a column for a specific row.</span></span>
<span id="cb162-1067"><a href="#cb162-1067" aria-hidden="true" tabindex="-1"></a><span class="kw">UPDATE</span> mtcars_table</span>
<span id="cb162-1068"><a href="#cb162-1068" aria-hidden="true" tabindex="-1"></a><span class="kw">SET</span> mpg <span class="op">=</span> <span class="dv">999</span></span>
<span id="cb162-1069"><a href="#cb162-1069" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> model_name <span class="op">=</span> <span class="st">'Mazda RX4 Wag'</span>;</span>
<span id="cb162-1070"><a href="#cb162-1070" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1071"><a href="#cb162-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1074"><a href="#cb162-1074" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-1075"><a href="#cb162-1075" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-1076"><a href="#cb162-1076" aria-hidden="true" tabindex="-1"></a><span class="co">-- Verify the update.</span></span>
<span id="cb162-1077"><a href="#cb162-1077" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> model_name, mpg <span class="kw">FROM</span> mtcars_table <span class="kw">WHERE</span> model_name <span class="op">=</span> <span class="st">'Mazda RX4 Wag'</span>;</span>
<span id="cb162-1078"><a href="#cb162-1078" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1079"><a href="#cb162-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1080"><a href="#cb162-1080" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb162-1081"><a href="#cb162-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1084"><a href="#cb162-1084" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb162-1085"><a href="#cb162-1085" aria-hidden="true" tabindex="-1"></a><span class="co"># Update a value within a filtered selection.</span></span>
<span id="cb162-1086"><a href="#cb162-1086" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(model_name <span class="sc">==</span> <span class="st">'Mazda RX4 Wag'</span>) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">mpg =</span> <span class="dv">999</span>)</span>
<span id="cb162-1087"><a href="#cb162-1087" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1088"><a href="#cb162-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1089"><a href="#cb162-1089" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb162-1090"><a href="#cb162-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1093"><a href="#cb162-1093" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-1094"><a href="#cb162-1094" aria-hidden="true" tabindex="-1"></a><span class="co"># Update a specific value using .loc.</span></span>
<span id="cb162-1095"><a href="#cb162-1095" aria-hidden="true" tabindex="-1"></a>mtcars_pd.loc[mtcars_pd[<span class="st">'model_name'</span>] <span class="op">==</span> <span class="st">'Mazda RX4 Wag'</span>, <span class="st">'mpg'</span>] <span class="op">=</span> <span class="dv">999</span></span>
<span id="cb162-1096"><a href="#cb162-1096" aria-hidden="true" tabindex="-1"></a>mtcars_pd</span>
<span id="cb162-1097"><a href="#cb162-1097" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1098"><a href="#cb162-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1099"><a href="#cb162-1099" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb162-1100"><a href="#cb162-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1103"><a href="#cb162-1103" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-1104"><a href="#cb162-1104" aria-hidden="true" tabindex="-1"></a>mtcars_pl.with_columns(</span>
<span id="cb162-1105"><a href="#cb162-1105" aria-hidden="true" tabindex="-1"></a>    pl.when(pl.col(<span class="st">"model_name"</span>) <span class="op">==</span> <span class="st">'Mazda RX4 Wag'</span>)</span>
<span id="cb162-1106"><a href="#cb162-1106" aria-hidden="true" tabindex="-1"></a>    .then(<span class="dv">999</span>)</span>
<span id="cb162-1107"><a href="#cb162-1107" aria-hidden="true" tabindex="-1"></a>    .otherwise(pl.col(<span class="st">"mpg"</span>))</span>
<span id="cb162-1108"><a href="#cb162-1108" aria-hidden="true" tabindex="-1"></a>    .alias(<span class="st">"mpg"</span>)</span>
<span id="cb162-1109"><a href="#cb162-1109" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb162-1110"><a href="#cb162-1110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1111"><a href="#cb162-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1112"><a href="#cb162-1112" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb162-1113"><a href="#cb162-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1114"><a href="#cb162-1114" aria-hidden="true" tabindex="-1"></a><span class="fu"># Drop Table</span></span>
<span id="cb162-1115"><a href="#cb162-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1116"><a href="#cb162-1116" aria-hidden="true" tabindex="-1"></a>This section shows how to remove a table from the database.</span>
<span id="cb162-1117"><a href="#cb162-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1118"><a href="#cb162-1118" aria-hidden="true" tabindex="-1"></a>Before dropping the table:</span>
<span id="cb162-1119"><a href="#cb162-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1122"><a href="#cb162-1122" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-1123"><a href="#cb162-1123" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-1124"><a href="#cb162-1124" aria-hidden="true" tabindex="-1"></a><span class="co">-- Show all tables before dropping one.</span></span>
<span id="cb162-1125"><a href="#cb162-1125" aria-hidden="true" tabindex="-1"></a><span class="kw">SHOW</span> <span class="kw">ALL</span> <span class="kw">TABLES</span>;</span>
<span id="cb162-1126"><a href="#cb162-1126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1127"><a href="#cb162-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1128"><a href="#cb162-1128" aria-hidden="true" tabindex="-1"></a>Dropping the table:</span>
<span id="cb162-1129"><a href="#cb162-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1132"><a href="#cb162-1132" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-1133"><a href="#cb162-1133" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-1134"><a href="#cb162-1134" aria-hidden="true" tabindex="-1"></a><span class="co">-- Drop the specified table if it exists.</span></span>
<span id="cb162-1135"><a href="#cb162-1135" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> mtcars_table_group;</span>
<span id="cb162-1136"><a href="#cb162-1136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1137"><a href="#cb162-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1138"><a href="#cb162-1138" aria-hidden="true" tabindex="-1"></a>After dropping the table:</span>
<span id="cb162-1139"><a href="#cb162-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1142"><a href="#cb162-1142" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-1143"><a href="#cb162-1143" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-1144"><a href="#cb162-1144" aria-hidden="true" tabindex="-1"></a><span class="co">-- Show all tables again to confirm the deletion.</span></span>
<span id="cb162-1145"><a href="#cb162-1145" aria-hidden="true" tabindex="-1"></a><span class="kw">SHOW</span> <span class="kw">ALL</span> <span class="kw">TABLES</span>;</span>
<span id="cb162-1146"><a href="#cb162-1146" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1147"><a href="#cb162-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1148"><a href="#cb162-1148" aria-hidden="true" tabindex="-1"></a><span class="fu"># PIVOT</span></span>
<span id="cb162-1149"><a href="#cb162-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1150"><a href="#cb162-1150" aria-hidden="true" tabindex="-1"></a>This section demonstrates how to transform data from a long to a wide format.</span>
<span id="cb162-1151"><a href="#cb162-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1154"><a href="#cb162-1154" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-1155"><a href="#cb162-1155" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-1156"><a href="#cb162-1156" aria-hidden="true" tabindex="-1"></a><span class="co">-- Create a temporary table for the pivot demonstration.</span></span>
<span id="cb162-1157"><a href="#cb162-1157" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">EXISTS</span> cities;</span>
<span id="cb162-1158"><a href="#cb162-1158" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> TEMP <span class="kw">TABLE</span> cities (</span>
<span id="cb162-1159"><a href="#cb162-1159" aria-hidden="true" tabindex="-1"></a>    country <span class="dt">VARCHAR</span>, name <span class="dt">VARCHAR</span>, <span class="fu">year</span> <span class="dt">INTEGER</span>, population <span class="dt">INTEGER</span></span>
<span id="cb162-1160"><a href="#cb162-1160" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb162-1161"><a href="#cb162-1161" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> cities <span class="kw">VALUES</span></span>
<span id="cb162-1162"><a href="#cb162-1162" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'NL'</span>, <span class="st">'Amsterdam'</span>, <span class="dv">2000</span>, <span class="dv">1005</span>),</span>
<span id="cb162-1163"><a href="#cb162-1163" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'NL'</span>, <span class="st">'Amsterdam'</span>, <span class="dv">2010</span>, <span class="dv">1065</span>),</span>
<span id="cb162-1164"><a href="#cb162-1164" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'NL'</span>, <span class="st">'Amsterdam'</span>, <span class="dv">2020</span>, <span class="dv">1158</span>),</span>
<span id="cb162-1165"><a href="#cb162-1165" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'Seattle'</span>, <span class="dv">2000</span>, <span class="dv">564</span>),</span>
<span id="cb162-1166"><a href="#cb162-1166" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'Seattle'</span>, <span class="dv">2010</span>, <span class="dv">608</span>),</span>
<span id="cb162-1167"><a href="#cb162-1167" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'Seattle'</span>, <span class="dv">2020</span>, <span class="dv">738</span>),</span>
<span id="cb162-1168"><a href="#cb162-1168" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'New York City'</span>, <span class="dv">2000</span>, <span class="dv">8015</span>),</span>
<span id="cb162-1169"><a href="#cb162-1169" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'New York City'</span>, <span class="dv">2010</span>, <span class="dv">8175</span>),</span>
<span id="cb162-1170"><a href="#cb162-1170" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'US'</span>, <span class="st">'New York City'</span>, <span class="dv">2020</span>, <span class="dv">8772</span>);</span>
<span id="cb162-1171"><a href="#cb162-1171" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1172"><a href="#cb162-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1175"><a href="#cb162-1175" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-1176"><a href="#cb162-1176" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-1177"><a href="#cb162-1177" aria-hidden="true" tabindex="-1"></a><span class="co">-- View the raw data.</span></span>
<span id="cb162-1178"><a href="#cb162-1178" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> cities;</span>
<span id="cb162-1179"><a href="#cb162-1179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1180"><a href="#cb162-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1181"><a href="#cb162-1181" aria-hidden="true" tabindex="-1"></a><span class="fu">## PIVOT on One Column</span></span>
<span id="cb162-1182"><a href="#cb162-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1183"><a href="#cb162-1183" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb162-1184"><a href="#cb162-1184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1185"><a href="#cb162-1185" aria-hidden="true" tabindex="-1"></a><span class="fu">### SQL</span></span>
<span id="cb162-1186"><a href="#cb162-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1189"><a href="#cb162-1189" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-1190"><a href="#cb162-1190" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-1191"><a href="#cb162-1191" aria-hidden="true" tabindex="-1"></a><span class="co">-- Pivot the table on the 'year' column.</span></span>
<span id="cb162-1192"><a href="#cb162-1192" aria-hidden="true" tabindex="-1"></a>PIVOT cities</span>
<span id="cb162-1193"><a href="#cb162-1193" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> <span class="fu">year</span></span>
<span id="cb162-1194"><a href="#cb162-1194" aria-hidden="true" tabindex="-1"></a><span class="kw">USING</span> <span class="fu">sum</span>(population)</span>
<span id="cb162-1195"><a href="#cb162-1195" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> country;</span>
<span id="cb162-1196"><a href="#cb162-1196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1197"><a href="#cb162-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1198"><a href="#cb162-1198" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python pandas</span></span>
<span id="cb162-1199"><a href="#cb162-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1202"><a href="#cb162-1202" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-1203"><a href="#cb162-1203" aria-hidden="true" tabindex="-1"></a>cities_pd.pivot_table(index<span class="op">=</span><span class="st">'country'</span>, columns<span class="op">=</span><span class="st">'year'</span>, values<span class="op">=</span><span class="st">'population'</span>, aggfunc<span class="op">=</span><span class="st">'sum'</span>).reset_index()</span>
<span id="cb162-1204"><a href="#cb162-1204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1205"><a href="#cb162-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1206"><a href="#cb162-1206" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python Polars</span></span>
<span id="cb162-1207"><a href="#cb162-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1210"><a href="#cb162-1210" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-1211"><a href="#cb162-1211" aria-hidden="true" tabindex="-1"></a>cities_pl.pivot(index<span class="op">=</span><span class="st">'country'</span>, columns<span class="op">=</span><span class="st">'year'</span>, values<span class="op">=</span><span class="st">'population'</span>, aggregate_function<span class="op">=</span><span class="st">'sum'</span>)</span>
<span id="cb162-1212"><a href="#cb162-1212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1213"><a href="#cb162-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1214"><a href="#cb162-1214" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb162-1215"><a href="#cb162-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1216"><a href="#cb162-1216" aria-hidden="true" tabindex="-1"></a><span class="fu">## PIVOT on Two Columns</span></span>
<span id="cb162-1217"><a href="#cb162-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1218"><a href="#cb162-1218" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb162-1219"><a href="#cb162-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1220"><a href="#cb162-1220" aria-hidden="true" tabindex="-1"></a><span class="fu">### SQL</span></span>
<span id="cb162-1221"><a href="#cb162-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1224"><a href="#cb162-1224" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-1225"><a href="#cb162-1225" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-1226"><a href="#cb162-1226" aria-hidden="true" tabindex="-1"></a><span class="co">-- Pivot on both 'country' and 'name'.</span></span>
<span id="cb162-1227"><a href="#cb162-1227" aria-hidden="true" tabindex="-1"></a>PIVOT cities</span>
<span id="cb162-1228"><a href="#cb162-1228" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> country, name</span>
<span id="cb162-1229"><a href="#cb162-1229" aria-hidden="true" tabindex="-1"></a><span class="kw">USING</span> <span class="fu">sum</span>(population);</span>
<span id="cb162-1230"><a href="#cb162-1230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1231"><a href="#cb162-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1232"><a href="#cb162-1232" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python pandas</span></span>
<span id="cb162-1233"><a href="#cb162-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1236"><a href="#cb162-1236" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-1237"><a href="#cb162-1237" aria-hidden="true" tabindex="-1"></a>cities_pd.pivot_table(index<span class="op">=</span>[<span class="st">'country'</span>, <span class="st">'name'</span>], columns<span class="op">=</span><span class="st">'year'</span>, values<span class="op">=</span><span class="st">'population'</span>, aggfunc<span class="op">=</span><span class="st">'sum'</span>).reset_index()</span>
<span id="cb162-1238"><a href="#cb162-1238" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1239"><a href="#cb162-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1240"><a href="#cb162-1240" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python Polars</span></span>
<span id="cb162-1241"><a href="#cb162-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1244"><a href="#cb162-1244" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-1245"><a href="#cb162-1245" aria-hidden="true" tabindex="-1"></a>cities_pl.pivot(index<span class="op">=</span>[<span class="st">'country'</span>, <span class="st">'name'</span>], columns<span class="op">=</span><span class="st">'year'</span>, values<span class="op">=</span><span class="st">'population'</span>, aggregate_function<span class="op">=</span><span class="st">'sum'</span>)</span>
<span id="cb162-1246"><a href="#cb162-1246" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1247"><a href="#cb162-1247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1248"><a href="#cb162-1248" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb162-1249"><a href="#cb162-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1250"><a href="#cb162-1250" aria-hidden="true" tabindex="-1"></a><span class="fu"># UNPIVOT</span></span>
<span id="cb162-1251"><a href="#cb162-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1252"><a href="#cb162-1252" aria-hidden="true" tabindex="-1"></a>This section shows how to transform data from a wide to a long format.</span>
<span id="cb162-1253"><a href="#cb162-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1254"><a href="#cb162-1254" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb162-1255"><a href="#cb162-1255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1256"><a href="#cb162-1256" aria-hidden="true" tabindex="-1"></a><span class="fu">### SQL</span></span>
<span id="cb162-1257"><a href="#cb162-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1260"><a href="#cb162-1260" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-1261"><a href="#cb162-1261" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-1262"><a href="#cb162-1262" aria-hidden="true" tabindex="-1"></a><span class="co">-- Unpivot the previously pivoted table.</span></span>
<span id="cb162-1263"><a href="#cb162-1263" aria-hidden="true" tabindex="-1"></a>UNPIVOT</span>
<span id="cb162-1264"><a href="#cb162-1264" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb162-1265"><a href="#cb162-1265" aria-hidden="true" tabindex="-1"></a>  PIVOT cities</span>
<span id="cb162-1266"><a href="#cb162-1266" aria-hidden="true" tabindex="-1"></a>  <span class="kw">ON</span> <span class="fu">year</span></span>
<span id="cb162-1267"><a href="#cb162-1267" aria-hidden="true" tabindex="-1"></a>  <span class="kw">USING</span> <span class="fu">sum</span>(population)</span>
<span id="cb162-1268"><a href="#cb162-1268" aria-hidden="true" tabindex="-1"></a>  <span class="kw">GROUP</span> <span class="kw">BY</span> country</span>
<span id="cb162-1269"><a href="#cb162-1269" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb162-1270"><a href="#cb162-1270" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> <span class="kw">COLUMNS</span>(<span class="op">*</span> EXCLUDE (country))</span>
<span id="cb162-1271"><a href="#cb162-1271" aria-hidden="true" tabindex="-1"></a><span class="kw">INTO</span></span>
<span id="cb162-1272"><a href="#cb162-1272" aria-hidden="true" tabindex="-1"></a>    NAME <span class="fu">year</span></span>
<span id="cb162-1273"><a href="#cb162-1273" aria-hidden="true" tabindex="-1"></a>    VALUE population;</span>
<span id="cb162-1274"><a href="#cb162-1274" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1275"><a href="#cb162-1275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1276"><a href="#cb162-1276" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python pandas</span></span>
<span id="cb162-1277"><a href="#cb162-1277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1278"><a href="#cb162-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1279"><a href="#cb162-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1280"><a href="#cb162-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1283"><a href="#cb162-1283" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-1284"><a href="#cb162-1284" aria-hidden="true" tabindex="-1"></a>cities_pivot_pd <span class="op">=</span> cities_pd.pivot_table(index<span class="op">=</span><span class="st">'country'</span>, columns<span class="op">=</span><span class="st">'year'</span>, values<span class="op">=</span><span class="st">'population'</span>, aggfunc<span class="op">=</span><span class="st">'sum'</span>).reset_index()</span>
<span id="cb162-1285"><a href="#cb162-1285" aria-hidden="true" tabindex="-1"></a>cities_pivot_pd.melt(id_vars<span class="op">=</span><span class="st">'country'</span>, value_vars<span class="op">=</span>[<span class="dv">2000</span>, <span class="dv">2010</span>, <span class="dv">2020</span>], var_name<span class="op">=</span><span class="st">'year'</span>, value_name<span class="op">=</span><span class="st">'population'</span>)</span>
<span id="cb162-1286"><a href="#cb162-1286" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1287"><a href="#cb162-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1288"><a href="#cb162-1288" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python Polars</span></span>
<span id="cb162-1289"><a href="#cb162-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1292"><a href="#cb162-1292" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-1293"><a href="#cb162-1293" aria-hidden="true" tabindex="-1"></a>cities_pl <span class="op">=</span> pl.from_pandas(cities_pd)</span>
<span id="cb162-1294"><a href="#cb162-1294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1295"><a href="#cb162-1295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1296"><a href="#cb162-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1299"><a href="#cb162-1299" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-1300"><a href="#cb162-1300" aria-hidden="true" tabindex="-1"></a>cities_pivot_pl <span class="op">=</span> cities_pl.pivot(index<span class="op">=</span><span class="st">'country'</span>, columns<span class="op">=</span><span class="st">'year'</span>, values<span class="op">=</span><span class="st">'population'</span>, aggregate_function<span class="op">=</span><span class="st">'sum'</span>)</span>
<span id="cb162-1301"><a href="#cb162-1301" aria-hidden="true" tabindex="-1"></a>cities_pivot_pl.unpivot(index<span class="op">=</span><span class="st">'country'</span>, on<span class="op">=</span>[<span class="st">'2000'</span>, <span class="st">'2010'</span>, <span class="st">'2020'</span>], variable_name<span class="op">=</span><span class="st">'year'</span>, value_name<span class="op">=</span><span class="st">'population'</span>)</span>
<span id="cb162-1302"><a href="#cb162-1302" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1303"><a href="#cb162-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1304"><a href="#cb162-1304" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb162-1305"><a href="#cb162-1305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1306"><a href="#cb162-1306" aria-hidden="true" tabindex="-1"></a><span class="fu"># EXPLAIN</span></span>
<span id="cb162-1307"><a href="#cb162-1307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1308"><a href="#cb162-1308" aria-hidden="true" tabindex="-1"></a>This section demonstrates how to analyze the execution plan of a query.</span>
<span id="cb162-1309"><a href="#cb162-1309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1312"><a href="#cb162-1312" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-1313"><a href="#cb162-1313" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb162-1314"><a href="#cb162-1314" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-1315"><a href="#cb162-1315" aria-hidden="true" tabindex="-1"></a><span class="co">-- Show the logical execution plan of a query.</span></span>
<span id="cb162-1316"><a href="#cb162-1316" aria-hidden="true" tabindex="-1"></a><span class="kw">EXPLAIN</span></span>
<span id="cb162-1317"><a href="#cb162-1317" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t1<span class="ch">.</span>model_name, t1<span class="ch">.</span>mpg, t1<span class="ch">.</span>cyl, t2<span class="ch">.</span><span class="op">*</span> <span class="kw">FROM</span> mtcars_table t1</span>
<span id="cb162-1318"><a href="#cb162-1318" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> (<span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table <span class="kw">LIMIT</span> <span class="dv">5</span>) t2 <span class="kw">ON</span> t1<span class="ch">.</span>model_name <span class="op">=</span> t2<span class="ch">.</span>model_name;</span>
<span id="cb162-1319"><a href="#cb162-1319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1320"><a href="#cb162-1320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1323"><a href="#cb162-1323" aria-hidden="true" tabindex="-1"></a><span class="in">```{sql}</span></span>
<span id="cb162-1324"><a href="#cb162-1324" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb162-1325"><a href="#cb162-1325" aria-hidden="true" tabindex="-1"></a><span class="co">#| connection: con</span></span>
<span id="cb162-1326"><a href="#cb162-1326" aria-hidden="true" tabindex="-1"></a><span class="co">-- Show the detailed execution plan, including timing information.</span></span>
<span id="cb162-1327"><a href="#cb162-1327" aria-hidden="true" tabindex="-1"></a><span class="kw">EXPLAIN</span> <span class="kw">ANALYZE</span></span>
<span id="cb162-1328"><a href="#cb162-1328" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t1<span class="ch">.</span>model_name, t1<span class="ch">.</span>mpg, t1<span class="ch">.</span>cyl, t2<span class="ch">.</span><span class="op">*</span> <span class="kw">FROM</span> mtcars_table t1</span>
<span id="cb162-1329"><a href="#cb162-1329" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> (<span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> mtcars_table <span class="kw">LIMIT</span> <span class="dv">5</span>) t2 <span class="kw">ON</span> t1<span class="ch">.</span>model_name <span class="op">=</span> t2<span class="ch">.</span>model_name;</span>
<span id="cb162-1330"><a href="#cb162-1330" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1331"><a href="#cb162-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1334"><a href="#cb162-1334" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb162-1335"><a href="#cb162-1335" aria-hidden="true" tabindex="-1"></a><span class="co"># Disconnect from the database and shut it down.</span></span>
<span id="cb162-1336"><a href="#cb162-1336" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(con, <span class="at">shutdown =</span> <span class="cn">TRUE</span>)</span>
<span id="cb162-1337"><a href="#cb162-1337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1338"><a href="#cb162-1338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1339"><a href="#cb162-1339" aria-hidden="true" tabindex="-1"></a><span class="fu"># Display Beautiful Table</span></span>
<span id="cb162-1340"><a href="#cb162-1340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1341"><a href="#cb162-1341" aria-hidden="true" tabindex="-1"></a>This section shows how to create nicely formatted tables for presentation.</span>
<span id="cb162-1342"><a href="#cb162-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1343"><a href="#cb162-1343" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb162-1344"><a href="#cb162-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1345"><a href="#cb162-1345" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb162-1346"><a href="#cb162-1346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1349"><a href="#cb162-1349" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb162-1350"><a href="#cb162-1350" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the gt library to create a formatted table.</span></span>
<span id="cb162-1351"><a href="#cb162-1351" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb162-1352"><a href="#cb162-1352" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">gt</span>()</span>
<span id="cb162-1353"><a href="#cb162-1353" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1354"><a href="#cb162-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1355"><a href="#cb162-1355" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python pandas</span></span>
<span id="cb162-1356"><a href="#cb162-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1359"><a href="#cb162-1359" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-1360"><a href="#cb162-1360" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the great_tables library to create a formatted table.</span></span>
<span id="cb162-1361"><a href="#cb162-1361" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> great_tables <span class="im">import</span> GT</span>
<span id="cb162-1362"><a href="#cb162-1362" aria-hidden="true" tabindex="-1"></a>GT(mtcars_pd)</span>
<span id="cb162-1363"><a href="#cb162-1363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1364"><a href="#cb162-1364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1365"><a href="#cb162-1365" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python Polars</span></span>
<span id="cb162-1366"><a href="#cb162-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1369"><a href="#cb162-1369" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb162-1370"><a href="#cb162-1370" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the great_tables library to create a formatted table.</span></span>
<span id="cb162-1371"><a href="#cb162-1371" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> great_tables <span class="im">import</span> GT</span>
<span id="cb162-1372"><a href="#cb162-1372" aria-hidden="true" tabindex="-1"></a>GT(mtcars_pl)</span>
<span id="cb162-1373"><a href="#cb162-1373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb162-1374"><a href="#cb162-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1375"><a href="#cb162-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1376"><a href="#cb162-1376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1377"><a href="#cb162-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1378"><a href="#cb162-1378" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb162-1379"><a href="#cb162-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1380"><a href="#cb162-1380" aria-hidden="true" tabindex="-1"></a><span class="fu"># Reference:</span></span>
<span id="cb162-1381"><a href="#cb162-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1382"><a href="#cb162-1382" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">DuckDB R Client Documentation</span><span class="co">](https://duckdb.org/docs/stable/clients/r.html)</span></span>
<span id="cb162-1383"><a href="#cb162-1383" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">DuckDB SQL Statements</span><span class="co">](https://duckdb.org/docs/stable/sql/statements)</span></span>
<span id="cb162-1384"><a href="#cb162-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1385"><a href="#cb162-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-1386"><a href="#cb162-1386" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This blog is built with ❤️ and <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>